[
  {
    "objectID": "simple_template1.html",
    "href": "simple_template1.html",
    "title": "Assignment 1",
    "section": "",
    "text": "Setup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF for the submission. Make sure that this does not get displayed in the PDF!\nThis is the template for assignment 1. You can download the qmd-file or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\nThe following will set-up markmyassignment to check your functions at the end of the notebook:\n\nlibrary(markmyassignment) \nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/assignments/tests/assignment1.yml\", sep=\"\")\nset_assignment(assignment_path)   \n\nAssignment set:\nassignment1: Bayesian Data Analysis: Assignment 1\nThe assignment contain the following (3) tasks:\n- p_red\n- p_box\n- p_identical_twin"
  },
  {
    "objectID": "simple_template1.html#a",
    "href": "simple_template1.html#a",
    "title": "Assignment 1",
    "section": "3.1 (a)",
    "text": "3.1 (a)\nPlot the PDF here. Explain shortly what you do.\n\n# Useful functions: seq(), plot() and dbeta()"
  },
  {
    "objectID": "simple_template1.html#b",
    "href": "simple_template1.html#b",
    "title": "Assignment 1",
    "section": "3.2 (b)",
    "text": "3.2 (b)\nDraw samples and plot the histogram here. Explain shortly what you do.\n\n# Useful functions: rbeta() and hist()"
  },
  {
    "objectID": "simple_template1.html#c",
    "href": "simple_template1.html#c",
    "title": "Assignment 1",
    "section": "3.3 (c)",
    "text": "3.3 (c)\nCompute the sample mean and variance here. Explain shortly what you do.\n\n# Useful functions: mean() and var()"
  },
  {
    "objectID": "simple_template1.html#d",
    "href": "simple_template1.html#d",
    "title": "Assignment 1",
    "section": "3.4 (d)",
    "text": "3.4 (d)\nCompute the central interval here. Explain shortly what you do.\n\n# Useful functions: quantile()"
  },
  {
    "objectID": "simple_template1.html#a-1",
    "href": "simple_template1.html#a-1",
    "title": "Assignment 1",
    "section": "5.1 (a)",
    "text": "5.1 (a)\nKeep the below name and format for the function to work with markmyassignment:\n\np_red &lt;- function(boxes) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    0.3928571\n}"
  },
  {
    "objectID": "simple_template1.html#b-1",
    "href": "simple_template1.html#b-1",
    "title": "Assignment 1",
    "section": "5.2 (b)",
    "text": "5.2 (b)\nKeep the below name and format for the function to work with markmyassignment:\n\np_box &lt;- function(boxes) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.29090909,0.07272727,0.63636364)\n}"
  },
  {
    "objectID": "assignment7.html",
    "href": "assignment7.html",
    "title": "Assignment 7",
    "section": "",
    "text": "The maximum amount of points from this assignment is 9.\nWe have prepared a quarto template to help you get started.\n\nWe recommend you use the docker container. Unfortunately, you will have to update the docker container, which however should be easy. See the new instructions at the end of the above link.\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nReading instructions:\nChapter 5 in BDA3, see the reading instructions for Chapter 5.\nGrading instructions:\nThe grading will be done in peergrade. All grading questions and evaluations for this assignment are contained within this document in the collapsible Rubric blocks.\nInstalling and using CmdStanR:\nSee the Stan demos on how to use Stan in R (or Python). jupyter.cs.aalto.fi has working R and CmdStanR/RStan environment and is probably the easiest way to use Stan. The Aalto Ubuntu desktops also have the necessary libraries installed. To install Stan on your laptop, run ‘install.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")))’ in R. If you encounter problems, see additional answers in FAQ. If you don’t succeed in short amount of time, it is probably easier to use jupyter.cs.aalto.fi.\nIf you use jupyter.cs.aalto.fi, all necessary packages have been pre-installed. In your laptop, install package cmdstanr. Installation instructions on Linux, Mac and Windows can be found at https://mc-stan.org/cmdstanr/. Additional useful packages are loo, bayesplot and posterior (but you don’t need these in this assignment). For Python users, PyStan, CmdStanPy, and ArviZ packages are useful.\nStan manual can be found at https://mc-stan.org/users/documentation/. From this website, you can also find a lot of other useful material about Stan.\nIf you edit files ending .stan in RStudio, you can click “Check” in the editor toolbar to make syntax check. This can significantly speed-up writing a working Stan model.\n\n\n\n\n\n\n\n\n\nReporting accuracy\n\n\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\nSee lecture video 4.1, the chapter notes, and a case study for more information.\n\n\n\n\n\n\n\n\n\nFurther information\n\n\n\n\n\n\nThe recommended tool in this course is R (with the IDE R-Studio). You can download R here and R-Studio here. There are tons of tutorials, videos and introductions to R and R-Studio online. You can find some initial hints from RStudio Education pages.\nInstead of installing R and RStudio on you own computer, see how to use R and RStudio remotely.\nWhen working with R, we recommend writing the report using quarto and the soon to be provided template. The remplate includes the formatting instructions and how to include code and figures.\nInstead of quarto, you can use other software to make the PDF report, but the the same instructions for formatting should be used..\nReport all results in a single, anonymous *.pdf -file and return it to peergrade.io.\nThe course has its own R package aaltobda with data and functionality to simplify coding. To install the package just run the following (upgrade=\"never\" skips question about updating other packages):\n\ninstall.packages(\"remotes\")\nremotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n\nMany of the exercises can be checked automatically using the R package\nmarkmyassignment. Information on how to install and use the package can be found here. There is no need to include markmyassignment results in the report.\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in peergrade. You can set email alerts for trhe deadlines in peergrade settings.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet. You can copy, e.g., plotting code from the course demos, but really try to solve the actual assignment problems with your own code and explanations. Do not share your answers publicly. Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year. All suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nDo not submit empty PDFs or almost empty PDFs as these are just harming the other students as they can’t do peergrading for the empty or almost empty submissions. Violations of this rule will be reported and investigated in the same way was plagiarism.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\n\n\n\n\nRubric S1: General information - 7.5/100 points\n\n\n\n\n\n\nQ1: \nCan you open the PDF and it’s not blank?\n\nQ2: \nIs the report anonymous?\n\n\n\n\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThe following loads several needed packages:\n\nlibrary(aaltobda)\nlibrary(bayesplot)\n\nThis is bayesplot version 1.10.0\n\n\n- Online documentation and vignettes at mc-stan.org/bayesplot\n\n\n- bayesplot theme set to bayesplot::theme_default()\n\n\n   * Does _not_ affect other ggplot2 plots\n\n\n   * See ?bayesplot_theme_set for details on theme setting\n\nlibrary(cmdstanr)\n\nThis is cmdstanr version 0.5.3\n\n\n- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr\n\n\n- CmdStan path: /home/niko/.cmdstan/cmdstan-2.31.0\n\n\n- CmdStan version: 2.31.0\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(ggplot2)\nlibrary(ggdist) # for stat_dotsinterval\nlibrary(posterior)\n\nThis is posterior version 1.4.0\n\n\n\nAttaching package: 'posterior'\n\n\nThe following object is masked from 'package:bayesplot':\n\n    rhat\n\n\nThe following object is masked from 'package:aaltobda':\n\n    mcse_quantile\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\nif(!require(brms)){\n    install.packages(\"brms\")\n    library(brms)\n}\n\nLoading required package: brms\n\n\nLoading required package: Rcpp\n\n\nLoading 'brms' package (version 2.19.0). Useful instructions\ncan be found by typing help('brms'). A more detailed introduction\nto the package is available through vignette('brms_overview').\n\n\n\nAttaching package: 'brms'\n\n\nThe following objects are masked from 'package:ggdist':\n\n    dstudent_t, pstudent_t, qstudent_t, rstudent_t\n\n\nThe following object is masked from 'package:bayesplot':\n\n    rhat\n\n\nThe following object is masked from 'package:stats':\n\n    ar\n\n# Set more readable themes with bigger font for plotting packages.\nggplot2::theme_set(theme_minimal(base_size = 14))\nbayesplot::bayesplot_theme_set(theme_minimal(base_size = 14))\n\n# This registers CmdStan as the backend for compiling cmdstan-chunks.\ncheck_cmdstan_toolchain(fix = TRUE, quiet = TRUE)\nregister_knitr_engine(override = FALSE)"
  },
  {
    "objectID": "assignment7.html#choosing-a-weakly-informative-prior-by-intuition",
    "href": "assignment7.html#choosing-a-weakly-informative-prior-by-intuition",
    "title": "Assignment 7",
    "section": "2.1 Choosing a weakly informative prior by intuition",
    "text": "2.1 Choosing a weakly informative prior by intuition\nTo prepare you for your projects, we will first guide you through two possible processes for choosing a weakly informative prior. It is important that your priors are not informed by data, so ideally, you should not have looked at the dataset yet.\nIn the absence of additional information, we will assume that chick weights at 12 days of age (\\(w\\)) follow a normal distribution: \\[\nw\\sim\\mathcal N (\\mu,\\sigma).\n\\] Our task will be to define weakly informative priors for the parameters of the mean, \\(\\mu\\), and standard deviation, \\(\\sigma\\).\nHere, \\(\\mu\\) represents the population or “true” mean chick weight at 12 days, and \\(\\sigma\\) represents the standard-deviation of the current weights \\(w\\) around that population mean. For this exercise, we will be specifying a normal prior for \\(\\mu\\):\n\\[\n\\mu\\sim\\mathcal N (\\mu_0,\\sigma_0)\n\\]\nIn the above, \\(\\mu_0\\) represents our prior knowledge of what we believe the population weight to be and \\(\\sigma_0\\) represents our level of certainty in this belief. To specify a weakly-informative prior for \\(\\mu\\) we need to select values of \\(\\mu_0\\) and \\(\\sigma_0\\) that imply the range of plausible values that \\(\\mu\\) could take.\nWe can do this by our own intuitive prior knowledge (if such intuition exists), or by searching for external references.\nIn modeling, weakly informed priors are quite subjective, which means that justification for prior choice can be considered more important than the specific choice itself. For the subtasks below, you will not be graded on the accuracy or precision of your numbers, but on your justification of them. The numerical choices you make should make sense and be understandable to an external reviewer of your work (even if they may not agree with your choices).\n\n\n\n\n\n\nSubtask 2.a)\n\n\n\n\n\nBased on your own past experience and estimation skills, what would you guess is a typical weight range of a fully grown chicken in grams? For example, would it make sense if a chicken weighed 1 million grams? 0.005 grams? What about a chicken that weighed more than you? More than a car? Note that is not important to have a very precise or accurate guess here, the key goal is simply to identify the range of plausible (or at least possible) values.\nJustify your choice with 1-3 sentences.\n\n\n\n\n\n\n\n\n\nSubrubric 2.a)\n\n\n\n\n\n\nQ3: \nDoes the chosen range meet the following common sense criteria?\n\nThe range is always above … and below ….\n\nQ4: \nIs the justification based on some sort of logic, even if you may disagree?\n\n\n\n\n\n\n\n\n\n\nSubtask 2.b)\n\n\n\n\n\nAdjust this range for a 12-day old chick and choose a mean \\(\\mu_0\\) for the weakly informed prior of the parameter \\(\\mu.\\) Justify your adjustment and choice with 1-3 sentences.\n\n\n\n\n\n\n\n\n\nSubrubric 2.b)\n\n\n\n\n\n\nQ5: \nDoes the chosen prior mean meet the following common sense criteria?\n\nThe range is always above … and below ….\n\nQ6: \nIs the justification based on some sort of logic, even if you may disagree?\n\n\n\n\n\n\n\n\n\n\nSubtask 2.c)\n\n\n\n\n\nChoosing the standard deviation of a prior requires a little more caution; overconfident (i.e. narrow) priors can have a strong effect on your results, whereas less confident priors are more easily overcome with observed data. Given that overconfidence is a common human bias, a good intuition-based standard deviation should focus on eliminating the impossible values, rather than including the most likely values. Using this constraint, choose a lower and/or upper bound for the weight of any 12-day old chick. Justify your choice with 1-3 sentences.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nDepending on your choice of range above for a “typical” chick, this range excluding the impossible values is likely to be wider.\n\n\n\n\n\n\n\n\n\nSubrubric 2.c)\n\n\n\n\n\n\nQ7: \nDoes the chosen range meet the following common sense criteria?\n\nThe range is always above … and below ….\n\nQ8: \nIs the justification based on some sort of logic, even if you may disagree?\n\n\n\n\n\n\n\n\n\n\nSubtask 2.d)\n\n\n\n\n\nA common technique recommended by Andrew Gelman for Stan users considers standardized data, and is that a weakly informed prior should have a standard deviation of an order of magnitude larger than the data. What is your standard deviation? Under Gelman’s recommendation, what \\(\\sigma\\) should you use for your prior?\n\n\n\n\n\n\n\n\n\nSubrubric 2.d)\n\n\n\n\n\n\nQ9: \nDo the two standard deviations meet the following common sense criteria?\n\nBoth values are …\nThe prior \\(\\sigma\\) is 10 times larger than …\n\nQ10: \nGiven the choice of mean from above, the prior’s range defined by \\(\\mu \\pm \\sigma\\) overlaps with ….\n\n\n\n\n\n\n\n\n\n\nSubtask 2.e)\n\n\n\n\n\nWrite down in mathematical form the final prior you found using this prior definition technique.\n\n\n\n\n\n\n\n\n\nSubrubric 2.e)\n\n\n\n\n\n\nQ11: \nDoes the final prior exist in mathematical notation?\nQ12: \nDoes the prior reflect the choices made above (i.e. \\(\\mu, \\sigma\\))?"
  },
  {
    "objectID": "assignment7.html#choosing-a-weakly-informative-prior-using-external-references",
    "href": "assignment7.html#choosing-a-weakly-informative-prior-using-external-references",
    "title": "Assignment 7",
    "section": "2.2 Choosing a weakly informative prior using external references",
    "text": "2.2 Choosing a weakly informative prior using external references\nNext, we’ll use external references to pick the weakly informed prior. This technique is more general and doesn’t assume you would have prior knowledge.\n\n\n\n\n\n\nSubtask 2.f)\n\n\n\n\n\nConsult a trustworthy source on the weight range of farm chickens, e.g. books, articles, a farmer friend. If the recommended values are for a fully grown chicken, make a reasonable adjustment for a 12-day old chick. What is the weight range of a 12-day old chicken? Cite your source and justify any adjustments you make to the reference range.\n\n\n\n\n\n\n\n\n\nSubrubric 2.f)\n\n\n\n\n\n\nQ13: \nDoes the reference range meet the following common sense criteria?\n\nThe range is always above … and below ….\n\nQ14: \nIs there a citation? If an adjustment was made, was it justified by logic, even if you disagree?\n\n\n\n\n\n\n\n\n\n\nSubtask 2.g)\n\n\n\n\n\nBased on this reference range, what will you choose for the mean of our weakly informed prior? Justify your choice with 1-3 sentences.\n\n\n\n\n\n\n\n\n\nSubrubric 2.g)\n\n\n\n\n\n\nQ15: \nDoes the mean value meet the following common sense criteria?\n\nThe range is always above … and below ….\n\n\n\n\n\nNext we choose the standard deviation of the prior. We could use the same technique as before, but we’ll walk you through another common approach. Assume that \\(99.7\\%\\) of all 12-day old chicks fall into the reference range you found. Under our assumption of a Normal distribution, this range will encompass values between \\(\\mu \\pm 3\\sigma\\).\n\n\n\n\n\n\nSubtask 2.h)\n\n\n\n\n\nAssuming symmetry, use the mean you chose and either the upper or lower bound \\(b\\) of your reference range to solve the correct version of the following equations to find your associated choice of \\(\\sigma\\): (show your work)\n\nFor upper bound \\(b\\): \\(Pr(\\mu + 3\\sigma &lt; b) \\approx 0.997\\), solving for \\(\\sigma\\).\nFor lower bound \\(b\\): \\(Pr(\\mu - 3\\sigma &gt; b) \\approx 0.997\\), solving for \\(\\sigma\\).\n\n\n\n\n\n\n\n\n\n\nSubrubric 2.h)\n\n\n\n\n\n\nQ16: \nDoes the calculated \\(\\sigma\\) value meet the following common sense criteria?\n\nThe value is above … and below ….\n\nQ17: \nDid they show their work?\n\n\n\n\n\n\n\n\n\n\nSubtask 2.i)\n\n\n\n\n\nWrite down in mathematical form the final prior you found using this prior definition technique.\n\n\n\n\n\n\n\n\n\nSubrubric 2.i)\n\n\n\n\n\n\nQ18: \nDoes the final prior exist in mathematical notation?\nQ19: \nDoes the prior reflect the choices made above (i.e. \\(\\mu, \\sigma\\))?"
  },
  {
    "objectID": "assignment7.html#non-normal-priors",
    "href": "assignment7.html#non-normal-priors",
    "title": "Assignment 7",
    "section": "2.3 Non-normal priors",
    "text": "2.3 Non-normal priors\nThe previous steps all assumed we could use a prior which is Normally distributed, but this may not always be the correct assumption to make.\n\n\n\n\n\n\nSubtask 2.j)\n\n\n\n\n\nUnder what mathematical/statistical circumstances would a Normal distributed prior not make sense? List at least one circumstance. Are there values that the Normal distribution can take on which would not make sense for some types of variables?\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nConsider the nature of any variable you are trying to define a prior over.\n\n\n\n\n\n\n\n\n\nSubrubric 2.j)\n\n\n\n\n\n\nQ20: \nExample cases include variables that … or variables that …"
  },
  {
    "objectID": "assignment7.html#modeling-diet-effects-on-chicken-weight",
    "href": "assignment7.html#modeling-diet-effects-on-chicken-weight",
    "title": "Assignment 7",
    "section": "2.4 Modeling diet effects on chicken weight",
    "text": "2.4 Modeling diet effects on chicken weight\nIn addition to chick weights, the data also contains a categorical variable indicating which diet the chick received. In the data file, each column contains the measurements for a single chick at a given point of time.\nIn addition to the existing diets, we are interested in the quality of another box of feed (the fifth diet), which a farmer happened to find yesterday at a dark corner of his warehouse. To read in the data, and to have a peek at the first 6 rows, just use:\n\n\n\n\n\n\nData inside, don’t peek before you have set your priors!\n\n\n\n\n\n\n\n\n\n\n\nHave you set your priors?\n\n\n\n\n\n\ndata(\"ChickWeight\")\n\nChick12 &lt;- ChickWeight |&gt; filter(Time == 12)\n\nhead(Chick12)\n\nGrouped Data: weight ~ Time | Chick\n  weight Time Chick Diet\n1    106   12     1    1\n2    122   12     2    1\n3    115   12     3    1\n4    102   12     4    1\n5    141   12     5    1\n6    141   12     6    1\n\n\n\n\n\n\n\n\nIn the following analysis, we will model the weight of a chick at the age of 12 days. We will use the following three Gaussian models:\n\na separate model, in which each diet is modelled individually\na pooled model, in which all measurements are combined and there is no distinction between diets\na hierarchical model, which has a hierarchical structure as described in BDA3 Section 11.6\n\nAs in the model described in the book, use the same measurement standard deviation \\(\\sigma\\) for all the groups in the hierarchical model. In the separate model, however, use separate measurement standard deviation \\(\\sigma_d\\) for each diet \\(d\\). You should use weakly informative priors for all your models, preferably one of the ones you already defined (and justified) in the previous/above section.\nThe provided Stan code below is given as an example of a separate model. Note that the author has left a comment expressing uncertainty about their prior choices. This separate model can be summarized mathematically as: \\[\n\\begin{aligned}\n    w_{ij} &\\sim N(\\mu_j,\\sigma_j)\\\\\n    \\mu_{j} &\\sim N(0,1)\\\\\n    \\sigma_{j} &\\sim \\exp(1)\n\\end{aligned}\n\\]\ndata {\n  int&lt;lower=0&gt; N_observations;\n  int&lt;lower=0&gt; N_diets;\n  array[N_observations] int diet_idx; // Pair observations to their diets.\n  vector[N_observations] weight;\n}\n\nparameters {\n  // Average weight of chicks with a given diet.\n  vector[N_diets] mean_diet;\n\n  // Standard deviation of weights observed among chicks sharing a diet.\n  vector&lt;lower=0&gt;[N_diets] sd_diet;\n}\n\nmodel {\n  // Priors\n  // These look bad. I need to think about these again.\n\n  for (diet in 1:N_diets) {\n    mean_diet[diet] ~ normal(0, 10);\n    sd_diet[diet] ~ exponential(1);\n  }\n\n  // Likelihood\n  for (obs in 1:N_observations) {\n    weight[obs] ~ normal(mean_diet[diet_idx[obs]], sd_diet[diet_idx[obs]]);\n  }\n\n  // Best practice would be to write the likelihood without the for loop as:\n  // weight ~ normal(mean_diet[diet_idx], sd_diet[diet_idx]);\n}\n\ngenerated quantities {\n  real weight_pred;\n  real mean_five;\n  // The below is just there to make the plotting in the template work with the \"wrong model\". \n  real sd_diets = sd_diet[4];\n\n  // Sample from the (posterior) predictive distribution of the fourth diet.\n  weight_pred = normal_rng(mean_diet[4], sd_diet[4]);\n\n  // Construct samples of the mean of the fifth diet.\n  // We only have the prior...\n  mean_five = normal_rng(0, 10);\n}\n\n\n\n\n\n\nSubtask 2.k)\n\n\n\n\n\nDescribe the models with mathematical notation (as is done for the separate model above). Also describe in words the difference between the model and the other models.\n\n\n\n\n\n\n\n\n\nSubrubric 2.k)\n\n\n\n\n\n\nQ21: \nAre the models described using mathematical notation and the difference to other models described in words?\n\nNo equations and no description\nDescription but no equations\nEquations but no description\nEquations and description\n\n\n\n\n\n\n\n\n\n\n\nSubtask 2.l)\n\n\n\n\n\nImplement the models in Stan and include the code in the report. Use weakly informative priors for all of your models.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nWhen sampling for the hierarchical model, you will very likely get a warning about divergent transitions. This tells you that the sampler is having difficulties in sampling the joint posterior and this may lead to biased inference. We will return to this in the next task.\n\n\n\n\n\n\n\n\n\nSubrubric 2.l)\n\n\n\n\n\n\nQ22: \nIs there a related Stan implementation?\n\nNo Stan model implemented\nStan model implemented, but it seems clearly wrong or broken\nSeemingly valid Stan model implemented\n\n\n\n\n\n\n\n\n\n\n\nSubtask 2.m)\n\n\n\n\n\nUse the provided code in the template to plot the posterior distribution of the mean of the weight measurements of the fourth diet and comment on the possible differences you observe between the models.\n\n\n\n\n\n\n\n\n\nSubrubric 2.m)\n\n\n\n\n\n\nQ23: \nIs there a comparison plotted for the posteriors of the mean of diet 4? Does it look something like the model solution plot?\n\nNo comparison plotted\nComparison plotted but it clearly differs from the example\nComparison plotted and it approximately matches the example\n\nQ24: \nSeparate model: Is the result for the separate model discussed?\n\nThe result is not discussed.\nThere is some discussion, but it is not mentioned that ….\nThe result is discussed and the separate model is recognised as ….\n\nQ25: \nPooled model: Is the result for the pooled model discussed?\n\nThe result is not discussed.\nThere is some discussion, but it is not mentioned that ….\nThe result is discussed and the pooled model is recognised as ….\n\nQ26: \nHierarchical model: Is the result for the hierarchical model discussed?\n\nThe result is not discussed.\nThere is some discussion, but it is not mentioned that ….\nThe result is discussed and the hierarchical model is recognised as ….\n\n\n\n\n\n\n\n\n\n\n\nSubtask 2.n)\n\n\n\n\n\nUse the provided code in the template to plot the predictive distribution for another weight measurement from a chick having the fourth diet and comment on the possible differences you observe between the models.\n\n\n\n\n\n\n\n\n\nSubrubric 2.n)\n\n\n\n\n\n\nQ27: \nIs there a comparison plotted for the predictive distributions of the weight of a chick with diet 4? Does it look something like the model solution plot?\n\nNo comparison plotted\nComparison plotted but it clearly differs from the example\nComparison plotted and it approximately matches the example\n\nQ28: \nSeparate model: Is the result for the separate model discussed?\n\nThe result is not discussed.\nThere is some discussion, but it is not mentioned that ….\nThe result is discussed and the separate model is recognised as ….\n\nQ29: \nPooled model: Is the result for the pooled model discussed?\n\nThe result is not discussed.\nThere is some discussion, but it is not mentioned that ….\nThe result is discussed and the pooled model is recognised as ….\n\nQ30: \nHierarchical model: Is the result for the hierarchical model discussed?\n\nThe result is not discussed.\nThere is some discussion, but it is not mentioned that ….\nThe result is discussed and the hierarchical model is recognised as ….\n\n\n\n\n\n\n\n\n\n\n\nSubtask 2.o)\n\n\n\n\n\nUse the provided code in the template to plot the posterior distribution of the mean of the weight measurements of a new fifth diet and comment on the possible differences you observe between the models.\n\n\n\n\n\n\n\n\n\nSubrubric 2.o)\n\n\n\n\n\n\nQ31: \nIs there a comparison plotted for the posterior distributions of the mean weight with a new diet? Does it look something like the model solution plot?\n\nNo comparison plotted\nComparison plotted but it clearly differs from the example\nComparison plotted and it approximately matches the example\n\nQ32: \nSeparate model: Is the result for the separate model discussed?\n\nThe result is not discussed.\nThere is some discussion, but it is not mentioned that ….\nThe result is discussed and the separate model is recognised as ….\nIn addition to the previous option, it is recognised that the separate model only ….\n\nQ33: \nPooled model: Is the result for the pooled model discussed?\n\nThe result is not discussed.\nThere is some discussion, but it is not mentioned that ….\nThe result is discussed and the pooled model is recognised as ….\nIn addition to the previous option, it is mentioned that ….\n\nQ34: \nHierarchical model: Is the result for the hierarchical model discussed?\n\nThe result is not discussed.\nThere is some discussion, but it is not mentioned that ….\nThe result is discussed and the hierarchical model is recognised as ….\n\n\n\n\n\n\n\n\n\n\n\nSubtask 2.p)\n\n\n\n\n\nFor each model, report the posterior expectation for the mean weight of diet 4 with a 90% credible interval.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nSee the example Stan codes here for the comparison of \\(K\\) groups with and without the hierarchical structure.\n\n\n\n\n\n\n\n\n\nSubrubric 2.p)\n\n\n\n\n\n\nQ35: \nFor the separate model, is the posterior 90% credibility interval for the mean of the fourth diet close to: … (small deviation is fine).\n\nNo or incorrect answer\nAnswer is only partially correct\nAnswers look correct\n\nQ36: \nFor the pooled model, is the posterior 90% credibility interval for the mean of the fourth diet close to: … (small deviation is fine).\n\nNo answer\nAnswer is only partially correct\nAnswer looks correct\n\nQ37: \nFor the hierarchical model, is the posterior 90% credibility interval for the mean of the fourth diet close to: … (small deviation is fine).\n\nNo answer\nAnswer is only partially correct.\nAnswers look correct."
  },
  {
    "objectID": "template1.html",
    "href": "template1.html",
    "title": "Assignment 1",
    "section": "",
    "text": "Setup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThis is the template for assignment 1. You can download the qmd-file or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\nThe following will set-up markmyassignment to check your functions at the end of the notebook:\n\nlibrary(markmyassignment) \nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/assignments/tests/assignment1.yml\", sep=\"\")\nset_assignment(assignment_path)   \n\nAssignment set:\nassignment1: Bayesian Data Analysis: Assignment 1\nThe assignment contain the following (3) tasks:\n- p_red\n- p_box\n- p_identical_twin"
  },
  {
    "objectID": "template1.html#a",
    "href": "template1.html#a",
    "title": "Assignment 1",
    "section": "3.1 (a)",
    "text": "3.1 (a)\nPlot the PDF here. Explain shortly what you do.\n\n# Useful functions: seq(), plot() and dbeta()"
  },
  {
    "objectID": "template1.html#b",
    "href": "template1.html#b",
    "title": "Assignment 1",
    "section": "3.2 (b)",
    "text": "3.2 (b)\nDraw samples and plot the histogram here. Explain shortly what you do.\n\n# Useful functions: rbeta() and hist()"
  },
  {
    "objectID": "template1.html#c",
    "href": "template1.html#c",
    "title": "Assignment 1",
    "section": "3.3 (c)",
    "text": "3.3 (c)\nCompute the sample mean and variance here. Explain shortly what you do.\n\n# Useful functions: mean() and var()"
  },
  {
    "objectID": "template1.html#d",
    "href": "template1.html#d",
    "title": "Assignment 1",
    "section": "3.4 (d)",
    "text": "3.4 (d)\nCompute the central interval here. Explain shortly what you do.\n\n# Useful functions: quantile()"
  },
  {
    "objectID": "template1.html#e",
    "href": "template1.html#e",
    "title": "Assignment 1",
    "section": "4.1 (e)",
    "text": "4.1 (e)\nCompute the quantities needed to justify your recommendation here. Explain shortly what you do.\n\n# You can do the computation with pen and paper or in R. \n# Either way, you have to explain why you compute what you compute."
  },
  {
    "objectID": "template1.html#a-1",
    "href": "template1.html#a-1",
    "title": "Assignment 1",
    "section": "5.1 (a)",
    "text": "5.1 (a)\nKeep the below name and format for the function to work with markmyassignment:\n\np_red &lt;- function(boxes) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    0.3928571\n}"
  },
  {
    "objectID": "template1.html#b-1",
    "href": "template1.html#b-1",
    "title": "Assignment 1",
    "section": "5.2 (b)",
    "text": "5.2 (b)\nKeep the below name and format for the function to work with markmyassignment:\n\np_box &lt;- function(boxes) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.29090909,0.07272727,0.63636364)\n}"
  },
  {
    "objectID": "template1.html#c-1",
    "href": "template1.html#c-1",
    "title": "Assignment 1",
    "section": "6.1 (c)",
    "text": "6.1 (c)\nYou will need to change the numbers to the numbers in the exercise.\n\nfraternal_prob = 1/125\nidentical_prob = 1/300\n\nKeep the below name and format for the function to work with markmyassignment:\n\np_identical_twin &lt;- function(fraternal_prob, identical_prob) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    0.4545455\n}\n\n\n\n\n\n\n\nmarkmyassignment\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following will check the functions for which markmyassignment has been set up:\n\nmark_my_assignment()  \n\n✔ | F W S  OK | Context\n\n⠏ |         0 | task-1-subtask-1-tests                                          \n⠏ |         0 | p_red()                                                         \n✖ | 1       3 | p_red()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:21'): p_red()\np_red(boxes = boxes) not equivalent to 0.5.\n1/1 mismatches\n[1] 0.393 - 0.5 == -0.107\nError: Incorrect result for matrix(c(1,1,1,1,1,1), ncol = 2)\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-2-subtask-1-tests                                          \n⠏ |         0 | p_box()                                                         \n✖ | 1       3 | p_box()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-2-subtask-1-tests.R:19'): p_box()\np_box(boxes = boxes) not equivalent to c(0.4, 0.1, 0.5).\n3/3 mismatches (average diff: 0.0909)\n[1] 0.2909 - 0.4 == -0.1091\n[2] 0.0727 - 0.1 == -0.0273\n[3] 0.6364 - 0.5 ==  0.1364\nError: Incorrect result for matrix(c(1,1,1,1,1,1), ncol = 2)\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-3-subtask-1-tests                                          \n⠏ |         0 | p_identical_twin()                                              \n✖ | 2       3 | p_identical_twin()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-3-subtask-1-tests.R:16'): p_identical_twin()\np_identical_twin(fraternal_prob = 1/100, identical_prob = 1/500) not equivalent to 0.2857143.\n1/1 mismatches\n[1] 0.455 - 0.286 == 0.169\nError: Incorrect result for fraternal_prob = 1/100 and identical_prob = 1/500\n\nFailure ('test-task-3-subtask-1-tests.R:19'): p_identical_twin()\np_identical_twin(fraternal_prob = 1/10, identical_prob = 1/20) not equivalent to 0.5.\n1/1 mismatches\n[1] 0.455 - 0.5 == -0.0455\nError: Incorrect result for fraternal_prob = 1/10 and identical_prob = 1/20\n────────────────────────────────────────────────────────────────────────────────\n\n══ Results ═════════════════════════════════════════════════════════════════════\nDuration: 0.1 s\n\n[ FAIL 4 | WARN 0 | SKIP 0 | PASS 9 ]"
  },
  {
    "objectID": "assignment2.html",
    "href": "assignment2.html",
    "title": "Assignment 2",
    "section": "",
    "text": "\\[\n% You can add TeX macros here for HTML, see https://quarto.org/docs/authoring/markdown-basics.html#equations\n\\renewcommand{\\BetaDist}{\\mathrm{Beta}}\n\\]\n\n\n1 General information\nThis assignment is related to Chapters 1 and 2. You may find an additional discussion about choosing priors in a blog post by Andrew Gelman.\nThe maximum amount of points from this assignment is 3.\nWe prepared a quarto template to help you get started.\n\n\n\n\n\n\nTip\n\n\n\n\n\nReading instructions:\nChapter 1 and 2 in BDA3, see the reading instructions for Chapter 1 and the reading instructions for Chapter 2.\nGrading instructions:\nThe grading will be done in peergrade.\nAll grading questions and evaluations for this assignment are contained within this document in the collapsible Rubric blocks.\n\n\n\n\n\n\n\n\n\nFurther information\n\n\n\n\n\n\nThe recommended tool in this course is R (with the IDE R-Studio). You can download R here and R-Studio here. There are tons of tutorials, videos and introductions to R and R-Studio online. You can find some initial hints from RStudio Education pages.\nInstead of installing R and RStudio on you own computer, see how to use R and RStudio remotely.\nWhen working with R, we recommend writing the report using quarto and the soon to be provided template. The remplate includes the formatting instructions and how to include code and figures.\nInstead of quarto, you can use other software to make the PDF report, but the the same instructions for formatting should be used..\nReport all results in a single, anonymous *.pdf -file and return it to peergrade.io.\nThe course has its own R package aaltobda with data and functionality to simplify coding. To install the package just run the following (upgrade=\"never\" skips question about updating other packages):\n\ninstall.packages(\"remotes\")\nremotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n\nMany of the exercises can be checked automatically using the R package\nmarkmyassignment. Information on how to install and use the package can be found here. There is no need to include markmyassignment results in the report.\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in peergrade. You can set email alerts for trhe deadlines in peergrade settings.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet. You can copy, e.g., plotting code from the course demos, but really try to solve the actual assignment problems with your own code and explanations. Do not share your answers publicly. Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year. All suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nDo not submit empty PDFs or almost empty PDFs as these are just harming the other students as they can’t do peergrading for the empty or almost empty submissions. Violations of this rule will be reported and investigated in the same way was plagiarism.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\n\n\n\n\nRubric S1: General information - 7.5/100 points\n\n\n\n\n\n\nQ1: \nCan you open the PDF and it’s not blank?\n\nQ2: \nIs the report anonymous?\n\n\n\n\n\n\n2 Inference for binomial proportion\nAlgae status is monitored in 274 sites at Finnish lakes and rivers. The observations for the 2008 algae status at each site are presented in the dataset algae in the aaltobda package (‘0’: no algae, ‘1’: algae present).\nLet \\(\\pi\\) be the probability of a monitoring site having detectable blue-green algae levels and \\(y\\) the observations in algae. Use a binomial model for the observations \\(y\\) and a \\(\\BetaDist(2,10)\\) prior for binomial model parameter \\(\\pi\\) to formulate a Bayesian model. Here it is not necessary to derive the posterior distribution for \\(\\pi\\) as it has already been done in the book and it suffices to refer to that derivation. Also, it is not necessary to write out the distributions; it is sufficient to use label-parameter format, e.g. \\(\\BetaDist(\\alpha,\\beta)\\).\nYour task is to perform Bayesian inference for a binomial model and answer questions based on it:\n\n\n\n\n\n\nSubtask 2.a)\n\n\n\n\n\nFormulate\n\nthe likelihood \\(p(y|\\pi)\\) as a function of \\(\\pi\\),\nthe prior \\(p(\\pi)\\), and\nthe resulting posterior \\(p(\\pi|y)\\).\n\nReport the posterior in the format \\(\\BetaDist(\\alpha,\\beta)\\), where you replace \\(\\alpha\\) and \\(\\beta\\) with the correct numerical values.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nWith a conjugate prior, a closed-form posterior has Beta form (see equations in the book and in the slides).\n\n\n\n\n\n\n\n\n\nSubtask 2.b)\n\n\n\n\n\nWhat can you say about the value of the unknown \\(\\pi\\) according to the observations and your prior knowledge? Summarize your results with a point estimate (i.e. \\(E(\\pi|y)\\)) and a 90% posterior interval.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nPosterior intervals are also called credible intervals and are different from confidence intervals.\n\n\n\n\n\n\n\n\n\nSubtask 2.c)\n\n\n\n\n\nWhat is the probability that the proportion of monitoring sites with detectable algae levels \\(\\pi\\) is smaller than \\(\\pi_0=0.2\\) that is known from historical records?\n\n\n\n\n\n\n\n\n\nSubtask 2.d)\n\n\n\n\n\nWhat assumptions are required in order to use this kind of a model with this type of data?\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nNo need to discuss exchangeability yet, as it is discussed in more detail in BDA Chapter 5 and Lecture 7.\n\n\n\n\n\n\n\n\n\nSubtask 2.e)\n\n\n\n\n\nMake prior sensitivity analysis by testing a couple of different reasonable priors and plot the different posteriors. Summarize the results by one or two sentences.\n\n\n\n\n\n\n\n\n\nRubric S2: Inference for binomial proportion - 85/100 points\n\n\n\n\n\n\nQ3: \nIs source code included?\nQ4: \nAre the prior, likelihood and posterior forms in a) reported (derivation of posterior not necessary)?\n\nNo\nSome missing\nYes\n\nQ5: \nIs the reported resulting posterior correct …?\n\nIt is not reported, that the posterior distribution is a … distribution.\nIt is reported, that the posterior distribution is …, but the numerical values for the parameters are incorrect\nIt is reported, that the posterior distribution is …, and the numerical values for the parameters are correct.\n\nQ6: \nIn part b), is there at least one point estimate reported. Sample based estimates are also ok. Points should be given if the method is right, even if the result is wrong due to a wrong posterior distribution being used. With the right posterior, mean, median, and mode are all approximately ….\nQ7: \nFor the b) part, is the 90% posterior interval reported? Sample based estimate is also ok. Points should be given if the method is right, even if the result is wrong because the posterior was wrong in the first place. If the posterior was right, the 90% posterior interval is roughly ….\nQ8: \nFor the c) part, is the posterior probability Pr(π&lt;0.2|y) reported? Points should be given if the method is right, even if the result is wrong because the posterior was wrong. If the posterior was right, the result should be approximately ….\nQ9: \nFor the d) part, does the report discuss …\n\nNo\nNo, but other reasonable assumptions are discussed\nYes, but not quite right or some missing\nYes\n\nQ10: \nFor the e) part, is there some comparison and discussion of results obtained with alternative prior parameters?\n\nNo\nYes, but the results and conclusions are clearly wrong\nYes\n\n\n\n\n\n\n\n3 Overall quality of the report\n\n\n\n\n\n\nRubric S3: Overall quality of the report - 7.5/100 points\n\n\n\n\n\n\nQ11: \nDoes the report follow the formatting instructions?\n\nNot at all\nLittle\nMostly\nYes\n\nQ12: \nIn case the report doesn’t fully follow the formatting instructions, specify the formatting instruction that is not followed. If applicable, specify the page of the report, where this difference in formatting is visible.\nQ13: \nPlease provide also feedback on the presentation (e.g. text, layout, flow of the responses, figures, figure captions). Part of the course is practicing making data analysis reports. By providing feedback on the report presentation and other students can learn what they can improve or what they already did well. You should be able to provide constructive or positive feedback for all non-empty reports, even if there is nothing to say about the technical correctness of the answers. You can also provide feedback on code."
  },
  {
    "objectID": "simple_template6.html",
    "href": "simple_template6.html",
    "title": "Assignment 6",
    "section": "",
    "text": "1 General information\n\n\n\n\n\n\nReporting accuracy\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\nSee lecture video 4.1, the chapter notes, and a case study for more information.\n\n\nThis is the template for assignment 6. You can download the qmd-file or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following installs and loads the aaltobda package:\n\nif(!require(aaltobda)){\n    install.packages(\"remotes\")\n    remotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n    library(aaltobda)\n}\n\nLoading required package: aaltobda\n\n\nThe following installs and loads the latex2exp package, which allows us to use LaTeX in plots:\n\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n\nLoading required package: latex2exp\n\n\nThe following installs and loads the posterior package which imports the rhat_basic() function:\n\nif(!require(posterior)){\n    install.packages(\"posterior\")\n    library(posterior)\n}\n\nLoading required package: posterior\n\n\nThis is posterior version 1.4.0\n\n\n\nAttaching package: 'posterior'\n\n\nThe following object is masked from 'package:aaltobda':\n\n    mcse_quantile\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\n\nThe following installs and loads the ggplot2 package, the bayesplot package and the dplyr package\n\nif(!require(ggplot2)){\n    install.packages(\"ggplot2\")\n    library(ggplot2)\n}\n\nLoading required package: ggplot2\n\nif(!require(bayesplot)){\n    install.packages(\"bayesplot\")\n    library(bayesplot)\n}\n\nLoading required package: bayesplot\n\n\nThis is bayesplot version 1.10.0\n\n\n- Online documentation and vignettes at mc-stan.org/bayesplot\n\n\n- bayesplot theme set to bayesplot::theme_default()\n\n\n   * Does _not_ affect other ggplot2 plots\n\n\n   * See ?bayesplot_theme_set for details on theme setting\n\n\n\nAttaching package: 'bayesplot'\n\n\nThe following object is masked from 'package:posterior':\n\n    rhat\n\nif(!require(dplyr)){\n    install.packages(\"dplyr\")\n    library(dplyr)\n}\n\nLoading required package: dplyr\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nif(!require(tidyr)){\n    install.packages(\"tidyr\")\n    library(tidyr)\n}\n\nLoading required package: tidyr\n\n# Some additional set-up to make plots legible\nggplot2::theme_set(theme_minimal(base_size = 14))\nbayesplot::bayesplot_theme_set(theme_minimal(base_size = 14))\n# register_knitr_engine()\n\nThe following installs and loads the cmdstanr package and tries to install cmdstan.\n\nif(!require(cmdstanr)){\n    install.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")))\n    library(cmdstanr)\n}\n\nLoading required package: cmdstanr\n\n\nThis is cmdstanr version 0.5.3\n\n\n- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr\n\n\n- CmdStan path: /home/niko/.cmdstan/cmdstan-2.31.0\n\n\n- CmdStan version: 2.31.0\n\ncmdstan_installed &lt;- function(){\n  res &lt;- try(out &lt;- cmdstanr::cmdstan_path(), silent = TRUE)\n  !inherits(res, \"try-error\")\n}\nif(!cmdstan_installed()){\n    install_cmdstan()\n}\n\n\n\n\n\n\n2 Stan warm-up: linear model of BDA retention with Stan (2 points)\nWrite your answers/code here!\n\n\n# These are our observations y: the proportion of students handing in each assignment (1-8),\n# sorted by year (row-wise) and assignment (column-wise).\n# While the code suggest a matrix structure, \n# the result will actually be a vector of length N = no_years * no_assignments\npropstudents&lt;-c(c(176, 174, 158, 135, 138, 129, 126, 123)/176,\n                c(242, 212, 184, 177, 174, 172, 163, 156)/242,\n                c(332, 310, 278, 258, 243, 242, 226, 224)/332,\n                c(301, 269, 231, 232, 217, 208, 193, 191)/301,\n                c(245, 240, 228, 217, 206, 199, 191, 182)/245)\n# These are our predictors x: for each observation, the corresponding assignment number.\nassignment &lt;- rep(1:8, 5)\n# These are in some sense our test data: the proportion of students handing in the last assignment (9),\n# sorted by year. \n# Usually, we would not want to split our data like that and instead\n# use e.g. Leave-One-Out Cross-Validation (LOO-CV, see e.g. http://mc-stan.org/loo/index.html)\n# to evaluate model performance.\npropstudents9 = c(121/176, 153/242, 218/332, 190/301, 175/245)\n# The total number of assignments\nno_assignments = 9\n# The assignment numbers for which we want to generate predictions\nx_predictions = 1:no_assignments\n# (Cmd)Stan(R) expects the data to be passed in the below format:\nmodel_data = list(N=length(assignment),\n                 x=assignment,\n                 y=propstudents,\n                 no_predictions=no_assignments,\n                 x_predictions=x_predictions)\n# This reads the file at the specified path and tries to compile it. \n# If it fails, an error is thrown.\nretention_model = cmdstan_model(\"./assignment6_linear_model.stan\")\n# This \"out &lt;- capture.output(...)\" construction suppresses output from cmdstanr\n# See also https://github.com/stan-dev/cmdstanr/issues/646\nout &lt;- capture.output(\n    # Sampling from the model happens here:\n    fit &lt;- retention_model$sample(data=model_data, refresh=0, show_messages=FALSE)\n)\n# This extracts the draws from the sampling result as a data.frame.\ndraws_df = fit$draws(format=\"draws_df\")\n\n# This does some data/draws wrangling to compute the 5, 50 and 95 percentiles of \n# the mean at the specified covariate values (x_predictions). \n# It can be instructive to play around with each of the data processing steps\n# to find out what each step does, e.g. by removing parts from the back like \"|&gt;  gather(pct,y,-x)\"\n# and printing the resulting data.frame.\nmu_quantiles_df = draws_df |&gt; \n      select(starts_with(c(\"mu_pred\"))) |&gt; \n      apply(2, quantile, c(0.05, 0.5, 0.95)) |&gt; \n      t() |&gt; data.frame(x=x_predictions) |&gt;  gather(pct,y,-x)\n# Same as above, but for the predictiions.\ny_quantiles_df = draws_df |&gt; \n      select(starts_with(c(\"y_pred\"))) |&gt; \n      apply(2, quantile, c(0.05, 0.5, 0.95)) |&gt; \n      t() |&gt; data.frame(x=x_predictions) |&gt;  gather(pct,y,-x)\n\n# Plotting happens here:\nggplot() +\n  # scatter plot of the training data:  \n  geom_point(aes(x, y), data = data.frame(x=assignment, y=propstudents), size = 1) +\n  # scatter plot of the test data:\n  geom_point(aes(x, y), data = data.frame(x=no_assignments, y=propstudents9), size = 1, color='blue') +\n  # you have to tell us what this plots:\n  geom_line(aes(x,y,linetype=pct), data=mu_quantiles_df, color = 'grey', linewidth=1.5) +\n  # you have to tell us what this plots:\n  geom_line(aes(x,y,linetype=pct), data=y_quantiles_df, color = 'red') +\n  # adding xticks for each assignment:\n  scale_x_continuous(breaks=1:no_assignments) +\n  # adding labels to the plot:\n  labs(y = \"Assignment submission %\", x= \"Assignment Number\") +\n  # specifying that line types repeat:\n  scale_linetype_manual(values=c(2,1,2)) +\n  # remove the legend for the linetypes:\n  guides(linetype = \"none\")\n\n\n\n\n\n\n\n\n\n\n\nQuick check for model convergence\n\n\n\n\n\nIf your model is correctly implemented, sampling should have been succesful. You can check whether Stan thinks that sampling succeeded by inspecting the output of the below command, which you should be able to interpret with a little help from the CmdStan User’s Guide. If\n\nfit$cmdstan_diagnose()\n\nProcessing csv files: /tmp/RtmpmYqwY7/assignment6_linear_model-202303231112-1-230213.csv, /tmp/RtmpmYqwY7/assignment6_linear_model-202303231112-2-230213.csv, /tmp/RtmpmYqwY7/assignment6_linear_model-202303231112-3-230213.csv, /tmp/RtmpmYqwY7/assignment6_linear_model-202303231112-4-230213.csv\n\nChecking sampler transitions treedepth.\nTreedepth satisfactory for all transitions.\n\nChecking sampler transitions for divergences.\nNo divergent transitions found.\n\nChecking E-BFMI - sampler transitions HMC potential energy.\nE-BFMI satisfactory.\n\nEffective sample size satisfactory.\n\nSplit R-hat values satisfactory all parameters.\n\nProcessing complete, no problems detected.\n\n\n\n\n\nWrite your answers/code here!\n\n\n3 Generalized linear model: Bioassay with Stan (4 points)\nWrite your answers/code here!\n\ndata(\"bioassay\")\n\nWrite your answers/code here!\nWrite your answers/code here!\nWrite your answers/code here!"
  },
  {
    "objectID": "template7.html",
    "href": "template7.html",
    "title": "Assignment 7",
    "section": "",
    "text": "This is the template for assignment 7. You can download the separate model with bad priors and the qmd-file or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following loads several needed packages:\n\nlibrary(aaltobda)\nlibrary(bayesplot)\n\nThis is bayesplot version 1.10.0\n\n\n- Online documentation and vignettes at mc-stan.org/bayesplot\n\n\n- bayesplot theme set to bayesplot::theme_default()\n\n\n   * Does _not_ affect other ggplot2 plots\n\n\n   * See ?bayesplot_theme_set for details on theme setting\n\nlibrary(cmdstanr)\n\nThis is cmdstanr version 0.5.3\n\n\n- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr\n\n\n- CmdStan path: /home/niko/.cmdstan/cmdstan-2.31.0\n\n\n- CmdStan version: 2.31.0\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(ggplot2)\nlibrary(ggdist) # for stat_dotsinterval\nlibrary(posterior)\n\nThis is posterior version 1.4.0\n\n\n\nAttaching package: 'posterior'\n\n\nThe following object is masked from 'package:bayesplot':\n\n    rhat\n\n\nThe following object is masked from 'package:aaltobda':\n\n    mcse_quantile\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\nif(!require(brms)){\n    install.packages(\"brms\")\n    library(brms)\n}\n\nLoading required package: brms\n\n\nLoading required package: Rcpp\n\n\nLoading 'brms' package (version 2.19.0). Useful instructions\ncan be found by typing help('brms'). A more detailed introduction\nto the package is available through vignette('brms_overview').\n\n\n\nAttaching package: 'brms'\n\n\nThe following objects are masked from 'package:ggdist':\n\n    dstudent_t, pstudent_t, qstudent_t, rstudent_t\n\n\nThe following object is masked from 'package:bayesplot':\n\n    rhat\n\n\nThe following object is masked from 'package:stats':\n\n    ar\n\n# Set more readable themes with bigger font for plotting packages.\nggplot2::theme_set(theme_minimal(base_size = 14))\nbayesplot::bayesplot_theme_set(theme_minimal(base_size = 14))\n\n# This registers CmdStan as the backend for compiling cmdstan-chunks.\ncheck_cmdstan_toolchain(fix = TRUE, quiet = TRUE)\nregister_knitr_engine(override = FALSE)"
  },
  {
    "objectID": "template7.html#choosing-a-weakly-informative-prior-by-intuition",
    "href": "template7.html#choosing-a-weakly-informative-prior-by-intuition",
    "title": "Assignment 7",
    "section": "2.1 Choosing a weakly informative prior by intuition",
    "text": "2.1 Choosing a weakly informative prior by intuition\n\n2.1.1 (a)\n\n\n2.1.2 (b)\n\n\n2.1.3 (c)\n\n\n2.1.4 (d)\n\n\n2.1.5 (e)"
  },
  {
    "objectID": "template7.html#choosing-a-weakly-informative-prior-using-external-references",
    "href": "template7.html#choosing-a-weakly-informative-prior-using-external-references",
    "title": "Assignment 7",
    "section": "2.2 Choosing a weakly informative prior using external references",
    "text": "2.2 Choosing a weakly informative prior using external references\n\n2.2.1 (f)\n\n\n2.2.2 (g)\n\n\n2.2.3 (h)\n\n\n2.2.4 (i)"
  },
  {
    "objectID": "template7.html#non-normal-priors",
    "href": "template7.html#non-normal-priors",
    "title": "Assignment 7",
    "section": "2.3 Non-normal priors",
    "text": "2.3 Non-normal priors\n\n2.3.1 (j)"
  },
  {
    "objectID": "template7.html#modeling-diet-effects-on-chicken-weight",
    "href": "template7.html#modeling-diet-effects-on-chicken-weight",
    "title": "Assignment 7",
    "section": "2.4 Modeling diet effects on chicken weight",
    "text": "2.4 Modeling diet effects on chicken weight\n\n\n\n\n\n\nData inside, don’t peek before you have set your priors!\n\n\n\n\n\n\n\n\n\n\n\nHave you set your priors?\n\n\n\n\n\n\ndata(\"ChickWeight\")\n\nChick12 &lt;- ChickWeight |&gt; filter(Time == 12)\n\nhead(Chick12)\n\nGrouped Data: weight ~ Time | Chick\n  weight Time Chick Diet\n1    106   12     1    1\n2    122   12     2    1\n3    115   12     3    1\n4    102   12     4    1\n5    141   12     5    1\n6    141   12     6    1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nModel fitting\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nTo run Stan for that model, simply use:\n\nstan_data &lt;- list(\n  N_observations = nrow(Chick12),\n  N_diets = length(unique(Chick12$Diet)),\n  diet_idx = Chick12$Diet,\n  weight = Chick12$weight\n)\n\nmodel_separate &lt;- cmdstan_model(stan_file = \"additional_files/assignment7/chickens_separate.stan\")\n\n# Sampling from the model happens here:\nfit_separate &lt;- model_separate$sample(data = stan_data, refresh=0,\n                                      show_messages=FALSE,\n                                      show_exceptions=FALSE)\n\nFit objects by default print a summary of the draws obtained. These are NOT the results you would expect to turn in your report. You will need to change the priors in the code for the separate model.\n\nfit_separate\n\n     variable mean median sd mad   q5  q95 rhat ess_bulk ess_tail\n lp__         -489   -489  2   2 -493 -486    1     1860     2276\n mean_diet[1]   74     74  8   8   60   86    1     3074     2857\n mean_diet[2]   51     51 11  11   34   68    1     3518     2878\n mean_diet[3]   52     52 11  11   34   71    1     3387     2653\n mean_diet[4]   53     52 11  11   35   71    1     3282     2910\n sd_diet[1]     30     30  4   4   24   37    1     3106     2300\n sd_diet[2]     40     40  5   5   33   48    1     3666     2990\n sd_diet[3]     43     42  5   5   35   51    1     3441     3054\n sd_diet[4]     44     44  5   5   36   52    1     3396     3114\n weight_pred    53     53 46  47  -22  127    1     3941     3925\n\n # showing 10 of 12 rows (change via 'max_rows' argument or 'cmdstanr_max_rows' option)\n\n\nQuick model convergence check (as in assignment 6):\n\nfit_separate$cmdstan_diagnose()\n\nProcessing csv files: /tmp/Rtmp3D95yy/chickens_separate-202304062148-1-1d198c.csv, /tmp/Rtmp3D95yy/chickens_separate-202304062148-2-1d198c.csv, /tmp/Rtmp3D95yy/chickens_separate-202304062148-3-1d198c.csv, /tmp/Rtmp3D95yy/chickens_separate-202304062148-4-1d198c.csv\n\nChecking sampler transitions treedepth.\nTreedepth satisfactory for all transitions.\n\nChecking sampler transitions for divergences.\nNo divergent transitions found.\n\nChecking E-BFMI - sampler transitions HMC potential energy.\nE-BFMI satisfactory.\n\nEffective sample size satisfactory.\n\nSplit R-hat values satisfactory all parameters.\n\nProcessing complete, no problems detected.\n\n\n\n\n\n\n2.4.1 (k)\n\n\n2.4.2 (l)\nFor the figures below, we use the earlier samples for the separate model with bad priors. When you have implemented the pooled and hierarchical models, edit the code below to include samples from your model into the figures.\n\n\n\n\n\n\nModel fitting and data preparation\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\n\nfit_pooled &lt;- fit_separate\nfit_hierarchical &lt;- fit_separate\n\nBelow, we collect the corresponding samples from the three models into a shared data frame using the extract_variable function. This makes plotting the samples in a single plot easier.\n\n# Expect the same number of samples from each model.\nn_samples &lt;- nrow(fit_hierarchical$sampler_diagnostics(format = \"matrix\"))\n\n# Collect samples and the model used to a data frame.\nposterior_mean_diet_4 &lt;- data.frame(\n  model_name = rep(c(\"Separate\", \"Pooled\", \"Hierarchical\"),\n              each = n_samples),\n  mean_diet_4 = c(\n   extract_variable(fit_separate, \"mean_diet[4]\"),\n   extract_variable(fit_pooled, \"mean_diet[4]\"),\n   extract_variable(fit_hierarchical, \"mean_diet[4]\")\n  ))\n\npredicted_weight_diet_4 &lt;- data.frame(\n  model_name = rep(c(\"Separate\", \"Pooled\", \"Hierarchical\"),\n              each = n_samples),\n  predicted_weight = c(\n   extract_variable(fit_separate, \"weight_pred\"),\n   extract_variable(fit_pooled, \"weight_pred\"),\n   extract_variable(fit_hierarchical, \"weight_pred\")\n  ))\n\n# Collect samples and the model used to a long data frame.\nposterior_mean_diet_5 &lt;- data.frame(\n  model_name = rep(c(\"Separate\", \"Pooled\", \"Hierarchical\"),\n    each = n_samples\n  ),\n  mean_diet_5 = c(\n    extract_variable(fit_separate, \"mean_five\"),\n    extract_variable(fit_pooled, \"mean_five\"),\n    extract_variable(fit_hierarchical, \"mean_five\")\n  )\n)\n\n# Mean observed weight per diet, these help to compare the posteriors to data.\ndiet_means &lt;- sapply(\n  1:4, function(diet) mean(Chick12[Chick12$Diet == diet, \"weight\"])\n)\n\n\n\n\n\n\n2.4.3 (m)\n\nggplot(posterior_mean_diet_4, aes(x = mean_diet_4, y = model_name)) +\n  stat_dotsinterval(quantiles = 100, scale = .9) +\n  vline_at(diet_means[4], size = 1, linetype = \"dashed\") +\n  # Annotate the vline from above.\n  annotate(\"text\", label = \"Observation mean\", x = diet_means[4] - 5, y = .7,\n           hjust = \"right\", size = 6) +\n  # Add title and axis labels. One line to make everything so much more clear!\n  labs(\n    title = \"Mean of diet 4\",\n    x = \"Weight (g)\",\n    y = \"Model\"\n  )\n\n\n\n\nPosterior distribution of the mean weight of chicks consuming diet 4.\n\n\n\n\n\n\n2.4.4 (n)\n\nggplot(predicted_weight_diet_4, aes(x = predicted_weight, y = model_name)) +\n  stat_dotsinterval(quantiles = 100, scale = .9) +\n  vline_at(diet_means[4], size = 1, linetype = \"dashed\") +\n  # Annotate the vline from above.\n  annotate(\"text\", label = \"Observation mean\", x = diet_means[4] - 5, y = .7,\n           hjust = \"right\", size = 6) +\n  # Add title and axis labels. One line to make everything so much more clear!\n  labs(\n    title = \"Weigth of a chick with diet 4\",\n    x = \"Weight (g)\",\n    y = \"Model\"\n  )\n\n\n\n\nThe (posterior) predictive distribution of the weigth of a chick consuming diet 4.\n\n\n\n\n\n\n2.4.5 (o)\n\nggplot(posterior_mean_diet_5, aes(x = mean_diet_5, y = model_name)) +\n  # Draw the mean of each diet from the data as a dashed vertical line.\n  vline_at(diet_means, size = .5, linetype = \"dashed\") +\n  # dotsinterval gives mean, 50%, and 90% intervals + dotsplot with each dot\n  # representing 1% of data (quantiles = 100).\n  stat_dotsinterval(quantiles = 100, scale = .9) +\n  # Annotate the vline from above.\n  annotate(geom = \"text\", label = \"Means of observed diets\", y = .7, x = 100,\n           hjust = \"right\", size = 5, family = \"sans\") +\n  # Add title and axis labels. One line to make everything so much more clear!\n  labs(title = \"Mean of a new diet\",\n       x = \"Weight (g)\",\n       y = \"Model\")\n\n\n\n\nPosterior distribution of the mean weight of chicks consuming the new diet 5 not seen before.\n\n\n\n\n\n\n2.4.6 (p)"
  },
  {
    "objectID": "general_info.html",
    "href": "general_info.html",
    "title": "Bayesian Data Analysis",
    "section": "",
    "text": "Further information\n\n\n\n\n\n\nThe recommended tool in this course is R (with the IDE R-Studio). You can download R here and R-Studio here. There are tons of tutorials, videos and introductions to R and R-Studio online. You can find some initial hints from RStudio Education pages.\nInstead of installing R and RStudio on you own computer, see how to use R and RStudio remotely.\nWhen working with R, we recommend writing the report using quarto and the soon to be provided template. The remplate includes the formatting instructions and how to include code and figures.\nInstead of quarto, you can use other software to make the PDF report, but the the same instructions for formatting should be used..\nReport all results in a single, anonymous *.pdf -file and return it to peergrade.io.\nThe course has its own R package aaltobda with data and functionality to simplify coding. To install the package just run the following (upgrade=\"never\" skips question about updating other packages):\n\ninstall.packages(\"remotes\")\nremotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n\nMany of the exercises can be checked automatically using the R package\nmarkmyassignment. Information on how to install and use the package can be found here. There is no need to include markmyassignment results in the report.\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in peergrade. You can set email alerts for trhe deadlines in peergrade settings.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet. You can copy, e.g., plotting code from the course demos, but really try to solve the actual assignment problems with your own code and explanations. Do not share your answers publicly. Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year. All suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nDo not submit empty PDFs or almost empty PDFs as these are just harming the other students as they can’t do peergrading for the empty or almost empty submissions. Violations of this rule will be reported and investigated in the same way was plagiarism.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\nCan you open the PDF and it’s not blank?\n\nIs the report anonymous?"
  },
  {
    "objectID": "template4.html",
    "href": "template4.html",
    "title": "Assignment 4",
    "section": "",
    "text": "Reporting accuracy\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\n\n\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThis is the template for assignment 4. You can download the qmd-file or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\nThe following will set-up markmyassignment to check your functions at the end of the notebook:\n\nif(!require(markmyassignment)){\n    install.packages(\"markmyassignment\")\n    library(markmyassignment)\n}\n\nLoading required package: markmyassignment\n\nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/assignments/tests/assignment4.yml\", sep=\"\")\nset_assignment(assignment_path)    \n\nAssignment set:\nassignment4: Bayesian Data Analysis: Assignment 4\nThe assignment contain the following (4) tasks:\n- log_importance_weights\n- normalized_importance_weights\n- S_eff\n- posterior_mean\n\n\nThe following installs and loads the aaltobda package:\n\nif(!require(aaltobda)){\n    install.packages(\"remotes\")\n    remotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n    library(aaltobda)\n}\n\nLoading required package: aaltobda\n\n\nThe following installs and loads the latex2exp package, which allows us to use LaTeX in plots:\n\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n\nLoading required package: latex2exp"
  },
  {
    "objectID": "template4.html#a",
    "href": "template4.html#a",
    "title": "Assignment 4",
    "section": "2.1 (a)",
    "text": "2.1 (a)"
  },
  {
    "objectID": "template4.html#b",
    "href": "template4.html#b",
    "title": "Assignment 4",
    "section": "2.2 (b)",
    "text": "2.2 (b)\nLoading the library and the data.\n\n# Useful functions: quantile()\n# and mcse_quantile() (from aaltobda)\n\ndata(\"bioassay_posterior\")\n# The 4000 draws are now stored in the variable `bioassay_posterior`.\n# The below displays the first rows of the data:\nhead(bioassay_posterior)\n\n        alpha      beta\n1 -0.02050577 10.032841\n2  1.21738518  4.504546\n3  3.04829407 16.239424\n4  1.32272770  4.924268\n5  1.36274817 12.880561\n6  1.08593225  5.943731"
  },
  {
    "objectID": "template4.html#c",
    "href": "template4.html#c",
    "title": "Assignment 4",
    "section": "3.1 (c)",
    "text": "3.1 (c)\n\n# Useful functions: bioassaylp (from aaltobda)\nalpha_test = c(1.896, -3.6,  0.374, 0.964, -3.123, -1.581)\nbeta_test = c(24.76, 20.04, 6.15, 18.65, 8.16, 17.4)\n\n\nlog_importance_weights &lt;- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(-8.95, -23.47, -6.02, -8.13, -16.61, -14.57)\n}"
  },
  {
    "objectID": "template4.html#d",
    "href": "template4.html#d",
    "title": "Assignment 4",
    "section": "3.2 (d)",
    "text": "3.2 (d)\n\nnormalized_importance_weights &lt;- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.045, 0.000, 0.852, 0.103, 0.000, 0.000)\n}"
  },
  {
    "objectID": "template4.html#e",
    "href": "template4.html#e",
    "title": "Assignment 4",
    "section": "3.3 (e)",
    "text": "3.3 (e)\nWrite your answers and code here!"
  },
  {
    "objectID": "template4.html#f",
    "href": "template4.html#f",
    "title": "Assignment 4",
    "section": "3.4 (f)",
    "text": "3.4 (f)\n\nS_eff &lt;- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    1.354\n}"
  },
  {
    "objectID": "template4.html#g",
    "href": "template4.html#g",
    "title": "Assignment 4",
    "section": "3.5 (g)",
    "text": "3.5 (g)"
  },
  {
    "objectID": "template4.html#h",
    "href": "template4.html#h",
    "title": "Assignment 4",
    "section": "3.6 (h)",
    "text": "3.6 (h)\n\nposterior_mean &lt;- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.503, 8.275)\n}\n\n\n\n\n\n\n\nmarkmyassignment\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following will check the functions for which markmyassignment has been set up:\n\nmark_my_assignment()    \n\n✔ | F W S  OK | Context\n\n⠏ |         0 | task-1-subtask-1-tests                                          \n⠏ |         0 | log_importance_weights()                                        \n✖ | 2       3 | log_importance_weights()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:23'): log_importance_weights()\nlog_importance_weights(alpha, beta) not equivalent to c(...).\nLengths differ: 6 is not 10\nError: Incorrect result for alpha = c(4.5, 1.8, -2.4, 0.7, 0.3, -3.1, 0.4, 1.7, -0.5, -0.1) and beta = c(25.2, 7, -5.6, 1.1, 14.7, -6.5, 14.2, 25.9, 13.4, 19.8).\n\nFailure ('test-task-1-subtask-1-tests.R:31'): log_importance_weights()\nlog_importance_weights(alpha, beta) not equivalent to c(...).\nLengths differ: 6 is not 10\nError: Incorrect result for alpha = c(1.4, 1.5, -2.3, -2.3, -0.5, 1.9, 1.6, -1.8, -2.7, -1.9) and beta = c(11.4, 8.2, 10.8, 7.4, 18.2, 27.8, 5.1, 1.9, -15.7, 25.1).\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-2-subtask-1-tests                                          \n⠏ |         0 | normalized_importance_weights()                                 \n✖ | 2       3 | normalized_importance_weights()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-2-subtask-1-tests.R:23'): normalized_importance_weights()\nnormalized_importance_weights(alpha, beta) not equivalent to c(0.03, 0.44, 0, 0.01, 0.18, 0, 0.25, 0.04, 0.04, 0.01).\nLengths differ: 6 is not 10\nError: Incorrect result for alpha = c(4.5, 1.8, -2.4, 0.7, 0.3, -3.1, 0.4, 1.7, -0.5, -0.1) and beta = c(25.2, 7, -5.6, 1.1, 14.7, -6.5, 14.2, 25.9, 13.4, 19.8).\n\nFailure ('test-task-2-subtask-1-tests.R:31'): normalized_importance_weights()\nnormalized_importance_weights(alpha, beta) not equivalent to c(0.47, 0.42, 0, 0, 0, 0.01, 0.09, 0, 0, 0).\nLengths differ: 6 is not 10\nError: Incorrect result for alpha = c(1.4, 1.5, -2.3, -2.3, -0.5, 1.9, 1.6, -1.8, -2.7, -1.9) and beta = c(11.4, 8.2, 10.8, 7.4, 18.2, 27.8, 5.1, 1.9, -15.7, 25.1).\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-3-subtask-1-tests                                          \n⠏ |         0 | S_eff()                                                         \n✖ | 2       3 | S_eff()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-3-subtask-1-tests.R:23'): S_eff()\nS_eff(alpha, beta) not equivalent to 3.404.\n1/1 mismatches\n[1] 1.35 - 3.4 == -2.05\nError: Incorrect result for alpha = c(4.5, 1.8, -2.4, 0.7, 0.3, -3.1, 0.4, 1.7, -0.5, -0.1) and beta = c(25.2, 7, -5.6, 1.1, 14.7, -6.5, 14.2, 25.9, 13.4, 19.8).\n\nFailure ('test-task-3-subtask-1-tests.R:31'): S_eff()\nS_eff(alpha, beta) not equivalent to 2.448.\n1/1 mismatches\n[1] 1.35 - 2.45 == -1.09\nError: Incorrect result for alpha = c(1.4, 1.5, -2.3, -2.3, -0.5, 1.9, 1.6, -1.8, -2.7, -1.9) and beta = c(11.4, 8.2, 10.8, 7.4, 18.2, 27.8, 5.1, 1.9, -15.7, 25.1).\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-4-subtask-1-tests                                          \n⠏ |         0 | posterior_mean()                                                \n✖ | 2       3 | posterior_mean()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-4-subtask-1-tests.R:23'): posterior_mean()\nposterior_mean(alpha, beta) not equivalent to c(1.111039, 11.854793).\n2/2 mismatches (average diff: 2.09)\n[1] 0.503 -  1.11 == -0.608\n[2] 8.275 - 11.85 == -3.580\nError: Incorrect result for alpha = c(4.5, 1.8, -2.4, 0.7, 0.3, -3.1, 0.4, 1.7, -0.5, -0.1) and beta = c(25.2, 7, -5.6, 1.1, 14.7, -6.5, 14.2, 25.9, 13.4, 19.8).\n\nFailure ('test-task-4-subtask-1-tests.R:30'): posterior_mean()\nposterior_mean(alpha, beta) not equivalent to c(1.458649, 9.67896).\n2/2 mismatches (average diff: 1.18)\n[1] 0.503 - 1.46 == -0.956\n[2] 8.275 - 9.68 == -1.404\nError: Incorrect result for alpha = c(1.4, 1.5, -2.3, -2.3, -0.5, 1.9, 1.6, -1.8, -2.7, -1.9) and beta = c(11.4, 8.2, 10.8, 7.4, 18.2, 27.8, 5.1, 1.9, -15.7, 25.1).\n────────────────────────────────────────────────────────────────────────────────\n\n══ Results ═════════════════════════════════════════════════════════════════════\nDuration: 0.2 s\n\n[ FAIL 8 | WARN 0 | SKIP 0 | PASS 12 ]"
  },
  {
    "objectID": "assignment3.html",
    "href": "assignment3.html",
    "title": "Assignment 3",
    "section": "",
    "text": "1 General information\nThis assignment is related to Chapters 2 and 3. Use Frank Harrell’s recommendations on how to state results in Bayesian two group comparisons (and note that there is no point null hypothesis testing in this assignment).\nThe maximum amount of points from this assignment is 9.\nWe have prepared two quarto templates to help you get started:\n\nA recommended template which uses some additional packages, which however requires a bit more set-up work to run and\na simple template which doesn’t use those additional packages and is therefore easier to get to run.\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nReading instructions:\nChapter 2 and 3 in BDA3, see the reading instructions for Chapter 2 and the reading instructions for Chapter 3.\nGrading instructions:\nThe grading will be done in peergrade.\nAll grading questions and evaluations for this assignment are contained within this document in the collapsible Rubric blocks.\n\n\n\n\n\n\n\n\n\nFurther information\n\n\n\n\n\n\nThe recommended tool in this course is R (with the IDE R-Studio). You can download R here and R-Studio here. There are tons of tutorials, videos and introductions to R and R-Studio online. You can find some initial hints from RStudio Education pages.\nInstead of installing R and RStudio on you own computer, see how to use R and RStudio remotely.\nWhen working with R, we recommend writing the report using quarto and the soon to be provided template. The remplate includes the formatting instructions and how to include code and figures.\nInstead of quarto, you can use other software to make the PDF report, but the the same instructions for formatting should be used..\nReport all results in a single, anonymous *.pdf -file and return it to peergrade.io.\nThe course has its own R package aaltobda with data and functionality to simplify coding. To install the package just run the following (upgrade=\"never\" skips question about updating other packages):\n\ninstall.packages(\"remotes\")\nremotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n\nMany of the exercises can be checked automatically using the R package\nmarkmyassignment. Information on how to install and use the package can be found here. There is no need to include markmyassignment results in the report.\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in peergrade. You can set email alerts for trhe deadlines in peergrade settings.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet. You can copy, e.g., plotting code from the course demos, but really try to solve the actual assignment problems with your own code and explanations. Do not share your answers publicly. Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year. All suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nDo not submit empty PDFs or almost empty PDFs as these are just harming the other students as they can’t do peergrading for the empty or almost empty submissions. Violations of this rule will be reported and investigated in the same way was plagiarism.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\n\n\n\n\nRubric S1: General information - 7.5/100 points\n\n\n\n\n\n\nQ1: \nCan you open the PDF and it’s not blank?\n\nQ2: \nIs the report anonymous?\n\n\n\n\n\n\n2 Inference for normal mean and deviation (3 points)\nA factory has a production line for manufacturing car windshields. A sample of windshields has been taken for testing hardness. The observed hardness values \\(\\mathbf{y}_1\\) can be found in the dataset windshieldy1 in the aaltobda package.\nWe may assume that the observations follow a normal distribution with an unknown standard deviation \\(\\sigma\\). We wish to obtain information about the unknown average hardness \\(\\mu\\). For simplicity we assume standard uninformative prior discussed in the book, that is, \\(p(\\mu, \\sigma) \\propto \\sigma^{-1}\\). It is not necessary to derive the posterior distribution in the report, as it has already been done in the book (see section 3.2).\n\n\n\n\n\n\nSubtask 2.a)\n\n\n\n\n\nFormulate\n\nthe likelihood,\nthe prior, and\nthe resulting posterior.\n\n\n\n\n\n\n\n\n\n\nSubtask 2.b)\n\n\n\n\n\nWhat can you say about the unknown \\(\\mu\\)? Compute\n\nthe point estimate \\(E(\\mu|y)\\),\na posterior 95%-interval, and\nplot the density.\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nPosterior intervals are also called credible intervals and are different from confidence intervals.\n\n\n\n\n\n\n\n\n\nSubtask 2.c)\n\n\n\n\n\nWhat can you say about the hardness of the next windshield coming from the production line before actually measuring the hardness?\nCompute\n\nthe point estimate \\(E(\\tilde{y}|y)\\),\na posterior predictive 95%-interval, and\nplot the density.\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nPredictive intervals are different from posterior intervals.\nWith a conjugate prior a closed form posterior is Student’s \\(t\\) form (see equations in the book).\n\n\n\n\n\n\n\n\n\nRubric S2: Inference for normal mean and deviation (3 points)\n\n\n\n\n\n\nQ3: \nIs the source code included?\n\nNo\nYes\n\nQ4: \nAre the likelihood, prior and the posterior for computing the average hardness value reported? It is ok to refer to the book instead of deriving the distributions.\n\nNo\nYes, but some are missing\nYes\n\nQ5: \nIn part b), were the point estimates and posterior interval provided? (The posterior mean should be close to … and 95% posterior interval should be around …)\n\nNo\nYes, but seem incorrect or only one estimate was reported\nYes, and the reported values seem plausible\n\nQ6: \nIn part b), was the density plotted?\n\nNo\nYes, but seem incorrect\nYes, and the plot seems plausible\n\nQ7: \nFor c)-part, was a formula or a simulation method presented for computing the posterior predictive distribution? It is ok to refer to the book.\n\nNo\nYes, but seems incorrect\nYes\n\nQ8: \nFor c)-part, were the point estimate and predictive interval provided? (95% predictive interval should be around … and the mean the same as in a)-part).\n\nNo\nYes, but seems incorrect\nYes, and the reported values seem plausible\n\nQ9: \nFor c)-part, was the density plotted?\n\nNo\nYes, but seems incorrect\nYes, and the plot seem plausible\n\n\n\n\n\n\n\n3 Inference for the difference between proportions (3 points)\nAn experiment was performed to estimate the effect of beta-blockers on mortality of cardiac patients. A group of patients was randomly assigned to treatment and control groups: out of 674 patients receiving the control, 39 died, and out of 680 receiving the treatment, 22 died. Assume that the outcomes are independent and binomially distributed, with probabilities of death of \\(p_0\\) and \\(p_1\\) under the control and treatment, respectively. Set up a noninformative or weakly informative prior distribution on \\((p_0,p_1)\\).\n\n\n\n\n\n\nSubtask 3.a)\n\n\n\n\n\nFormulate\n\nthe likelihood,\nthe prior, and\nthe resulting posterior.\n\n\n\n\n\n\n\n\n\n\nSubtask 3.b)\n\n\n\n\n\nSummarize the posterior distribution for the odds ratio, \\[\n\\mathrm{OR} = (p_1/(1-p_1))/(p_0/(1-p_0)).\n\\] Compute\n\nthe point estimate \\(E(\\mathrm{OR}|y_0,y_1)\\),\na posterior 95%-interval, and\nplot the histogram.\n\nUse Frank Harrell’s recommendations how to state results in Bayesian two group comparison.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint\nWith a conjugate prior, a closed-form posterior is the Beta form for each group separately (see equations in the book). You can use rbeta() to sample from the posterior distributions of \\(p_0\\) and \\(p_1\\), and use these samples and odds ratio equation to get samples from the distribution of the odds ratio.\n\n\n\n\n\n\n\n\n\nSubtask 3.c)\n\n\n\n\n\nUse at least two different priors, and discuss the sensitivity of your inference to your choice of prior density with a couple of sentences.\n\n\n\n\n\n\n\n\n\nRubric S3: Inference for the difference between proportions (3 points)\n\n\n\n\n\n\nQ10: \nIs the source code included?\n\nNo\nYes\n\nQ11: \nAre the likelihood, prior and the posterior for the death probabilities reported? It is ok to refer to the book instead of deriving the distributions.\n\nNo\nYes, but some are missing\nYes\n\nQ12: \nIn part a), was the simulation algorithm for computing the posterior of the odds ratio presented or implemented?\n\nNo\nYes, but seems incorrect\nYes\n\nQ13: \nIn part a), was the odds ratio summarized with a point estimate and a posterior interval? (The mean should be close to … and 95% posterior interval approximately …)\n\nNo\nYes, but results seem incorrect\nYes, and the results seem plausible\n\nQ14: \nIn part b), was some discussion about testing alternative priors provided? (For example, one could have repeated the computations in a)-part which a couple of alternative priors and reported these results or some related general conclusions briefly)\n\nNot at all\nSome analysis was provided but it was lacking or did not make sense\nSome alternative priors were tested and some sensible discussion provided\n\n\n\n\n\n\n\n4 Inference for the difference between normal means (3 points)\nConsider a case where the same factory has two production lines for manufacturing car windshields. Independent samples from the two production lines were tested for hardness. The hardness measurements for the two samples \\(\\mathbf{y}_1\\) and \\(\\mathbf{y}_2\\) be found in the datasets windshieldy1 and windshieldy2 in the aaltobda package.\nWe assume that the samples have unknown standard deviations \\(\\sigma_1\\) and \\(\\sigma_2\\). Use uninformative or weakly informative priors and answer the following questions:\n\n\n\n\n\n\nSubtask 4.a)\n\n\n\n\n\nFormulate\n\nthe likelihood,\nthe prior, and\nthe resulting posterior.\n\n\n\n\n\n\n\n\n\n\nSubtask 4.b)\n\n\n\n\n\nWhat can you say about \\(\\mu_d = \\mu_1 - \\mu_2\\)? Compute\n\nthe point estimate \\(E(\\mu_d|y_1, y_2)\\),\na posterior 95%-interval, and\nplot the histogram.\n\nUse Frank Harrell’s recommendations how to state results in Bayesian two group comparison.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint\nWith a conjugate prior, a closed-form posterior is Student’s \\(t\\) form for each group separately (see equations in the book). You can use the rtnew() function to sample from the posterior distributions of \\(\\mu_1\\) and \\(\\mu_2\\), and use these samples to get samples from the distribution of the difference \\(\\mu_d = \\mu_1 - \\mu_2\\).\n\n\n\n\n\n\n\n\n\nSubtask 4.c)\n\n\n\n\n\nGiven this specific model, what is the probability that the means are exactly the same (\\(\\mu_1 = \\mu_2\\))? Explain your reasoning.\n\n\n\n\n\n\n\n\n\nRubric S4: Inference for the difference between normal means (3 points)\n\n\n\n\n\n\nQ15: \nIs source code included?\n\nNo\nYes\n\nQ16: \nAre the likelihood, prior and the posterior for the windshield hardness values reported? (It is also ok to refer to the book or related formulas from exercise 1)\n\nNo\nYes, but some are missing\nYes\n\nQ17: \nIn part a), was the simulation algorithm for computing the difference in the means presented or implemented?\n\nNo\nYes, but seems to be incorrect\nYes\n\nQ18: \nIn part a), was the posterior for the difference between the means summarized with point and interval estimates? (The mean should be close to … and 95% posterior interval … or something close to it)\n\nNo answer\nYes, but results seem incorrect or only one estimate was given\nYes, and results seem reasonable\n\nQ19: \nWere some analysis or discussion provided for assessing whether the means could be the same? …\n\nNo analysis or explanation is given\nYes, but the analysis or explanation seems incorrect\nYes, and the analysis or explanation seems plausible\n\n\n\n\n\n\n\n5 Overall quality of the report\n\n\n\n\n\n\nRubric S5: Overall quality of the report - 7.5/100 points\n\n\n\n\n\n\nQ20: \nDoes the report follow the formatting instructions?\n\nNot at all\nLittle\nMostly\nYes\n\nQ21: \nIn case the report doesn’t fully follow the formatting instructions, specify the formatting instruction that is not followed. If applicable, specify the page of the report, where this difference in formatting is visible.\nQ22: \nPlease provide also feedback on the presentation (e.g. text, layout, flow of the responses, figures, figure captions). Part of the course is practicing making data analysis reports. By providing feedback on the report presentation and other students can learn what they can improve or what they already did well. You should be able to provide constructive or positive feedback for all non-empty reports, even if there is nothing to say about the technical correctness of the answers. You can also provide feedback on code."
  },
  {
    "objectID": "simple_template5.html",
    "href": "simple_template5.html",
    "title": "Assignment 5",
    "section": "",
    "text": "Reporting accuracy\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\nSee lecture video 4.1, the chapter notes, and a case study for more information.\n\n\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThis is the template for assignment 5. You can download the qmd-file or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\nThe following will set-up markmyassignment to check your functions at the end of the notebook:\n\nif(!require(markmyassignment)){\n    install.packages(\"markmyassignment\")\n    library(markmyassignment)\n}\n\nLoading required package: markmyassignment\n\nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/assignments/tests/assignment5.yml\", sep=\"\")\nset_assignment(assignment_path)    \n\nAssignment set:\nassignment5: Bayesian Data Analysis: Assignment 5\nThe assignment contain the following task:\n- density_ratio\n\n\nThe following installs and loads the aaltobda package:\n\nif(!require(aaltobda)){\n    install.packages(\"remotes\")\n    remotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n    library(aaltobda)\n}\n\nLoading required package: aaltobda\n\n\nThe following installs and loads the latex2exp package, which allows us to use LaTeX in plots:\n\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n\nLoading required package: latex2exp\n\n\nThe following installs and loads the posterior package which imports the rhat_basic() function:\n\nif(!require(posterior)){\n    install.packages(\"posterior\")\n    library(posterior)\n}\n\nLoading required package: posterior\n\n\nThis is posterior version 1.4.0\n\n\n\nAttaching package: 'posterior'\n\n\nThe following object is masked from 'package:aaltobda':\n\n    mcse_quantile\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\n\nThe following installs and loads the ggplot2 package and the bayesplot package\n\nif(!require(ggplot2)){\n    install.packages(\"ggplot2\")\n    library(ggplot2)\n}\n\nLoading required package: ggplot2\n\nif(!require(bayesplot)){\n    install.packages(\"bayesplot\")\n    library(bayesplot)\n}\n\nLoading required package: bayesplot\n\n\nThis is bayesplot version 1.10.0\n\n\n- Online documentation and vignettes at mc-stan.org/bayesplot\n\n\n- bayesplot theme set to bayesplot::theme_default()\n\n\n   * Does _not_ affect other ggplot2 plots\n\n\n   * See ?bayesplot_theme_set for details on theme setting\n\n\n\nAttaching package: 'bayesplot'\n\n\nThe following object is masked from 'package:posterior':\n\n    rhat"
  },
  {
    "objectID": "simple_template5.html#a",
    "href": "simple_template5.html#a",
    "title": "Assignment 5",
    "section": "2.1 (a)",
    "text": "2.1 (a)\nWrite your answers/code here!\n\n# Useful functions: runif, rnorm\n# bioassaylp, dmvnorm (from aaltobda)\n\ndata(\"bioassay\")\n# Start by implementing a function called `density_ratio` to\n# compute the density ratio function, $r$ in Eq. (11.1) in BDA3:\ndensity_ratio &lt;- function(alpha_propose, alpha_previous, beta_propose, beta_previous, x, y, n){\n    # Do computation here, and return as below.\n    # Below are the correct return values for two different calls of this function:\n\n    # alpha_propose = 1.89, alpha_previous = 0.374,\n    # beta_propose = 24.76, beta_previous = 20.04,\n    # x = bioassay$x, y = bioassay$y, n = bioassay$n\n    1.305179\n\n    # alpha_propose = 0.374, alpha_previous = 1.89,\n    # beta_propose = 20.04, beta_previous = 24.76,\n    # x = bioassay$x, y = bioassay$y, n = bioassay$n\n    0.7661784\n    \n}\n# Then implement a function called `metropolis_bioassay()` which\n# implements the Metropolis algorithm using the `density_ratio()`:\nmetropolis_bioassay &lt;- function(alpha_initial, beta_initial, alpha_sigma, beta_sigma, no_draws, x, y, n){\n    # Do computation here, and return as below.\n    # Below are \"wrong\" values (unlikely to actually occur) \n    # in the \"correct\" format (such that they work with the plotting functions further down).\n    data.frame(\n        alpha=c(alpha_initial, alpha_initial+alpha_sigma, alpha_initial-alpha_sigma), \n        beta=c(beta_initial, beta_initial+beta_sigma, beta_initial-beta_sigma)\n    )\n    \n}\ndf = metropolis_bioassay(0, 0, 1, 1, 1000, bioassay$x, bioassay$y, bioassay$n)"
  },
  {
    "objectID": "simple_template5.html#b",
    "href": "simple_template5.html#b",
    "title": "Assignment 5",
    "section": "2.2 (b)",
    "text": "2.2 (b)\nWrite your answers/code here!\nHave a look at bayesplot trace plot examples and tune your plot if wanted/needed. Don’t forget to include a title/caption/description.\nThe below example plot only includes a single chain, but your report should include a plot with multiple chains overlayed!\n\n# Useful functions: mcmc_trace (from bayesplot)\nmcmc_trace(df, pars=c(\"alpha\", \"beta\"))"
  },
  {
    "objectID": "simple_template5.html#c",
    "href": "simple_template5.html#c",
    "title": "Assignment 5",
    "section": "2.3 (c)",
    "text": "2.3 (c)\nWrite your answers/code here!\n\n# Useful functions: rhat_basic (from posterior)"
  },
  {
    "objectID": "simple_template5.html#c-1",
    "href": "simple_template5.html#c-1",
    "title": "Assignment 5",
    "section": "2.4 (c)",
    "text": "2.4 (c)\nWrite your answers/code here!\nHave a look at bayesplot scatter plot examples and tune your plot if wanted/needed. Don’t forget to include a title/caption/description.\n\n# Useful functions: mcmc_scatter (from bayesplot)\nmcmc_scatter(df, pars=c(\"alpha\", \"beta\"))\n\n\n\n\n\n\n\n\n\n\nmarkmyassignment\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following will check the functions for which markmyassignment has been set up:\n\nmark_my_assignment()    \n\n✔ | F W S  OK | Context\n\n⠏ |         0 | task-1-subtask-1-tests                                          \n⠏ |         0 | density_ratio()                                                 \n✖ | 3       3 | density_ratio()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:14'): density_ratio()\ndensity_ratio(...) not equivalent to 1.305179.\n1/1 mismatches\n[1] 0.766 - 1.31 == -0.539\nError: Incorrect result for alpha_propose = 1.89, alpha_previous = 0.374, beta_propose = 24.76 and beta_previous = 20.04.\n\nFailure ('test-task-1-subtask-1-tests.R:26'): density_ratio()\ndensity_ratio(...) not equivalent to 1.\n1/1 mismatches\n[1] 0.766 - 1 == -0.234\nError: Incorrect result for alpha_propose = 1, alpha_previous = 1, beta_propose = 20 and beta_previous = 20.\n\nFailure ('test-task-1-subtask-1-tests.R:32'): density_ratio()\ndensity_ratio(...) not equivalent to 0.09510128.\n1/1 mismatches\n[1] 0.766 - 0.0951 == 0.671\nError: Incorrect result for alpha_propose = 0, alpha_previous = 1, beta_propose = 20 and beta_previous = 20.\n────────────────────────────────────────────────────────────────────────────────\n\n══ Results ═════════════════════════════════════════════════════════════════════\n[ FAIL 3 | WARN 0 | SKIP 0 | PASS 3 ]"
  },
  {
    "objectID": "assignment5.html",
    "href": "assignment5.html",
    "title": "Assignment 5",
    "section": "",
    "text": "1 General information\nThis assignment is related to Chapters 10 and 11.\nThe maximum amount of points from this assignment is 6.\nWe have prepared a quarto template to help you get started.\nWe recommend you use the docker container.\n\n\n\n\n\n\nTip\n\n\n\n\n\nReading instructions:\nChapter 10 and 11 in BDA3, see the reading instructions for Chapter 10 and the reading instructions for Chapter 11.\nGrading instructions:\nThe grading will be done in peergrade.\nAll grading questions and evaluations for this assignment are contained within this document in the collapsible Rubric blocks.\n\n\n\n\n\n\n\n\n\nReporting accuracy\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\nSee lecture video 4.1, the chapter notes, and a case study for more information.\n\n\n\n\n\n\n\n\nFurther information\n\n\n\n\n\n\nThe recommended tool in this course is R (with the IDE R-Studio). You can download R here and R-Studio here. There are tons of tutorials, videos and introductions to R and R-Studio online. You can find some initial hints from RStudio Education pages.\nInstead of installing R and RStudio on you own computer, see how to use R and RStudio remotely.\nWhen working with R, we recommend writing the report using quarto and the soon to be provided template. The remplate includes the formatting instructions and how to include code and figures.\nInstead of quarto, you can use other software to make the PDF report, but the the same instructions for formatting should be used..\nReport all results in a single, anonymous *.pdf -file and return it to peergrade.io.\nThe course has its own R package aaltobda with data and functionality to simplify coding. To install the package just run the following (upgrade=\"never\" skips question about updating other packages):\n\ninstall.packages(\"remotes\")\nremotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n\nMany of the exercises can be checked automatically using the R package\nmarkmyassignment. Information on how to install and use the package can be found here. There is no need to include markmyassignment results in the report.\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in peergrade. You can set email alerts for trhe deadlines in peergrade settings.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet. You can copy, e.g., plotting code from the course demos, but really try to solve the actual assignment problems with your own code and explanations. Do not share your answers publicly. Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year. All suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nDo not submit empty PDFs or almost empty PDFs as these are just harming the other students as they can’t do peergrading for the empty or almost empty submissions. Violations of this rule will be reported and investigated in the same way was plagiarism.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\n\n\n\n\nRubric S1: General information - 7.5/100 points\n\n\n\n\n\n\nQ1: \nCan you open the PDF and it’s not blank?\n\nQ2: \nIs the report anonymous?\n\n\n\n\n\n\n2 Generalized linear model: Bioassay model with Metropolis\nMetropolis algorithm: Replicate the computations for the bioassay example of section 3.7 in BDA3 using the Metropolis algorithm. The Metropolis algorithm is described in BDA3 Chapter 11.2. More information on the bioassay data can be found in Section 3.7 in BDA3, and in Chapter 3 notes.\n\n\n\n\n\n\nSubtask 2.a)\n\n\n\n\n\nImplement the Metropolis algorithm as an R function for the bioassay data. Use the Gaussian prior as in Assignment 4, that is \\[\n\\begin{aligned}\n    \\begin{bmatrix}\n    \\alpha \\\\ \\beta\n    \\end{bmatrix}\n    \\sim\n    \\text{N} \\left( \\mu_0,  \\Sigma_0 \\right), \\qquad\n    \\text{where} \\quad\n     \\mu_0 = \\begin{bmatrix} 0 \\\\ 10 \\end{bmatrix} \\quad \\text{and} \\quad\n     \\Sigma_0 = \\begin{bmatrix} 2^2 & 12 \\\\ 12 & 10^2 \\end{bmatrix}.\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nCompute with log-densities. Reasons are explained on page 261 of BDA3 and lecture video 4.1. Remember that \\(p_1/p_0=\\exp(\\log(p_1)-\\log(p_0))\\). For your convenience we have provided functions that will evaluate the log-likelihood for given \\(\\alpha\\) and \\(\\beta\\) (see bioassaylp() in the aaltobda package). Notice that you still need to add the prior yourself and remember the unnormalized log posterior is simply the sum of log-likelihood and log-prior. For evaluating the log of the Gaussian prior you can use the function dmvnorm from package aaltobda.\nUse a simple (normal) proposal distribution. Example proposals are \\(\\alpha^* \\sim N(\\alpha_{t-1}, \\sigma = 1)\\) and \\(\\beta^* \\sim N(\\beta_{t-1}, \\sigma = 5)\\). There is no need to try to find optimal proposal but test some different values for the jump scale (\\(\\sigma\\)). Remember to report the one you used. Efficient proposals are dicussed in BDA3 p. 295–297 (not part of the course). In real-life a pre-run could be made with an automatic adaptive control to adapt the proposal distribution.\n\n\n\n\n\n\n\n\n\nSubtask 2.b)\n\n\n\n\n\nInclude in the report the following:\n\nDescribe in your own words in one paragraph the basic idea of the Metropolis algorithm (see BDA3 Section 11.2, and lecture video 5.1).\nThe proposal distribution (related to jumping rule) you used. Describe briefly in words how you chose the final proposal distribution you used for the reported results.\nThe initial points of your Metropolis chains (or the explicit mechanism for generating them).\nReport the chain length or the number of iterations for each chain. Run the simulations long enough for approximate convergence (see BDA Section 11.4, and lecture 5.2).\nReport the warm-up length (see BDA Section 11.4, and lecture 5.2).\nThe number of Metropolis chains used. It is important that multiple Metropolis chains are run for evaluating convergence (see BDA Section 11.4, and lecture 5.2).\nPlot all chains for \\(\\alpha\\) in a single line-plot. Overlapping the chains in this way helps in visually assessing whether chains have converged or not.\nDo the same for \\(\\beta\\).\n\n\n\n\n\n\n\n\n\n\nSubtask 2.c)\n\n\n\n\n\nIn complex scenarios, visual assessment is not sufficient and \\(\\widehat{R}\\) is a more robust indicator of convergence of the Markov chains. Use \\(\\widehat{R}\\) for convergence analysis. You can either use Eq. (11.4) in BDA3 or the more recent version described in a recent article. You should specify which \\(\\widehat{R}\\) you used. In R the best choice is to use function rhat_basic() from the package posterior. Remember to remove the warm-up samples before computing \\(\\widehat{R}\\). Report the \\(\\widehat{R}\\) values for \\(\\alpha\\) and \\(\\beta\\) separately. Report the values for the proposal distribution you finally used.\n\n) Describe briefly in your own words the basic idea of \\(\\widehat{R}\\) and how to to interpret the obtained \\(\\widehat{R}\\) values.\n) Tell whether you obtained good \\(\\widehat{R}\\) with first try, or whether you needed to run more iterations or how did you modify the proposal distribution.\n\n\n\n\n\n\n\n\n\n\nSubtask 2.c)\n\n\n\n\n\nPlot the draws for \\(\\alpha\\) and \\(\\beta\\) (scatter plot) and include this plot in your report. You can compare the results to Figure 3.3b in BDA3 to verify that your code gives sensible results. Notice though that the results in Figure 3.3b are generated from posterior with a uniform prior, so even when if your algorithm works perfectly, the results will look slightly different (although fairly similar).\n\n\n\n\n\n\n\n\n\nRubric S2: Generalized linear model: Bioassay model with Metropolis\n\n\n\n\n\n\nQ3: \nIs the implementation of density_ratio function included ?\n\nNo\nYes\n\nQ4: \nIs the implementation of metropolis_bioassay function included ?\n\nNo\nYes\n\nQ5: \n2 a) Is the brief description of Metropolis-Hastings algorithm included (and it’s not complete nonsense)? Provide also a brief comment on how clear you think that description is (and potentially mention errors if you see them).\n\nNo\nYes\n\nQ6: \n2 b) Is the proposal/jumping distribution reported?\n\nNo\nYes\n\nQ7: \n2 c) Are the starting points or the mechanism how they are generated reported?\n\nNo\nYes\n\nQ8: \n2 d) Is the number of draws per chain reported?\n\nNo\nYes\n\nQ9: \n2 e) Is the warm-up length reported?\n\nNo\nYes\n\nQ10: \n2 f) Is the number of chains reported?\n\nNo\nYes\n\nQ11: \n2 g) and 2 h) Are line plots of the chains included? (Separate plots for alpha and beta)\n\nNo plots are included\nYes, but both plots are in a single figure, or the plots are scatter plots (scatter plots aren’t useful for visual convergence evaluation).\nYes, but only a plot for alpha or beta is included.\nYes, separate line plots for both alpha and beta are included.\n\nQ12: \nIs there a discussion on the convergence of the chains?\n\nNo discussion on convergence.\nYes, but the discussion is not convincing.\nYes, discussed in the report.\n\nQ13: \nIs it mentioned which implementation of Rhat is used? Two possible ways to compute R-hat would be:\n\n…\n…\n\nIt is ok as long as it is mentioned (or evident from the code) which of the above is used.\n\nNo\nYes\n\nQ14: \nIs the brief description of Rhat included (and it’s not complete nonsense)? Provide also a brief comment on how clear you think that description is (and potentially mention errors if you see them).\n\nNo\nYes\n\nQ15: \nAre the Rhat-values for alpha and beta reported?\n\nNo\nYes, but incorrectly computed\nYes, but computed separately for each chain\nYes, but only for alpha or beta\nYes, single values both for alpha and beta\n\nQ16: \nIs the interpretation of R-hat values correct (…)?\n\nNo interpretation or discussion about the R-hat values, or conclusions clearly wrong\nInterpretation somewhat correct\nInterpretation correct\n\nQ17: \nDoes the report contain a scatter plot about the draws? Do the results look reasonable, that is, roughly like in the Figure below …?\n\nNo plot included\nPlot included, but the results do not look like in the figure above\nPlot included, and the results look roughly like in the figure above\n\n\n\n\n\n\n\n3 Overall quality of the report\n\n\n\n\n\n\nRubric S3: Overall quality of the report - 7.5/100 points\n\n\n\n\n\n\nQ18: \nDoes the report follow the formatting instructions?\n\nNot at all\nLittle\nMostly\nYes\n\nQ19: \nIn case the report doesn’t fully follow the formatting instructions, specify the formatting instruction that is not followed. If applicable, specify the page of the report, where this difference in formatting is visible.\nQ20: \nPlease provide also feedback on the presentation (e.g. text, layout, flow of the responses, figures, figure captions). Part of the course is practicing making data analysis reports. By providing feedback on the report presentation and other students can learn what they can improve or what they already did well. You should be able to provide constructive or positive feedback for all non-empty reports, even if there is nothing to say about the technical correctness of the answers. You can also provide feedback on code."
  },
  {
    "objectID": "cmdstanr.html",
    "href": "cmdstanr.html",
    "title": "Bayesian Data Analysis",
    "section": "",
    "text": "Installing and using CmdStanR:\nSee the Stan demos on how to use Stan in R (or Python). jupyter.cs.aalto.fi has working R and CmdStanR/RStan environment and is probably the easiest way to use Stan. The Aalto Ubuntu desktops also have the necessary libraries installed. To install Stan on your laptop, run ‘install.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")))’ in R. If you encounter problems, see additional answers in FAQ. If you don’t succeed in short amount of time, it is probably easier to use jupyter.cs.aalto.fi.\nIf you use jupyter.cs.aalto.fi, all necessary packages have been pre-installed. In your laptop, install package cmdstanr. Installation instructions on Linux, Mac and Windows can be found at https://mc-stan.org/cmdstanr/. Additional useful packages are loo, bayesplot and posterior (but you don’t need these in this assignment). For Python users, PyStan, CmdStanPy, and ArviZ packages are useful.\nStan manual can be found at https://mc-stan.org/users/documentation/. From this website, you can also find a lot of other useful material about Stan.\nIf you edit files ending .stan in RStudio, you can click “Check” in the editor toolbar to make syntax check. This can significantly speed-up writing a working Stan model."
  },
  {
    "objectID": "template3.html",
    "href": "template3.html",
    "title": "Assignment 3",
    "section": "",
    "text": "Setup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThis is the template for assignment 3. You can download the qmd-files (full, simple) or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\nThe following will set-up markmyassignment to check your functions at the end of the notebook:\n\nif(!require(markmyassignment)){\n    install.packages(\"markmyassignment\")\n    library(markmyassignment)\n}\n\nLoading required package: markmyassignment\n\nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/assignments/tests/assignment3.yml\", sep=\"\")\nset_assignment(assignment_path)    \n\nAssignment set:\nassignment3: Bayesian Data Analysis: Assignment 3\nThe assignment contain the following (6) tasks:\n- mu_point_est\n- mu_interval\n- mu_pred_interval\n- mu_pred_point_est\n- posterior_odds_ratio_point_est\n- posterior_odds_ratio_interval\n\n\nThe following installs and loads the aaltobda package:\n\nif(!require(aaltobda)){\n    install.packages(\"remotes\")\n    remotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n    library(aaltobda)\n}\n\nLoading required package: aaltobda\n\n\nThe following installs and loads the latex2exp package, which allows us to use LaTeX in plots:\n\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n\nLoading required package: latex2exp\n\n\n\n\n\n\n\n\n\n\n\nShowcase: Setting up advanced packages (posterior and ggdist)\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThis block showcases advanced tools, which you will be allowed and expected to use after this assignment. For now, you should solve the assignment without the tools showcased herein.\nThe following installs and loads the posterior package, which allows us to use its rvar Random Variable Datatype:\n\nif(!require(posterior)){\n    install.packages(\"posterior\")\n    library(posterior)\n}\n\nLoading required package: posterior\n\n\nThis is posterior version 1.4.0\n\n\n\nAttaching package: 'posterior'\n\n\nThe following object is masked from 'package:aaltobda':\n\n    mcse_quantile\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\n\nThe following installs and loads the ggdist package for advanced plotting functions:\n\nif(!require(ggplot2)){\n    install.packages(\"ggplot2\")\n    library(ggplot2)\n}\n\nLoading required package: ggplot2\n\nggplot2::theme_set(theme_minimal(base_size = 14))\nif(!require(ggdist)){\n    install.packages(\"ggdist\")\n    library(ggdist)\n}\n\nLoading required package: ggdist\n\n\nThis block showcases advanced tools, which you will be allowed and expected to use after this assignment. For now, you should solve the assignment without the tools showcased herein."
  },
  {
    "objectID": "template3.html#a",
    "href": "template3.html#a",
    "title": "Assignment 3",
    "section": "2.1 (a)",
    "text": "2.1 (a)\nWrite your answers here!"
  },
  {
    "objectID": "template3.html#b",
    "href": "template3.html#b",
    "title": "Assignment 3",
    "section": "2.2 (b)",
    "text": "2.2 (b)\nWrite your answers and code here!\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful functions: mean(), length(), sqrt(), sum()\n# and qtnew(), dtnew() (from aaltobda)\n\nmu_point_est &lt;- function(data) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    14.5\n    \n}\nmu_interval &lt;- function(data, prob = 0.95) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(13.3, 15.7)\n    \n}\n\nYou can plot the density as below if you implement mu_pdf to compute the PDF of the posterior \\(p(\\mu|y)\\) of the average hardness \\(\\mu\\).\n\nmu_pdf &lt;- function(data, x){\n    # Compute necessary parameters here.\n    # These are the correct parameters for `windshieldy_test` \n    # with the provided uninformative prior.\n    df = 3\n    location = 14.5\n    scale = 0.3817557\n    # Use the computed parameters as below to compute the PDF:\n     \n    dtnew(x, df, location, scale)\n}\n\nx_interval = mu_interval(windshieldy1, .999)\nlower_x = x_interval[1]\nupper_x = x_interval[2]\nx = seq(lower_x, upper_x, length.out=1000)\nplot(\n    x, mu_pdf(windshieldy1, x), type=\"l\", \n    xlab=TeX(r'(average hardness $\\mu$)'), \n    ylab=TeX(r'(PDF of the posterior $p(\\mu|y)$)')\n)\n\n\n\n\nFigure 1: PDF of the posterior \\(p(\\mu|y)\\) of the average hardness \\(\\mu\\)"
  },
  {
    "objectID": "template3.html#c",
    "href": "template3.html#c",
    "title": "Assignment 3",
    "section": "2.3 (c)",
    "text": "2.3 (c)\nWrite your answers and code here!\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful functions: mean(), length(), sqrt(), sum()\n# and qtnew(), dtnew() (from aaltobda)\n\nmu_pred_point_est &lt;- function(data) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    14.5\n    \n}\nmu_pred_interval &lt;- function(data, prob = 0.95) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(11.8, 17.2)\n    \n}\n\nYou can plot the density as below if you implement mu_pred_pdf to compute the PDF of the posterior predictive \\(p(\\tilde{y}|y)\\) of a new hardness observation \\(\\tilde{y}\\).\n\nmu_pred_pdf &lt;- function(data, x){\n    # Compute necessary parameters here.\n    # These are the correct parameters for `windshieldy_test` \n    # with the provided uninformative prior.\n    df = 3\n    location = 14.5\n    scale = 0.8536316\n    # Use the computed parameters as below to compute the PDF:\n     \n    dtnew(x, df, location, scale)\n}\n\nx_interval = mu_pred_interval(windshieldy1, .999)\nlower_x = x_interval[1]\nupper_x = x_interval[2]\nx = seq(lower_x, upper_x, length.out=1000)\nplot(\n    x, mu_pred_pdf(windshieldy1, x), type=\"l\", \n    xlab=TeX(r'(new hardness observation $\\tilde{y}$)'), \n    ylab=TeX(r'(PDF of the posterior predictive $p(\\tilde{y}|y)$)')\n)\n\n\n\n\nFigure 2: PDF of the posterior predictive \\(p(\\tilde{y}|y)\\) of a new hardness observation \\(\\tilde{y}\\)"
  },
  {
    "objectID": "template3.html#a-1",
    "href": "template3.html#a-1",
    "title": "Assignment 3",
    "section": "3.1 (a)",
    "text": "3.1 (a)\nWrite your answers here!"
  },
  {
    "objectID": "template3.html#b-1",
    "href": "template3.html#b-1",
    "title": "Assignment 3",
    "section": "3.2 (b)",
    "text": "3.2 (b)\nWrite your answers and code here!\nThe below data is only for the tests:\n\nset.seed(4711)\nno_samples = 1000\np0 = rbeta(no_samples, 5, 95)\np1 = rbeta(no_samples, 10, 90)\n\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful function: mean(), quantile()\n\nposterior_odds_ratio_point_est &lt;- function(p0, p1) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    2.650172\n    \n}\nposterior_odds_ratio_interval &lt;- function(p0, p1, prob = 0.95) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.6796942,7.3015964)\n    \n}\n\n\n\n\n\n\n\nShowcase: advanced tools (posterior’s rvar, ggdist’s stat_dotsinterval)\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThis block showcases advanced tools, which you will be allowed and expected to use after this assignment. For now, you should solve the assignment without the tools showcased herein.\nThe posterior package’s random variable datatype rvar is a “sample-based representation of random variables” which makes handling of random samples such as the ones contained in the above variables p0 and p1 easier. By default, it prints as the mean and standard deviation of the samples, such that rvar(p0) prints as 0.05 ± 0.021 and rvar(p1) prints as 0.1 ± 0.029.\nThe datatype is “designed to […] be able to be used inside data.frame()s and tibble()s, and to be used with distribution visualizations in the ggdist package.” The code below sets up an R data.frame() with the samples in p0 and p1 wrapped in an rvar, and uses that data frame to visualize the samples using ggdist, an R package building on ggplot2 and “designed for both frequentist and Bayesian uncertainty visualization”.\nThe below plot, Figure 3 uses ggdist’s stat_dotsinterval(), which by default visualizes\n\nan rvar’s median and central 66% and 95% intervals using a black dot and lines of varying thicknesses as when using ggdist’s stat_pointinterval() and\nan rvar’s samples using grey dots as when using ggdist’s stat_dots():\n\n\nr0 = rvar(p0)\nr1 = rvar(p1)\nggplot(data.frame(\n    rv_name=c(\"control\", \"treatment\"), rv=c(r0, r1)\n)) +\n    aes(xdist=rv, y=rv_name) + \n    labs(x=\"probabilities of death\", y=\"patient group\") + \n    stat_dotsinterval()\n\n\n\n\nFigure 3: Probabilities of death for the two patient groups.\n\n\n\n\nrvars make it easy to compute functions of random variables, such as\n\ndifferences, e.g. \\(p_0 - p_1\\): r0 - r1 computes an rvar which prints as -0.05 ± 0.037, indicating the sample mean and the sample standard deviation of the difference of the probabilities of death,\nproducts, e.g. \\(p_0 \\, p_1\\): r0 * r1 computes an rvar which prints as 0.005 ± 0.0026 which in this case has no great interpretation, or\nthe odds ratios needed in task 3.b).\n\nBelow, in Figure 4, we compute the odds ratios using the rvars and visualize its median, central intervals and samples, as above in Figure 3:\n\nrodds_ratio = (r1/(1-r1))/(r0/(1-r0))\nggplot(data.frame(\n    rv=c(rodds_ratio)\n)) +\n    aes(xdist=rv) + \n    labs(x=\"odds ratio\", y=\"relative amount of samples\") + \n    stat_dotsinterval()\n\n\n\n\nFigure 4: Odds ratios of the two patient groups.\n\n\n\n\nYou can use Figure 4 to visually check whether the answers you computed for 3.b) make sense.\nThis block showcases advanced tools, which you will be allowed and expected to use after this assignment. For now, you should solve the assignment without the tools showcased herein."
  },
  {
    "objectID": "template3.html#c-1",
    "href": "template3.html#c-1",
    "title": "Assignment 3",
    "section": "3.3 (c)",
    "text": "3.3 (c)\nWrite your answers and code here!"
  },
  {
    "objectID": "template3.html#a-2",
    "href": "template3.html#a-2",
    "title": "Assignment 3",
    "section": "4.1 (a)",
    "text": "4.1 (a)\nWrite your answers here!"
  },
  {
    "objectID": "template3.html#b-2",
    "href": "template3.html#b-2",
    "title": "Assignment 3",
    "section": "4.2 (b)",
    "text": "4.2 (b)\nWrite your answers and code here!\n\n# Useful functions: mean(), length(), sqrt(), sum(),\n# rtnew() (from aaltobda), quantile() and hist()."
  },
  {
    "objectID": "template3.html#c-2",
    "href": "template3.html#c-2",
    "title": "Assignment 3",
    "section": "4.3 (c)",
    "text": "4.3 (c)\nWrite your answers here!\n\n\n\n\n\n\nmarkmyassignment\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following will check the functions for which markmyassignment has been set up:\n\nmark_my_assignment()    \n\n✔ | F W S  OK | Context\n\n⠏ |         0 | task-1-subtask-1-tests                                          \n⠏ |         0 | mu_point_est()                                                  \n✖ | 1       3 | mu_point_est()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:17'): mu_point_est()\nmu_point_est(data = 1:10) not equivalent to 5.5.\n1/1 mismatches\n[1] 14.5 - 5.5 == 9\nError: Incorrect result for vector 1:10\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-2-subtask-1-tests                                          \n⠏ |         0 | mu_interval()                                                   \n✖ | 2       3 | mu_interval()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-2-subtask-1-tests.R:15'): mu_interval()\nmu_interval(data = 1:10, prob = 0.95) not equivalent to c(3.3, 7.7).\n2/2 mismatches (average diff: 9)\n[1] 13.3 - 3.3 == 10\n[2] 15.7 - 7.7 ==  8\nError: Incorrect result for 1:10 using a 95% interval.\n\nFailure ('test-task-2-subtask-1-tests.R:16'): mu_interval()\nmu_interval(data = 1:10, prob = 0.8) not equivalent to c(4.2, 6.8).\n2/2 mismatches (average diff: 9)\n[1] 13.3 - 4.2 == 9.1\n[2] 15.7 - 6.8 == 8.9\nError: Incorrect result for 1:10 using a 80% interval.\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-3-subtask-1-tests                                          \n⠏ |         0 | mu_pred_interval()                                              \n✖ | 2       3 | mu_pred_interval()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-3-subtask-1-tests.R:16'): mu_pred_interval()\nmu_pred_interval(1:10, 0.95) not equivalent to c(-1.7, 12.7).\n2/2 mismatches (average diff: 9)\n[1] 11.8 - -1.7 == 13.5\n[2] 17.2 - 12.7 ==  4.5\nError: Incorrect result for 1:10, (95%)\n\nFailure ('test-task-3-subtask-1-tests.R:18'): mu_pred_interval()\nmu_pred_interval(1:10, 0.8) not equivalent to c(1.1, 9.9).\n2/2 mismatches (average diff: 9)\n[1] 11.8 - 1.1 == 10.7\n[2] 17.2 - 9.9 ==  7.3\nError: Incorrect result for 1:10, (80%)\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-4-subtask-1-tests                                          \n⠏ |         0 | mu_pred_point_est()                                             \n✖ | 1       3 | mu_pred_point_est()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-4-subtask-1-tests.R:16'): mu_pred_point_est()\nmu_pred_point_est(data = 1:10) not equivalent to 5.5.\n1/1 mismatches\n[1] 14.5 - 5.5 == 9\nError: Incorrect result for vector 1:10\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-5-subtask-1-tests                                          \n⠏ |         0 | posterior_odds_ratio_point_est()                                \n✖ | 3       3 | posterior_odds_ratio_point_est()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-5-subtask-1-tests.R:18'): posterior_odds_ratio_point_est()\nposterior_odds_ratio_point_est(p1, p0) not equivalent to 0.5307909.\n1/1 mismatches\n[1] 2.65 - 0.531 == 2.12\nError: Incorrect result for p1 = rbeta(100000, 5, 95), p0 = rbeta(100000, 10, 90).\n\nFailure ('test-task-5-subtask-1-tests.R:24'): posterior_odds_ratio_point_est()\nposterior_odds_ratio_point_est(p0, p1) not equivalent to 1.876519.\n1/1 mismatches\n[1] 2.65 - 1.88 == 0.774\nError: Incorrect result for p0 = rbeta(100000, 5, 5), p1 = rbeta(100000, 5, 6).\n\nFailure ('test-task-5-subtask-1-tests.R:25'): posterior_odds_ratio_point_est()\nposterior_odds_ratio_point_est(p1, p0) not equivalent to 1.24902.\n1/1 mismatches\n[1] 2.65 - 1.25 == 1.4\nError: Incorrect result for p0 = rbeta(100000, 5, 6), p1 = rbeta(100000, 5, 5).\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-6-subtask-1-tests                                          \n⠏ |         0 | posterior_odds_ratio_interval()                                 \n✖ | 6       2 | posterior_odds_ratio_interval()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-6-subtask-1-tests.R:17'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p0, p1, 0.9) not equivalent to c(0.875367, 6.05911).\n2/2 mismatches (average diff: 0.719)\n[1] 0.68 - 0.875 == -0.196\n[2] 7.30 - 6.059 ==  1.242\nError: Incorrect result for p0 = rbeta(100000, 5, 95), p1 = rbeta(100000, 10, 90) and 90%.\n\nFailure ('test-task-6-subtask-1-tests.R:19'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p1, p0, 0.9) not equivalent to c(0.1650407, 1.142378).\n2/2 mismatches (average diff: 3.34)\n[1] 0.68 - 0.165 == 0.515\n[2] 7.30 - 1.142 == 6.159\nError: Incorrect result for p1 = rbeta(100000, 5, 95), p0 = rbeta(100000, 10, 90) and 90%.\n\nFailure ('test-task-6-subtask-1-tests.R:21'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p1, p0, 0.8) not equivalent to c(0.2086461, 0.9392956).\n2/2 mismatches (average diff: 3.42)\n[1] 0.68 - 0.209 == 0.471\n[2] 7.30 - 0.939 == 6.362\nError: Incorrect result for p1 = rbeta(100000, 5, 95), p0 = rbeta(100000, 10, 90) and 80%.\n\nFailure ('test-task-6-subtask-1-tests.R:27'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p0, p1, 0.9) not equivalent to c(0.2714472, 5.5970131).\n2/2 mismatches (average diff: 1.06)\n[1] 0.68 - 0.271 == 0.408\n[2] 7.30 - 5.597 == 1.705\nError: Incorrect result for p0 = rbeta(100000, 5, 5), p1 = rbeta(100000, 5, 6) and 90%.\n\nFailure ('test-task-6-subtask-1-tests.R:29'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p1, p0, 0.9) not equivalent to c(0.1786667, 3.6839583).\n2/2 mismatches (average diff: 2.06)\n[1] 0.68 - 0.179 == 0.501\n[2] 7.30 - 3.684 == 3.618\nError: Incorrect result for p0 = rbeta(100000, 5, 6), p1 = rbeta(100000, 5, 5) and 90%.\n\nFailure ('test-task-6-subtask-1-tests.R:31'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p1, p0, 0.8) not equivalent to c(0.252972, 2.633517).\n2/2 mismatches (average diff: 2.55)\n[1] 0.68 - 0.253 == 0.427\n[2] 7.30 - 2.634 == 4.668\nError: Incorrect result for p0 = rbeta(100000, 5, 6), p1 = rbeta(100000, 5, 5) and 80%.\n────────────────────────────────────────────────────────────────────────────────\nMaximum number of failures exceeded; quitting at end of file.\nℹ Increase this number with (e.g.) `testthat::set_max_fails(Inf)` \n\n══ Results ═════════════════════════════════════════════════════════════════════\nDuration: 0.3 s\n\n[ FAIL 15 | WARN 0 | SKIP 0 | PASS 17 ]\n══ Terminated early ════════════════════════════════════════════════════════════"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Assignments",
    "section": "",
    "text": "The course consists of 12 blocks from February to May 2023. The blocks don’t match exactly specific weeks. For example, it’s good start reading the material for the next block while making the assignment for one block. There are 9 assignments and a project work with presentation, and thus the assignments are not in one-to-one correspondence with the blocks. The schedule below lists the blocks and how they connect to the topics, book chapters and assignments.\n\n\nHere is an overview of the schedule. Scroll down the page to see detailed instructions for each block. Remember that blocks are overlapping so that when you are working on assignment for one block, you should start watching videos and reading text for the next block.\nNote: All assignment deadlines are on Monday 15:59 UTC+0\n\n\n\n\nBlock\nReadings\nLectures\nAssignment\n\nAssignment due date\n\n\n\n\n\n1. Introduction\nBDA3 Chapter 1\nComputational probabilistic modeling,  Introduction to uncertainty and modelling,  Introduction to the course contents\nAssignment 1 and Rubric questions\n\n26 February\n\n\n\n2. Basics of Bayesian inference\nBDA3 Chapter 1,  BDA3 Chapter 2\nLecture 2.1,  Lecture 2.2,  Optional:  Extra explanations 2,  Summary 2.1,  Summary 2.2\nAssignment 2 and Rubric questions\n\n6 March\n\n\n\n3. Multidimensional posterior\nBDA3 Chapter 3\nLecture 3\nAssignment 3 and Rubric questions\n\n13 March\n\n\n\n4. Monte Carlo\nBDA3 Chapter 10\nLecture 4.1,  Lecture 4.2\nAssignment 4 and Rubric questions\n\n20 March\n\n\n\n5. Markov chain Monte Carlo\nBDA3 Chapter 11\nLecture 5.1,  Lecture 5.2\nAssignment 5 and Rubric questions\n\n27 March\n\n\n\n6. Stan, HMC, PPL\nBDA3 Chapter 12 + extra material on Stan\nLecture 6.1, Lecture 6.2\nAssignment 6 and Rubric questions\n\n3 April\n\n\n\n7. Hierarchical models and exchangeability\nBDA3 Chapter 5\nLecture 7.1,  Lecture 7.2\nAssignment 7 and Rubric questions\n\n17 April\n\n\n\n8. Model checking & cross-validation\nBDA3 Chapter 6, BDA3 Chapter 7, Visualization in Bayesian workflow, Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC\nLecture 8.1,  Lecture 8.2\nStart project work\n\n\n\n\n\n9. Model comparison and selection\nBDA3 Chapter 7 (not 7.2 and 7.3),  Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC\nLecture 9.1,  Optional:  Lecture 9.2,  Lecture 9.3\nAssignment 8,  Rubric questions\n\n24 April\n\n\n\n10. Decision analysis\nBDA3 Chapter 9\nLecture 10.1\nAssignment 9,  Rubric questions\n\n8 May\n\n\n\n11. Normal approximation, frequency properties\nBDA3 Chapter 4\nLecture 11.1,  Lecture 11.2\n\n\n\n\n\n\n12. Extended topics\nOptional: BDA3 Chapter 8,  BDA3 Chapter 14-18,  BDA3 Chapter 21\nOptional:  Lecture 12.1,  Lecture 12.2\nProject work\n\n15 May\n\n\n\n13. Project feedback\n\n\nProject feedback\n\n22 May"
  },
  {
    "objectID": "simple_template3.html",
    "href": "simple_template3.html",
    "title": "Assignment 3",
    "section": "",
    "text": "Setup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThis is the template for assignment 3. You can download the qmd-files (full, simple) or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\nThe following will set-up markmyassignment to check your functions at the end of the notebook:\n\nif(!require(markmyassignment)){\n    install.packages(\"markmyassignment\")\n    library(markmyassignment)\n}\n\nLoading required package: markmyassignment\n\nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/assignments/tests/assignment3.yml\", sep=\"\")\nset_assignment(assignment_path)    \n\nAssignment set:\nassignment3: Bayesian Data Analysis: Assignment 3\nThe assignment contain the following (6) tasks:\n- mu_point_est\n- mu_interval\n- mu_pred_interval\n- mu_pred_point_est\n- posterior_odds_ratio_point_est\n- posterior_odds_ratio_interval\n\n\nThe following installs and loads the aaltobda package:\n\nif(!require(aaltobda)){\n    install.packages(\"remotes\")\n    remotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n    library(aaltobda)\n}\n\nLoading required package: aaltobda\n\n\nThe following installs and loads the latex2exp package, which allows us to use LaTeX in plots:\n\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n\nLoading required package: latex2exp"
  },
  {
    "objectID": "simple_template3.html#a",
    "href": "simple_template3.html#a",
    "title": "Assignment 3",
    "section": "2.1 (a)",
    "text": "2.1 (a)\nWrite your answers here!"
  },
  {
    "objectID": "simple_template3.html#b",
    "href": "simple_template3.html#b",
    "title": "Assignment 3",
    "section": "2.2 (b)",
    "text": "2.2 (b)\nWrite your answers and code here!\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful functions: mean(), length(), sqrt(), sum()\n# and qtnew(), dtnew() (from aaltobda)\n\nmu_point_est &lt;- function(data) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    14.5\n    \n}\nmu_interval &lt;- function(data, prob = 0.95) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(13.3, 15.7)\n    \n}\n\nYou can plot the density as below if you implement mu_pdf to compute the PDF of the posterior \\(p(\\mu|y)\\) of the average hardness \\(\\mu\\).\n\nmu_pdf &lt;- function(data, x){\n    # Compute necessary parameters here.\n    # These are the correct parameters for `windshieldy_test` \n    # with the provided uninformative prior.\n    df = 3\n    location = 14.5\n    scale = 0.3817557\n    # Use the computed parameters as below to compute the PDF:\n     \n    dtnew(x, df, location, scale)\n}\n\nx_interval = mu_interval(windshieldy1, .999)\nlower_x = x_interval[1]\nupper_x = x_interval[2]\nx = seq(lower_x, upper_x, length.out=1000)\nplot(\n    x, mu_pdf(windshieldy1, x), type=\"l\", \n    xlab=TeX(r'(average hardness $\\mu$)'), \n    ylab=TeX(r'(PDF of the posterior $p(\\mu|y)$)')\n)\n\n\n\n\nFigure 1: PDF of the posterior \\(p(\\mu|y)\\) of the average hardness \\(\\mu\\)"
  },
  {
    "objectID": "simple_template3.html#c",
    "href": "simple_template3.html#c",
    "title": "Assignment 3",
    "section": "2.3 (c)",
    "text": "2.3 (c)\nWrite your answers and code here!\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful functions: mean(), length(), sqrt(), sum()\n# and qtnew(), dtnew() (from aaltobda)\n\nmu_pred_point_est &lt;- function(data) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    14.5\n    \n}\nmu_pred_interval &lt;- function(data, prob = 0.95) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(11.8, 17.2)\n    \n}\n\nYou can plot the density as below if you implement mu_pred_pdf to compute the PDF of the posterior predictive \\(p(\\tilde{y}|y)\\) of a new hardness observation \\(\\tilde{y}\\).\n\nmu_pred_pdf &lt;- function(data, x){\n    # Compute necessary parameters here.\n    # These are the correct parameters for `windshieldy_test` \n    # with the provided uninformative prior.\n    df = 3\n    location = 14.5\n    scale = 0.8536316\n    # Use the computed parameters as below to compute the PDF:\n     \n    dtnew(x, df, location, scale)\n}\n\nx_interval = mu_pred_interval(windshieldy1, .999)\nlower_x = x_interval[1]\nupper_x = x_interval[2]\nx = seq(lower_x, upper_x, length.out=1000)\nplot(\n    x, mu_pred_pdf(windshieldy1, x), type=\"l\", \n    xlab=TeX(r'(new hardness observation $\\tilde{y}$)'), \n    ylab=TeX(r'(PDF of the posterior predictive $p(\\tilde{y}|y)$)')\n)\n\n\n\n\nFigure 2: PDF of the posterior predictive \\(p(\\tilde{y}|y)\\) of a new hardness observation \\(\\tilde{y}\\)"
  },
  {
    "objectID": "simple_template3.html#a-1",
    "href": "simple_template3.html#a-1",
    "title": "Assignment 3",
    "section": "3.1 (a)",
    "text": "3.1 (a)\nWrite your answers here!"
  },
  {
    "objectID": "simple_template3.html#b-1",
    "href": "simple_template3.html#b-1",
    "title": "Assignment 3",
    "section": "3.2 (b)",
    "text": "3.2 (b)\nWrite your answers and code here!\nThe below data is only for the tests:\n\nset.seed(4711)\nno_samples = 1000\np0 = rbeta(no_samples, 5, 95)\np1 = rbeta(no_samples, 10, 90)\n\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful function: mean(), quantile()\n\nposterior_odds_ratio_point_est &lt;- function(p0, p1) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    2.650172\n    \n}\nposterior_odds_ratio_interval &lt;- function(p0, p1, prob = 0.95) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.6796942,7.3015964)\n    \n}"
  },
  {
    "objectID": "simple_template3.html#c-1",
    "href": "simple_template3.html#c-1",
    "title": "Assignment 3",
    "section": "3.3 (c)",
    "text": "3.3 (c)\nWrite your answers and code here!"
  },
  {
    "objectID": "simple_template3.html#a-2",
    "href": "simple_template3.html#a-2",
    "title": "Assignment 3",
    "section": "4.1 (a)",
    "text": "4.1 (a)\nWrite your answers here!"
  },
  {
    "objectID": "simple_template3.html#b-2",
    "href": "simple_template3.html#b-2",
    "title": "Assignment 3",
    "section": "4.2 (b)",
    "text": "4.2 (b)\nWrite your answers and code here!\n\n# Useful functions: mean(), length(), sqrt(), sum(),\n# rtnew() (from aaltobda), quantile() and hist()."
  },
  {
    "objectID": "simple_template3.html#c-2",
    "href": "simple_template3.html#c-2",
    "title": "Assignment 3",
    "section": "4.3 (c)",
    "text": "4.3 (c)\nWrite your answers here!\n\n\n\n\n\n\nmarkmyassignment\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following will check the functions for which markmyassignment has been set up:\n\nmark_my_assignment()    \n\n✔ | F W S  OK | Context\n\n⠏ |         0 | task-1-subtask-1-tests                                          \n⠏ |         0 | mu_point_est()                                                  \n✖ | 1       3 | mu_point_est()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:17'): mu_point_est()\nmu_point_est(data = 1:10) not equivalent to 5.5.\n1/1 mismatches\n[1] 14.5 - 5.5 == 9\nError: Incorrect result for vector 1:10\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-2-subtask-1-tests                                          \n⠏ |         0 | mu_interval()                                                   \n✖ | 2       3 | mu_interval()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-2-subtask-1-tests.R:15'): mu_interval()\nmu_interval(data = 1:10, prob = 0.95) not equivalent to c(3.3, 7.7).\n2/2 mismatches (average diff: 9)\n[1] 13.3 - 3.3 == 10\n[2] 15.7 - 7.7 ==  8\nError: Incorrect result for 1:10 using a 95% interval.\n\nFailure ('test-task-2-subtask-1-tests.R:16'): mu_interval()\nmu_interval(data = 1:10, prob = 0.8) not equivalent to c(4.2, 6.8).\n2/2 mismatches (average diff: 9)\n[1] 13.3 - 4.2 == 9.1\n[2] 15.7 - 6.8 == 8.9\nError: Incorrect result for 1:10 using a 80% interval.\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-3-subtask-1-tests                                          \n⠏ |         0 | mu_pred_interval()                                              \n✖ | 2       3 | mu_pred_interval()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-3-subtask-1-tests.R:16'): mu_pred_interval()\nmu_pred_interval(1:10, 0.95) not equivalent to c(-1.7, 12.7).\n2/2 mismatches (average diff: 9)\n[1] 11.8 - -1.7 == 13.5\n[2] 17.2 - 12.7 ==  4.5\nError: Incorrect result for 1:10, (95%)\n\nFailure ('test-task-3-subtask-1-tests.R:18'): mu_pred_interval()\nmu_pred_interval(1:10, 0.8) not equivalent to c(1.1, 9.9).\n2/2 mismatches (average diff: 9)\n[1] 11.8 - 1.1 == 10.7\n[2] 17.2 - 9.9 ==  7.3\nError: Incorrect result for 1:10, (80%)\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-4-subtask-1-tests                                          \n⠏ |         0 | mu_pred_point_est()                                             \n✖ | 1       3 | mu_pred_point_est()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-4-subtask-1-tests.R:16'): mu_pred_point_est()\nmu_pred_point_est(data = 1:10) not equivalent to 5.5.\n1/1 mismatches\n[1] 14.5 - 5.5 == 9\nError: Incorrect result for vector 1:10\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-5-subtask-1-tests                                          \n⠏ |         0 | posterior_odds_ratio_point_est()                                \n✖ | 3       3 | posterior_odds_ratio_point_est()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-5-subtask-1-tests.R:18'): posterior_odds_ratio_point_est()\nposterior_odds_ratio_point_est(p1, p0) not equivalent to 0.5307909.\n1/1 mismatches\n[1] 2.65 - 0.531 == 2.12\nError: Incorrect result for p1 = rbeta(100000, 5, 95), p0 = rbeta(100000, 10, 90).\n\nFailure ('test-task-5-subtask-1-tests.R:24'): posterior_odds_ratio_point_est()\nposterior_odds_ratio_point_est(p0, p1) not equivalent to 1.876519.\n1/1 mismatches\n[1] 2.65 - 1.88 == 0.774\nError: Incorrect result for p0 = rbeta(100000, 5, 5), p1 = rbeta(100000, 5, 6).\n\nFailure ('test-task-5-subtask-1-tests.R:25'): posterior_odds_ratio_point_est()\nposterior_odds_ratio_point_est(p1, p0) not equivalent to 1.24902.\n1/1 mismatches\n[1] 2.65 - 1.25 == 1.4\nError: Incorrect result for p0 = rbeta(100000, 5, 6), p1 = rbeta(100000, 5, 5).\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-6-subtask-1-tests                                          \n⠏ |         0 | posterior_odds_ratio_interval()                                 \n✖ | 6       2 | posterior_odds_ratio_interval()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-6-subtask-1-tests.R:17'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p0, p1, 0.9) not equivalent to c(0.875367, 6.05911).\n2/2 mismatches (average diff: 0.719)\n[1] 0.68 - 0.875 == -0.196\n[2] 7.30 - 6.059 ==  1.242\nError: Incorrect result for p0 = rbeta(100000, 5, 95), p1 = rbeta(100000, 10, 90) and 90%.\n\nFailure ('test-task-6-subtask-1-tests.R:19'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p1, p0, 0.9) not equivalent to c(0.1650407, 1.142378).\n2/2 mismatches (average diff: 3.34)\n[1] 0.68 - 0.165 == 0.515\n[2] 7.30 - 1.142 == 6.159\nError: Incorrect result for p1 = rbeta(100000, 5, 95), p0 = rbeta(100000, 10, 90) and 90%.\n\nFailure ('test-task-6-subtask-1-tests.R:21'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p1, p0, 0.8) not equivalent to c(0.2086461, 0.9392956).\n2/2 mismatches (average diff: 3.42)\n[1] 0.68 - 0.209 == 0.471\n[2] 7.30 - 0.939 == 6.362\nError: Incorrect result for p1 = rbeta(100000, 5, 95), p0 = rbeta(100000, 10, 90) and 80%.\n\nFailure ('test-task-6-subtask-1-tests.R:27'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p0, p1, 0.9) not equivalent to c(0.2714472, 5.5970131).\n2/2 mismatches (average diff: 1.06)\n[1] 0.68 - 0.271 == 0.408\n[2] 7.30 - 5.597 == 1.705\nError: Incorrect result for p0 = rbeta(100000, 5, 5), p1 = rbeta(100000, 5, 6) and 90%.\n\nFailure ('test-task-6-subtask-1-tests.R:29'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p1, p0, 0.9) not equivalent to c(0.1786667, 3.6839583).\n2/2 mismatches (average diff: 2.06)\n[1] 0.68 - 0.179 == 0.501\n[2] 7.30 - 3.684 == 3.618\nError: Incorrect result for p0 = rbeta(100000, 5, 6), p1 = rbeta(100000, 5, 5) and 90%.\n\nFailure ('test-task-6-subtask-1-tests.R:31'): posterior_odds_ratio_interval()\nposterior_odds_ratio_interval(p1, p0, 0.8) not equivalent to c(0.252972, 2.633517).\n2/2 mismatches (average diff: 2.55)\n[1] 0.68 - 0.253 == 0.427\n[2] 7.30 - 2.634 == 4.668\nError: Incorrect result for p0 = rbeta(100000, 5, 6), p1 = rbeta(100000, 5, 5) and 80%.\n────────────────────────────────────────────────────────────────────────────────\nMaximum number of failures exceeded; quitting at end of file.\nℹ Increase this number with (e.g.) `testthat::set_max_fails(Inf)` \n\n══ Results ═════════════════════════════════════════════════════════════════════\nDuration: 0.4 s\n\n[ FAIL 15 | WARN 0 | SKIP 0 | PASS 17 ]\n══ Terminated early ════════════════════════════════════════════════════════════"
  },
  {
    "objectID": "simple_template4.html",
    "href": "simple_template4.html",
    "title": "Assignment 4",
    "section": "",
    "text": "Reporting accuracy\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\n\n\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThis is the template for assignment 4. You can download the qmd-file or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\nThe following will set-up markmyassignment to check your functions at the end of the notebook:\n\nif(!require(markmyassignment)){\n    install.packages(\"markmyassignment\")\n    library(markmyassignment)\n}\n\nLoading required package: markmyassignment\n\nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/assignments/tests/assignment4.yml\", sep=\"\")\nset_assignment(assignment_path)    \n\nAssignment set:\nassignment4: Bayesian Data Analysis: Assignment 4\nThe assignment contain the following (4) tasks:\n- log_importance_weights\n- normalized_importance_weights\n- S_eff\n- posterior_mean\n\n\nThe following installs and loads the aaltobda package:\n\nif(!require(aaltobda)){\n    install.packages(\"remotes\")\n    remotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n    library(aaltobda)\n}\n\nLoading required package: aaltobda\n\n\nThe following installs and loads the latex2exp package, which allows us to use LaTeX in plots:\n\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n\nLoading required package: latex2exp"
  },
  {
    "objectID": "simple_template4.html#a",
    "href": "simple_template4.html#a",
    "title": "Assignment 4",
    "section": "2.1 (a)",
    "text": "2.1 (a)"
  },
  {
    "objectID": "simple_template4.html#b",
    "href": "simple_template4.html#b",
    "title": "Assignment 4",
    "section": "2.2 (b)",
    "text": "2.2 (b)\nLoading the library and the data.\n\n# Useful functions: quantile()\n# and mcse_quantile() (from aaltobda)\n\ndata(\"bioassay_posterior\")\n# The 4000 draws are now stored in the variable `bioassay_posterior`.\n# The below displays the first rows of the data:\nhead(bioassay_posterior)\n\n        alpha      beta\n1 -0.02050577 10.032841\n2  1.21738518  4.504546\n3  3.04829407 16.239424\n4  1.32272770  4.924268\n5  1.36274817 12.880561\n6  1.08593225  5.943731"
  },
  {
    "objectID": "simple_template4.html#c",
    "href": "simple_template4.html#c",
    "title": "Assignment 4",
    "section": "3.1 (c)",
    "text": "3.1 (c)\n\n# Useful functions: bioassaylp (from aaltobda)\nalpha_test = c(1.896, -3.6,  0.374, 0.964, -3.123, -1.581)\nbeta_test = c(24.76, 20.04, 6.15, 18.65, 8.16, 17.4)\n\n\nlog_importance_weights &lt;- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(-8.95, -23.47, -6.02, -8.13, -16.61, -14.57)\n}"
  },
  {
    "objectID": "simple_template4.html#d",
    "href": "simple_template4.html#d",
    "title": "Assignment 4",
    "section": "3.2 (d)",
    "text": "3.2 (d)\n\nnormalized_importance_weights &lt;- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.045, 0.000, 0.852, 0.103, 0.000, 0.000)\n}"
  },
  {
    "objectID": "simple_template4.html#e",
    "href": "simple_template4.html#e",
    "title": "Assignment 4",
    "section": "3.3 (e)",
    "text": "3.3 (e)\nWrite your answers and code here!"
  },
  {
    "objectID": "simple_template4.html#f",
    "href": "simple_template4.html#f",
    "title": "Assignment 4",
    "section": "3.4 (f)",
    "text": "3.4 (f)\n\nS_eff &lt;- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    1.354\n}"
  },
  {
    "objectID": "simple_template4.html#g",
    "href": "simple_template4.html#g",
    "title": "Assignment 4",
    "section": "3.5 (g)",
    "text": "3.5 (g)"
  },
  {
    "objectID": "simple_template4.html#h",
    "href": "simple_template4.html#h",
    "title": "Assignment 4",
    "section": "3.6 (h)",
    "text": "3.6 (h)\n\nposterior_mean &lt;- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.503, 8.275)\n}\n\n\n\n\n\n\n\nmarkmyassignment\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following will check the functions for which markmyassignment has been set up:\n\nmark_my_assignment()    \n\n✔ | F W S  OK | Context\n\n⠏ |         0 | task-1-subtask-1-tests                                          \n⠏ |         0 | log_importance_weights()                                        \n✖ | 2       3 | log_importance_weights()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:23'): log_importance_weights()\nlog_importance_weights(alpha, beta) not equivalent to c(...).\nLengths differ: 6 is not 10\nError: Incorrect result for alpha = c(4.5, 1.8, -2.4, 0.7, 0.3, -3.1, 0.4, 1.7, -0.5, -0.1) and beta = c(25.2, 7, -5.6, 1.1, 14.7, -6.5, 14.2, 25.9, 13.4, 19.8).\n\nFailure ('test-task-1-subtask-1-tests.R:31'): log_importance_weights()\nlog_importance_weights(alpha, beta) not equivalent to c(...).\nLengths differ: 6 is not 10\nError: Incorrect result for alpha = c(1.4, 1.5, -2.3, -2.3, -0.5, 1.9, 1.6, -1.8, -2.7, -1.9) and beta = c(11.4, 8.2, 10.8, 7.4, 18.2, 27.8, 5.1, 1.9, -15.7, 25.1).\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-2-subtask-1-tests                                          \n⠏ |         0 | normalized_importance_weights()                                 \n✖ | 2       3 | normalized_importance_weights()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-2-subtask-1-tests.R:23'): normalized_importance_weights()\nnormalized_importance_weights(alpha, beta) not equivalent to c(0.03, 0.44, 0, 0.01, 0.18, 0, 0.25, 0.04, 0.04, 0.01).\nLengths differ: 6 is not 10\nError: Incorrect result for alpha = c(4.5, 1.8, -2.4, 0.7, 0.3, -3.1, 0.4, 1.7, -0.5, -0.1) and beta = c(25.2, 7, -5.6, 1.1, 14.7, -6.5, 14.2, 25.9, 13.4, 19.8).\n\nFailure ('test-task-2-subtask-1-tests.R:31'): normalized_importance_weights()\nnormalized_importance_weights(alpha, beta) not equivalent to c(0.47, 0.42, 0, 0, 0, 0.01, 0.09, 0, 0, 0).\nLengths differ: 6 is not 10\nError: Incorrect result for alpha = c(1.4, 1.5, -2.3, -2.3, -0.5, 1.9, 1.6, -1.8, -2.7, -1.9) and beta = c(11.4, 8.2, 10.8, 7.4, 18.2, 27.8, 5.1, 1.9, -15.7, 25.1).\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-3-subtask-1-tests                                          \n⠏ |         0 | S_eff()                                                         \n✖ | 2       3 | S_eff()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-3-subtask-1-tests.R:23'): S_eff()\nS_eff(alpha, beta) not equivalent to 3.404.\n1/1 mismatches\n[1] 1.35 - 3.4 == -2.05\nError: Incorrect result for alpha = c(4.5, 1.8, -2.4, 0.7, 0.3, -3.1, 0.4, 1.7, -0.5, -0.1) and beta = c(25.2, 7, -5.6, 1.1, 14.7, -6.5, 14.2, 25.9, 13.4, 19.8).\n\nFailure ('test-task-3-subtask-1-tests.R:31'): S_eff()\nS_eff(alpha, beta) not equivalent to 2.448.\n1/1 mismatches\n[1] 1.35 - 2.45 == -1.09\nError: Incorrect result for alpha = c(1.4, 1.5, -2.3, -2.3, -0.5, 1.9, 1.6, -1.8, -2.7, -1.9) and beta = c(11.4, 8.2, 10.8, 7.4, 18.2, 27.8, 5.1, 1.9, -15.7, 25.1).\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-4-subtask-1-tests                                          \n⠏ |         0 | posterior_mean()                                                \n✖ | 2       3 | posterior_mean()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-4-subtask-1-tests.R:23'): posterior_mean()\nposterior_mean(alpha, beta) not equivalent to c(1.111039, 11.854793).\n2/2 mismatches (average diff: 2.09)\n[1] 0.503 -  1.11 == -0.608\n[2] 8.275 - 11.85 == -3.580\nError: Incorrect result for alpha = c(4.5, 1.8, -2.4, 0.7, 0.3, -3.1, 0.4, 1.7, -0.5, -0.1) and beta = c(25.2, 7, -5.6, 1.1, 14.7, -6.5, 14.2, 25.9, 13.4, 19.8).\n\nFailure ('test-task-4-subtask-1-tests.R:30'): posterior_mean()\nposterior_mean(alpha, beta) not equivalent to c(1.458649, 9.67896).\n2/2 mismatches (average diff: 1.18)\n[1] 0.503 - 1.46 == -0.956\n[2] 8.275 - 9.68 == -1.404\nError: Incorrect result for alpha = c(1.4, 1.5, -2.3, -2.3, -0.5, 1.9, 1.6, -1.8, -2.7, -1.9) and beta = c(11.4, 8.2, 10.8, 7.4, 18.2, 27.8, 5.1, 1.9, -15.7, 25.1).\n────────────────────────────────────────────────────────────────────────────────\n\n══ Results ═════════════════════════════════════════════════════════════════════\nDuration: 0.2 s\n\n[ FAIL 8 | WARN 0 | SKIP 0 | PASS 12 ]"
  },
  {
    "objectID": "quick_convergence.html",
    "href": "quick_convergence.html",
    "title": "Bayesian Data Analysis",
    "section": "",
    "text": "If your model is correctly implemented, sampling should have been succesful. You can check whether Stan thinks that sampling succeeded by inspecting the output of the below command, which you should be able to interpret with a little help from the CmdStan User’s Guide."
  },
  {
    "objectID": "assignment4.html",
    "href": "assignment4.html",
    "title": "Assignment 4",
    "section": "",
    "text": "1 General information\nThis assignment is related to Chapters 3 and 10.\nThe maximum amount of points from this assignment is 6.\nWe have prepared a quarto template to help you get started.\n\n\n\n\n\n\nTip\n\n\n\n\n\nReading instructions:\nChapters 3 and 10 in BDA3, see the reading instructions for Chapter 3 and the reading instructions for Chapter 10.\nGrading instructions:\nThe grading will be done in peergrade.\nAll grading questions and evaluations for this assignment are contained within this document in the collapsible Rubric blocks.\n\n\n\n\n\n\n\n\n\nReporting accuracy\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\n\n\n\n\n\n\n\n\nFurther information\n\n\n\n\n\n\nThe recommended tool in this course is R (with the IDE R-Studio). You can download R here and R-Studio here. There are tons of tutorials, videos and introductions to R and R-Studio online. You can find some initial hints from RStudio Education pages.\nInstead of installing R and RStudio on you own computer, see how to use R and RStudio remotely.\nWhen working with R, we recommend writing the report using quarto and the soon to be provided template. The remplate includes the formatting instructions and how to include code and figures.\nInstead of quarto, you can use other software to make the PDF report, but the the same instructions for formatting should be used..\nReport all results in a single, anonymous *.pdf -file and return it to peergrade.io.\nThe course has its own R package aaltobda with data and functionality to simplify coding. To install the package just run the following (upgrade=\"never\" skips question about updating other packages):\n\ninstall.packages(\"remotes\")\nremotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n\nMany of the exercises can be checked automatically using the R package\nmarkmyassignment. Information on how to install and use the package can be found here. There is no need to include markmyassignment results in the report.\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in peergrade. You can set email alerts for trhe deadlines in peergrade settings.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet. You can copy, e.g., plotting code from the course demos, but really try to solve the actual assignment problems with your own code and explanations. Do not share your answers publicly. Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year. All suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nDo not submit empty PDFs or almost empty PDFs as these are just harming the other students as they can’t do peergrading for the empty or almost empty submissions. Violations of this rule will be reported and investigated in the same way was plagiarism.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\n\n\n\n\nRubric S1: General information - 7.5/100 points\n\n\n\n\n\n\nQ1: \nCan you open the PDF and it’s not blank?\n\nQ2: \nIs the report anonymous?\n\n\n\n\n\n\n2 Bioassay model\nIn this exercise, you will use a dose-response relation model that is used in Section 3.7 of the course book and in the chapter reading instructions. The used likelihood is the same, but instead of uniform priors, we will use a bivariate normal distribution as the joint prior distribution of the parameters \\(\\alpha\\) and \\(\\beta\\).\nIn the prior distribution for \\((\\alpha,\\beta)\\), the marginal distributions are \\(\\alpha \\sim N(0,2^2)\\) and \\(\\beta \\sim N(10,10^2)\\), and the correlation between them is \\(\\mathrm{corr}(\\alpha, \\beta)=0.6\\).\n\n\n\n\n\n\nSubtask 2.a)\n\n\n\n\n\nReport the mean (vector of two values) and covariance (two by two matrix) of the bivariate normal distribution.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nThe mean and covariance of the bivariate normal distribution are a length–\\(2\\) vector and a \\(2 \\times 2\\) matrix. The elements of the covariance matrix can be computed using the relation of correlation and covariance.\n\n\n\nYou are given 4000 independent draws from the posterior distribution of the model in the dataset bioassay_posterior in the aaltobda package.\n\n\n\n\n\n\nSubtask 2.b)\n\n\n\n\n\nReport\n\nthe mean as well as\n5 \\(\\%\\) and 95 \\(\\%\\) quantiles separately\n\nfor both\n\n\\(\\alpha\\) and\n\\(\\beta\\).\n\nReport also the Monte Carlo standard errors (MCSEs) for the mean and quantile estimates and explain in words what does Monte Carlo standard error mean and how you decided the number of digits to show.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nNote:\nThe answer is graded as correct only if the number of digits reported is correct! The number of significant digits can be different for the mean and quantile estimates. In some other cases, the number of digits reported can be less than MCSE allows for practical reasons.\nHint:\nQuantiles can be computed with the quantile function. With \\(S\\) draws, the MCSE for \\(\\text{E}[\\theta]\\) is \\(\\sqrt{\\text{Var} [\\theta]/S}\\). MCSE for the quantile estimates can be computed with the mcse_quantile function from the aaltobda package.\n\n\n\n\n\n\n\n\n\nRubric S2: Bioassay model\n\n\n\n\n\n\nQ3: \nAre the mean and covariance of the prior in a) reported? The correct answers are …:\n\nNot reported\nYes, but they are not correct\nYes, and they are correct\n\nQ4: \nAre the means and their MCSEs of alpha and beta in b) reported? Note that the number of digits reported for the means must follow the rule given in the assignment. The correct answers are alpha: mean … and beta: mean ….\n\nNot reported\nYes, but one or both means are incorrect\nYes, and the means are correct\n\nQ5: \nAre the quantiles and their MCSEs of alpha and beta in b) reported? Note that the number of digits reported for the quantiles must follow the rule given in the assignment. The correct answers are alpha: 5% quantile …, 95% quantile … and beta: 5% quantile …, 95% quantile ….\n\nNot reported\nYes, but one or more quantiles are incorrect\nYes, and the quantiles are correct\n\n\n\n\n\n\n\n3 Importance sampling\nNow we discard our posterior draws and switch to importance sampling.\n\n\n\n\n\n\nSubtask 3.c)\n\n\n\n\n\nImplement a function for computing the log importance ratios (log importance weights) when the importance sampling target distribution is the posterior distribution, and the proposal distribution is the prior distribution from a). Explain in words why it’s better to compute log ratios instead of ratios.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nNon-log importance ratios are given by equation (10.3) in the course book. The fact that our proposal distribution is the same as the prior distribution makes this task easier. The logarithm of the likelihood can be computed with the bioassaylp function from the aaltobda package. The data required for the likelihood can be loaded with data(\"bioassay\").\n\n\n\n\n\n\n\n\n\nSubtask 3.d)\n\n\n\n\n\nImplement a function for computing normalized importance ratios from the unnormalized log ratios in c). In other words, exponentiate the log ratios and scale them such that they sum to one. Explain in words what is the effect of exponentiating and scaling so that sum is one.\n\n\n\n\n\n\n\n\n\nSubtask 3.e)\n\n\n\n\n\nSample 4000 draws of \\(\\alpha\\) and \\(\\beta\\) from the prior distribution from a). Compute and plot a histogram of the 4000 normalized importance ratios. Use the functions you implemented in c) and d).\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nUse the function rmvnorm from the aaltobda package for sampling.\n\n\n\n\n\n\n\n\n\nSubtask 3.f)\n\n\n\n\n\nUsing the importance ratios, compute the importance sampling effective sample size \\(S_{\\text{eff}}\\) and report it.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nEquation (10.4) in the course book.\nNote:\nBDA3 1st (2013) and 2nd (2014) printing have an error for \\(\\tilde{w}(\\theta^s)\\) used in the effective sample size equation (10.4). The normalized weights equation should not have the multiplier S (the normalized weights should sum to one). Errata for the book http://www.stat.columbia.edu/~gelman/book/errata_bda3.txt. The later printings, the online version, and the slides have the correct equation.\n\n\n\n\n\n\n\n\n\nSubtask 3.g)\n\n\n\n\n\nExplain in your own words what the importance sampling effective sample size represents. Also explain how the effective sample size is seen in the histogram of the weights that you plotted in e).\n\n\n\n\n\n\n\n\n\nSubtask 3.h)\n\n\n\n\n\nImplement a function for computing the posterior mean using importance sampling, and compute the mean using your 4000 draws. Explain in your own words the computation for importance sampling. Report the means for alpha and beta, and also the Monte Carlo standard errors (MCSEs) for the mean estimates. Report the number of digits for the means based on the MCSEs.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nNote:\nThe values below are only a test case, you need to use 4000 draws for alpha and beta in the final report.\nHint:\nUse the same equation for the MCSE of \\(\\text{E}[\\theta]\\) as earlier (\\(\\sqrt{\\text{Var} [\\theta]/S}\\)), but now replace \\(S\\) with \\(S_{\\text{eff}}\\). To compute \\(\\text{Var} [\\theta]\\) with importance sampling, use the identity \\(\\text{Var}[\\theta] = \\text{E}[\\theta^2] - \\text{E}[\\theta]^2\\).\n\n\n\n\n\n\n\n\n\nRubric S3: Importance sampling\n\n\n\n\n\n\nQ6: \nIs the source code for the function in c) reported?\n\nNo\nYes\n\nQ7: \nIs the source code for the function in d) reported?\n\nNo\nYes\n\nQ8: \nDoes the histogram in e) look something like this figure? If it is evident that the normalized importance ratios are computed correctly, but the prior was incorrect, you can still grade “Reported and looks similar”.\n\nNot reported\nReported, but looks different\nReported and looks similar\n\nQ9: \nIs the effective sample size in f) reported? The correct range for the effective sample size is between …. However, if it is evident that the effective sample size is computed correctly, but the prior was incorrect, you can still grade “Yes, and it is correct”.\n\nNo\nYes, but it is not correct\nYes, and it is correct\n\nQ10: \nThe correct explanation for g) is roughly the following: …\nQ11: \nWhat is the connection between S_eff and the histogram of weights: … How is the answer?\n\nTotally wrong/has not tried\nSomething is a bit wrong\nExplanation is sensible\n\nQ12: \nIs the source code for the function in h) reported?\n\nNo\nYes\n\nQ13: \nAre the means and their MCSEs of alpha and beta in h) reported? Note that the number of digits reported for the means must follow the rule given in the assignment. The correct answers should be close to these: alpha: mean … and beta: mean …\n\nNot reported\nYes, but they are incorrect\nYes, and they are correct\n\n\n\n\n\n\n\n4 Overall quality of the report\n\n\n\n\n\n\nRubric S4: Overall quality of the report - 7.5/100 points\n\n\n\n\n\n\nQ14: \nDoes the report follow the formatting instructions?\n\nNot at all\nLittle\nMostly\nYes\n\nQ15: \nIn case the report doesn’t fully follow the formatting instructions, specify the formatting instruction that is not followed. If applicable, specify the page of the report, where this difference in formatting is visible.\nQ16: \nPlease provide also feedback on the presentation (e.g. text, layout, flow of the responses, figures, figure captions). Part of the course is practicing making data analysis reports. By providing feedback on the report presentation and other students can learn what they can improve or what they already did well. You should be able to provide constructive or positive feedback for all non-empty reports, even if there is nothing to say about the technical correctness of the answers. You can also provide feedback on code."
  },
  {
    "objectID": "reporting_accuracy.html",
    "href": "reporting_accuracy.html",
    "title": "Bayesian Data Analysis",
    "section": "",
    "text": "Reporting accuracy\n\n\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\nSee lecture video 4.1, the chapter notes, and a case study for more information."
  },
  {
    "objectID": "template6.html",
    "href": "template6.html",
    "title": "Assignment 6",
    "section": "",
    "text": "Reporting accuracy\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\nSee lecture video 4.1, the chapter notes, and a case study for more information.\n\n\nThis is the template for assignment 6. You can download the broken stan-file and the qmd-file or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following installs and loads the aaltobda package:\n\nif(!require(aaltobda)){\n    install.packages(\"remotes\")\n    remotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n    library(aaltobda)\n}\n\nLoading required package: aaltobda\n\n\nThe following installs and loads the latex2exp package, which allows us to use LaTeX in plots:\n\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n\nLoading required package: latex2exp\n\n\nThe following installs and loads the posterior package which imports the rhat_basic() function:\n\nif(!require(posterior)){\n    install.packages(\"posterior\")\n    library(posterior)\n}\n\nLoading required package: posterior\n\n\nThis is posterior version 1.4.0\n\n\n\nAttaching package: 'posterior'\n\n\nThe following object is masked from 'package:aaltobda':\n\n    mcse_quantile\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\n\nThe following installs and loads the ggplot2 package, the bayesplot package and the dplyr package\n\nif(!require(ggplot2)){\n    install.packages(\"ggplot2\")\n    library(ggplot2)\n}\n\nLoading required package: ggplot2\n\nif(!require(bayesplot)){\n    install.packages(\"bayesplot\")\n    library(bayesplot)\n}\n\nLoading required package: bayesplot\n\n\nThis is bayesplot version 1.10.0\n\n\n- Online documentation and vignettes at mc-stan.org/bayesplot\n\n\n- bayesplot theme set to bayesplot::theme_default()\n\n\n   * Does _not_ affect other ggplot2 plots\n\n\n   * See ?bayesplot_theme_set for details on theme setting\n\n\n\nAttaching package: 'bayesplot'\n\n\nThe following object is masked from 'package:posterior':\n\n    rhat\n\nif(!require(dplyr)){\n    install.packages(\"dplyr\")\n    library(dplyr)\n}\n\nLoading required package: dplyr\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nif(!require(tidyr)){\n    install.packages(\"tidyr\")\n    library(tidyr)\n}\n\nLoading required package: tidyr\n\n# Some additional set-up to make plots legible\nggplot2::theme_set(theme_minimal(base_size = 14))\nbayesplot::bayesplot_theme_set(theme_minimal(base_size = 14))\n# register_knitr_engine()\n\nThe following installs and loads the cmdstanr package and tries to install cmdstan.\n\nif(!require(cmdstanr)){\n    install.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")))\n    library(cmdstanr)\n}\n\nLoading required package: cmdstanr\n\n\nThis is cmdstanr version 0.5.3\n\n\n- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr\n\n\n- CmdStan path: /home/niko/.cmdstan/cmdstan-2.31.0\n\n\n- CmdStan version: 2.31.0\n\ncmdstan_installed &lt;- function(){\n  res &lt;- try(out &lt;- cmdstanr::cmdstan_path(), silent = TRUE)\n  !inherits(res, \"try-error\")\n}\nif(!cmdstan_installed()){\n    install_cmdstan()\n}"
  },
  {
    "objectID": "template6.html#b",
    "href": "template6.html#b",
    "title": "Assignment 6",
    "section": "2.1 (b)",
    "text": "2.1 (b)\nWrite your answers/code here!\n\n\n\n\n\n\nModel fitting\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nData assembly happens here:\n\n# These are our observations y: the proportion of students handing in each assignment (1-8),\n# sorted by year (row-wise) and assignment (column-wise).\n# While the code suggest a matrix structure, \n# the result will actually be a vector of length N = no_years * no_assignments\npropstudents&lt;-c(c(176, 174, 158, 135, 138, 129, 126, 123)/176,\n                c(242, 212, 184, 177, 174, 172, 163, 156)/242,\n                c(332, 310, 278, 258, 243, 242, 226, 224)/332,\n                c(301, 269, 231, 232, 217, 208, 193, 191)/301,\n                c(245, 240, 228, 217, 206, 199, 191, 182)/245)\n# These are our predictors x: for each observation, the corresponding assignment number.\nassignment &lt;- rep(1:8, 5)\n# These are in some sense our test data: the proportion of students handing in the last assignment (9),\n# sorted by year. \n# Usually, we would not want to split our data like that and instead\n# use e.g. Leave-One-Out Cross-Validation (LOO-CV, see e.g. http://mc-stan.org/loo/index.html)\n# to evaluate model performance.\npropstudents9 = c(121/176, 153/242, 218/332, 190/301, 175/245)\n# The total number of assignments\nno_assignments = 9\n# The assignment numbers for which we want to generate predictions\nx_predictions = 1:no_assignments\n# (Cmd)Stan(R) expects the data to be passed in the below format:\nmodel_data = list(N=length(assignment),\n                 x=assignment,\n                 y=propstudents,\n                 no_predictions=no_assignments,\n                 x_predictions=x_predictions)\n\nModel fitting happens here:\n\n# This reads the file at the specified path and tries to compile it. \n# If it fails, an error is thrown.\nretention_model = cmdstan_model(\"./assignment6_linear_model.stan\")\n# This \"out &lt;- capture.output(...)\" construction suppresses output from cmdstanr\n# See also https://github.com/stan-dev/cmdstanr/issues/646\nout &lt;- capture.output(\n    # Sampling from the model happens here:\n    fit &lt;- retention_model$sample(data=model_data, refresh=0, show_messages=FALSE)\n)\n\nDraws postprocessing happens here:\n\n# This extracts the draws from the sampling result as a data.frame.\ndraws_df = fit$draws(format=\"draws_df\")\n\n# This does some data/draws wrangling to compute the 5, 50 and 95 percentiles of \n# the mean at the specified covariate values (x_predictions). \n# It can be instructive to play around with each of the data processing steps\n# to find out what each step does, e.g. by removing parts from the back like \"|&gt;  gather(pct,y,-x)\"\n# and printing the resulting data.frame.\nmu_quantiles_df = draws_df |&gt; \n      subset_draws(variable = c(\"mu_pred\")) |&gt; \n      summarise_draws(~quantile2(.x, probs = c(0.05, .5, 0.95))) |&gt; \n      mutate(x = 1:9) |&gt; \n      pivot_longer(c(q5, q50, q95), names_to = c(\"pct\"))\n# Same as above, but for the predictions.\ny_quantiles_df = draws_df |&gt; \n      subset_draws(variable = c(\"y_pred\")) |&gt; \n      summarise_draws(~quantile2(.x, probs = c(0.05, .5, 0.95))) |&gt; \n      mutate(x = 1:9) |&gt; \n      pivot_longer(c(q5, q50, q95), names_to = c(\"pct\"))\n\n\n\n\n\nPlotting happens here:\n\nggplot() +\n  # scatter plot of the training data:  \n  geom_point(\n    aes(x, y, color=assignment), \n    data=data.frame(x=assignment, y=propstudents, assignment=\"1-8\")\n) +\n  # scatter plot of the test data:\n  geom_point(\n    aes(x, y, color=assignment), \n    data=data.frame(x=no_assignments, y=propstudents9, assignment=\"9\")\n) +\n  # you have to tell us what this plots:\n  geom_line(aes(x,y=value,linetype=pct), data=mu_quantiles_df, color='grey', linewidth=1.5) +\n  # you have to tell us what this plots:\n  geom_line(aes(x,y=value,linetype=pct), data=y_quantiles_df, color='red') +\n  # adding xticks for each assignment:\n  scale_x_continuous(breaks=1:no_assignments) +\n  # adding labels to the plot:\n  labs(y=\"assignment submission %\", x=\"assignment number\") +\n  # specifying that line types repeat:\n  scale_linetype_manual(values=c(2,1,2)) +\n  # Specify colours of the observations:\n  scale_colour_manual(values = c(\"1-8\"=\"black\", \"9\"=\"blue\")) +\n  # remove the legend for the linetypes:\n  guides(linetype=\"none\")\n\n\n\n\nFigure 1: Describe me in your submission!\n\n\n\n\n\n\n\n\n\n\n\nQuick check for model convergence\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nIf your model is correctly implemented, sampling should have been succesful. You can check whether Stan thinks that sampling succeeded by inspecting the output of the below command, which you should be able to interpret with a little help from the CmdStan User’s Guide.\n\nfit$cmdstan_diagnose()\n\nProcessing csv files: /tmp/Rtmps5CuJR/assignment6_linear_model-202304062154-1-85f525.csv, /tmp/Rtmps5CuJR/assignment6_linear_model-202304062154-2-85f525.csv, /tmp/Rtmps5CuJR/assignment6_linear_model-202304062154-3-85f525.csv, /tmp/Rtmps5CuJR/assignment6_linear_model-202304062154-4-85f525.csv\n\nChecking sampler transitions treedepth.\nTreedepth satisfactory for all transitions.\n\nChecking sampler transitions for divergences.\nNo divergent transitions found.\n\nChecking E-BFMI - sampler transitions HMC potential energy.\nE-BFMI satisfactory.\n\nEffective sample size satisfactory.\n\nSplit R-hat values satisfactory all parameters.\n\nProcessing complete, no problems detected."
  },
  {
    "objectID": "template6.html#c",
    "href": "template6.html#c",
    "title": "Assignment 6",
    "section": "2.2 (c)",
    "text": "2.2 (c)\nWrite your answers/code here!"
  },
  {
    "objectID": "template6.html#d",
    "href": "template6.html#d",
    "title": "Assignment 6",
    "section": "3.1 (d)",
    "text": "3.1 (d)\nWrite your answers/code here!\n\ndata(\"bioassay\")"
  },
  {
    "objectID": "template6.html#e",
    "href": "template6.html#e",
    "title": "Assignment 6",
    "section": "3.2 (e)",
    "text": "3.2 (e)\nWrite your answers/code here!"
  },
  {
    "objectID": "template6.html#f",
    "href": "template6.html#f",
    "title": "Assignment 6",
    "section": "3.3 (f)",
    "text": "3.3 (f)\nWrite your answers/code here!"
  },
  {
    "objectID": "template6.html#g",
    "href": "template6.html#g",
    "title": "Assignment 6",
    "section": "3.4 (g)",
    "text": "3.4 (g)\nWrite your answers/code here!"
  },
  {
    "objectID": "template5.html",
    "href": "template5.html",
    "title": "Assignment 5",
    "section": "",
    "text": "Reporting accuracy\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\nSee lecture video 4.1, the chapter notes, and a case study for more information.\n\n\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThis is the template for assignment 5. You can download the qmd-file or copy the code from this rendered document after clicking on &lt;/&gt; Code in the top right corner.\nPlease replace the instructions in this template by your own text, explaining what you are doing in each exercise.\nThe following will set-up markmyassignment to check your functions at the end of the notebook:\n\nif(!require(markmyassignment)){\n    install.packages(\"markmyassignment\")\n    library(markmyassignment)\n}\n\nLoading required package: markmyassignment\n\nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/assignments/tests/assignment5.yml\", sep=\"\")\nset_assignment(assignment_path)    \n\nAssignment set:\nassignment5: Bayesian Data Analysis: Assignment 5\nThe assignment contain the following task:\n- density_ratio\n\n\nThe following installs and loads the aaltobda package:\n\nif(!require(aaltobda)){\n    install.packages(\"remotes\")\n    remotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n    library(aaltobda)\n}\n\nLoading required package: aaltobda\n\n\nThe following installs and loads the latex2exp package, which allows us to use LaTeX in plots:\n\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n\nLoading required package: latex2exp\n\n\nThe following installs and loads the posterior package which imports the rhat_basic() function:\n\nif(!require(posterior)){\n    install.packages(\"posterior\")\n    library(posterior)\n}\n\nLoading required package: posterior\n\n\nThis is posterior version 1.4.0\n\n\n\nAttaching package: 'posterior'\n\n\nThe following object is masked from 'package:aaltobda':\n\n    mcse_quantile\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\n\nThe following installs and loads the ggplot2 package and the bayesplot package\n\nif(!require(ggplot2)){\n    install.packages(\"ggplot2\")\n    library(ggplot2)\n}\n\nLoading required package: ggplot2\n\nif(!require(bayesplot)){\n    install.packages(\"bayesplot\")\n    library(bayesplot)\n}\n\nLoading required package: bayesplot\n\n\nThis is bayesplot version 1.10.0\n\n\n- Online documentation and vignettes at mc-stan.org/bayesplot\n\n\n- bayesplot theme set to bayesplot::theme_default()\n\n\n   * Does _not_ affect other ggplot2 plots\n\n\n   * See ?bayesplot_theme_set for details on theme setting\n\n\n\nAttaching package: 'bayesplot'\n\n\nThe following object is masked from 'package:posterior':\n\n    rhat"
  },
  {
    "objectID": "template5.html#a",
    "href": "template5.html#a",
    "title": "Assignment 5",
    "section": "2.1 (a)",
    "text": "2.1 (a)\nWrite your answers/code here!\n\n# Useful functions: runif, rnorm\n# bioassaylp, dmvnorm (from aaltobda)\n\ndata(\"bioassay\")\n# Start by implementing a function called `density_ratio` to\n# compute the density ratio function, $r$ in Eq. (11.1) in BDA3:\ndensity_ratio &lt;- function(alpha_propose, alpha_previous, beta_propose, beta_previous, x, y, n){\n    # Do computation here, and return as below.\n    # Below are the correct return values for two different calls of this function:\n\n    # alpha_propose = 1.89, alpha_previous = 0.374,\n    # beta_propose = 24.76, beta_previous = 20.04,\n    # x = bioassay$x, y = bioassay$y, n = bioassay$n\n    1.305179\n\n    # alpha_propose = 0.374, alpha_previous = 1.89,\n    # beta_propose = 20.04, beta_previous = 24.76,\n    # x = bioassay$x, y = bioassay$y, n = bioassay$n\n    0.7661784\n    \n}\n# Then implement a function called `metropolis_bioassay()` which\n# implements the Metropolis algorithm using the `density_ratio()`:\nmetropolis_bioassay &lt;- function(alpha_initial, beta_initial, alpha_sigma, beta_sigma, no_draws, x, y, n){\n    # Do computation here, and return as below.\n    # Below are \"wrong\" values (unlikely to actually occur) \n    # in the \"correct\" format (such that they work with the plotting functions further down).\n    data.frame(\n        alpha=c(alpha_initial, alpha_initial+alpha_sigma, alpha_initial-alpha_sigma), \n        beta=c(beta_initial, beta_initial+beta_sigma, beta_initial-beta_sigma)\n    )\n    \n}\ndf = metropolis_bioassay(0, 0, 1, 1, 1000, bioassay$x, bioassay$y, bioassay$n)"
  },
  {
    "objectID": "template5.html#b",
    "href": "template5.html#b",
    "title": "Assignment 5",
    "section": "2.2 (b)",
    "text": "2.2 (b)\nWrite your answers/code here!\nHave a look at bayesplot trace plot examples and tune your plot if wanted/needed. Don’t forget to include a title/caption/description.\nThe below example plot only includes a single chain, but your report should include a plot with multiple chains overlayed!\n\n# Useful functions: mcmc_trace (from bayesplot)\nmcmc_trace(df, pars=c(\"alpha\", \"beta\"))"
  },
  {
    "objectID": "template5.html#c",
    "href": "template5.html#c",
    "title": "Assignment 5",
    "section": "2.3 (c)",
    "text": "2.3 (c)\nWrite your answers/code here!\n\n# Useful functions: rhat_basic (from posterior)"
  },
  {
    "objectID": "template5.html#c-1",
    "href": "template5.html#c-1",
    "title": "Assignment 5",
    "section": "2.4 (c)",
    "text": "2.4 (c)\nWrite your answers/code here!\nHave a look at bayesplot scatter plot examples and tune your plot if wanted/needed. Don’t forget to include a title/caption/description.\n\n# Useful functions: mcmc_scatter (from bayesplot)\nmcmc_scatter(df, pars=c(\"alpha\", \"beta\"))\n\n\n\n\n\n\n\n\n\n\nmarkmyassignment\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following will check the functions for which markmyassignment has been set up:\n\nmark_my_assignment()    \n\n✔ | F W S  OK | Context\n\n⠏ |         0 | task-1-subtask-1-tests                                          \n⠏ |         0 | density_ratio()                                                 \n✖ | 3       3 | density_ratio()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:14'): density_ratio()\ndensity_ratio(...) not equivalent to 1.305179.\n1/1 mismatches\n[1] 0.766 - 1.31 == -0.539\nError: Incorrect result for alpha_propose = 1.89, alpha_previous = 0.374, beta_propose = 24.76 and beta_previous = 20.04.\n\nFailure ('test-task-1-subtask-1-tests.R:26'): density_ratio()\ndensity_ratio(...) not equivalent to 1.\n1/1 mismatches\n[1] 0.766 - 1 == -0.234\nError: Incorrect result for alpha_propose = 1, alpha_previous = 1, beta_propose = 20 and beta_previous = 20.\n\nFailure ('test-task-1-subtask-1-tests.R:32'): density_ratio()\ndensity_ratio(...) not equivalent to 0.09510128.\n1/1 mismatches\n[1] 0.766 - 0.0951 == 0.671\nError: Incorrect result for alpha_propose = 0, alpha_previous = 1, beta_propose = 20 and beta_previous = 20.\n────────────────────────────────────────────────────────────────────────────────\n\n══ Results ═════════════════════════════════════════════════════════════════════\n[ FAIL 3 | WARN 0 | SKIP 0 | PASS 3 ]"
  },
  {
    "objectID": "assignment6.html",
    "href": "assignment6.html",
    "title": "Assignment 6",
    "section": "",
    "text": "1 General information\nThe maximum amount of points from this assignment is 6.\nWe have prepared a quarto template to help you get started.\n\nWe recommend you use the docker container.\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nReading instructions:\nChapter 10 and 11 in BDA3, see the reading instructions for Chapter 10 and the reading instructions for Chapter 11.\nGrading instructions:\nThe grading will be done in peergrade. All grading questions and evaluations for this assignment are contained within this document in the collapsible Rubric blocks.\nInstalling and using CmdStanR:\nSee the Stan demos on how to use Stan in R (or Python). jupyter.cs.aalto.fi has working R and CmdStanR/RStan environment and is probably the easiest way to use Stan. The Aalto Ubuntu desktops also have the necessary libraries installed. To install Stan on your laptop, run ‘install.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")))’ in R. If you encounter problems, see additional answers in FAQ. If you don’t succeed in short amount of time, it is probably easier to use jupyter.cs.aalto.fi.\nIn your laptop, install package cmdstanr. Installation instructions on Linux, Mac and Windows can be found at https://mc-stan.org/cmdstanr/. Additional useful packages are loo, bayesplot and posterior (but you don’t need these in this assignment). For Python users, PyStan, CmdStanPy, and ArviZ packages are useful.\nStan manual can be found at https://mc-stan.org/users/documentation/. From this website, you can also find a lot of other useful material about Stan.\nIf you edit files ending .stan in RStudio, you can click “Check” in the editor toolbar to make syntax check. This can significantly speed-up writing a working Stan model.\n\n\n\n\n\n\n\n\n\nReporting accuracy\n\n\n\nFor posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.\nExample: If you estimate \\(E(\\mu)=1.234\\) with MCSE(\\(E(\\mu)\\)) = 0.01, you should report \\(E(\\mu)=1.2\\).\nSee lecture video 4.1, the chapter notes, and a case study for more information.\n\n\n\n\n\n\n\n\nFurther information\n\n\n\n\n\n\nThe recommended tool in this course is R (with the IDE R-Studio). You can download R here and R-Studio here. There are tons of tutorials, videos and introductions to R and R-Studio online. You can find some initial hints from RStudio Education pages.\nInstead of installing R and RStudio on you own computer, see how to use R and RStudio remotely.\nWhen working with R, we recommend writing the report using quarto and the soon to be provided template. The remplate includes the formatting instructions and how to include code and figures.\nInstead of quarto, you can use other software to make the PDF report, but the the same instructions for formatting should be used..\nReport all results in a single, anonymous *.pdf -file and return it to peergrade.io.\nThe course has its own R package aaltobda with data and functionality to simplify coding. To install the package just run the following (upgrade=\"never\" skips question about updating other packages):\n\ninstall.packages(\"remotes\")\nremotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n\nMany of the exercises can be checked automatically using the R package\nmarkmyassignment. Information on how to install and use the package can be found here. There is no need to include markmyassignment results in the report.\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in peergrade. You can set email alerts for trhe deadlines in peergrade settings.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet. You can copy, e.g., plotting code from the course demos, but really try to solve the actual assignment problems with your own code and explanations. Do not share your answers publicly. Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year. All suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nDo not submit empty PDFs or almost empty PDFs as these are just harming the other students as they can’t do peergrading for the empty or almost empty submissions. Violations of this rule will be reported and investigated in the same way was plagiarism.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\n\n\n\n\nRubric S1: General information - 7.5/100 points\n\n\n\n\n\n\nQ1: \nCan you open the PDF and it’s not blank?\n\nQ2: \nIs the report anonymous?\n\n\n\n\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThe following installs and loads the aaltobda package:\n\nif(!require(aaltobda)){\n    install.packages(\"remotes\")\n    remotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n    library(aaltobda)\n}\n\nLoading required package: aaltobda\n\n\nThe following installs and loads the latex2exp package, which allows us to use LaTeX in plots:\n\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n\nLoading required package: latex2exp\n\n\nThe following installs and loads the posterior package which imports the rhat_basic() function:\n\nif(!require(posterior)){\n    install.packages(\"posterior\")\n    library(posterior)\n}\n\nLoading required package: posterior\n\n\nThis is posterior version 1.4.0\n\n\n\nAttaching package: 'posterior'\n\n\nThe following object is masked from 'package:aaltobda':\n\n    mcse_quantile\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\n\nThe following installs and loads the ggplot2 package, the bayesplot package and the dplyr package\n\nif(!require(ggplot2)){\n    install.packages(\"ggplot2\")\n    library(ggplot2)\n}\n\nLoading required package: ggplot2\n\nif(!require(bayesplot)){\n    install.packages(\"bayesplot\")\n    library(bayesplot)\n}\n\nLoading required package: bayesplot\n\n\nThis is bayesplot version 1.10.0\n\n\n- Online documentation and vignettes at mc-stan.org/bayesplot\n\n\n- bayesplot theme set to bayesplot::theme_default()\n\n\n   * Does _not_ affect other ggplot2 plots\n\n\n   * See ?bayesplot_theme_set for details on theme setting\n\n\n\nAttaching package: 'bayesplot'\n\n\nThe following object is masked from 'package:posterior':\n\n    rhat\n\nif(!require(dplyr)){\n    install.packages(\"dplyr\")\n    library(dplyr)\n}\n\nLoading required package: dplyr\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nif(!require(tidyr)){\n    install.packages(\"tidyr\")\n    library(tidyr)\n}\n\nLoading required package: tidyr\n\n# Some additional set-up to make plots legible\nggplot2::theme_set(theme_minimal(base_size = 14))\nbayesplot::bayesplot_theme_set(theme_minimal(base_size = 14))\n# register_knitr_engine()\n\nThe following installs and loads the cmdstanr package and tries to install cmdstan.\n\nif(!require(cmdstanr)){\n    install.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")))\n    library(cmdstanr)\n}\n\nLoading required package: cmdstanr\n\n\nThis is cmdstanr version 0.5.3\n\n\n- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr\n\n\n- CmdStan path: /home/niko/.cmdstan/cmdstan-2.31.0\n\n\n- CmdStan version: 2.31.0\n\ncmdstan_installed &lt;- function(){\n  res &lt;- try(out &lt;- cmdstanr::cmdstan_path(), silent = TRUE)\n  !inherits(res, \"try-error\")\n}\nif(!cmdstan_installed()){\n    install_cmdstan()\n}\n\n\n\n\n\n\n2 Stan warm-up: linear model of BDA retention with Stan (2 points)\nFrom 2018 to 2022, we have been keeping track of assignment submissions for the BDA course given the number of submissions for the 1st assignment. We will fit a simple linear model to answer two questions of interest:\n\nWhat is the trend of student retention as measured by assignment submissions?\nGiven the submission rates for assignments 1-8, how many students will complete the final 9th assignment (and potentially pass the course)?\n\nThe author has given you the broken Stan code below, which they intend to encode the following linear model: \\[\n\\begin{aligned}\np(\\alpha,\\beta,\\sigma) &= \\mathrm{const.}\n      & \\text{(improper flat prior)}&\\text{ and}\\\\\np(y|x,\\alpha,\\beta,\\sigma) &= p_\\mathrm{normal}(y|\\alpha + \\beta x, \\sigma)\n      & \\text{(normal likelihood)} &\\text{.}\n\\end{aligned}\n\\] In both the statistical model above and in the Stan model below, \\(x \\in \\mathbb{R}^N\\) and \\(y \\in \\mathbb{R}^N\\) are vectors of the covariates / predictors (the assignment number) and vectors of the observation (proportions of students who have handed in the respective assignment). \\(\\alpha \\in \\mathbb{R}\\) is the unknown scalar intercept, \\(\\beta \\in \\mathbb{R}\\) is the unknown scalar slope and \\(\\sigma \\in \\mathbb{R}_{&gt;0}\\) is the unknown scalar observation standard deviation. The statistical model further implies \\[\np(y_\\mathrm{pred.}|x_\\mathrm{pred.},\\alpha,\\beta,\\sigma) = p_\\mathrm{normal}(y_\\mathrm{pred.}|\\alpha + \\beta x_\\mathrm{pred.}, \\sigma)\n\\] as the predictive distribution for a new observation \\(y_\\mathrm{pred.}\\) at a given new covariate value \\(x_\\mathrm{pred.}\\).\nYou can download the broken stan file from github.\n1data {\n    // number of data points\n    int&lt;lower=0&gt; N; \n    // covariate / predictor\n    vector[N] x; \n    // observations\n    vector[N] y; \n    // number of covariate values to make predictions at\n    int&lt;lower=0&gt; no_predictions;\n    // covariate values to make predictions at\n    vector[no_predictions] x_predictions; \n}\n2parameters {\n    // intercept\n    real alpha; \n    // slope\n    real beta; \n    // the standard deviation should be constrained to be positive\n    real&lt;upper=0&gt; sigma; \n}\n3transformed parameters {\n    // deterministic transformation of parameters and data\n    vector[N] mu = alpha + beta * x // linear model\n}\n4model {\n    // observation model / likelihood\n    y ~ normal(mu, sigma); \n}\n5generated quantities {\n    // compute the means for the covariate values at which to make predictions\n    vector[no_predictions] mu_pred = alpha + beta * x_predictions;\n    // sample from the predictive distribution, a normal(mu_pred, sigma).\n    array[no_predictions] real y_pred = normal_rng(to_array_1d(mu), sigma);\n}\n\n1\n\nThis is Stan’s data block: “The data block is for the declaration of variables that are read in as data. […] Each variable’s value is validated against its declaration as it is read. For example, if a variable sigma is declared as real&lt;lower=0&gt;, then trying to assign it a negative value will raise an error. As a result, data type errors will be caught as early as possible. Similarly, attempts to provide data of the wrong size for a compound data structure will also raise an error.” For more information, follow the link.\n\n2\n\nThis is Stan’s parameters block: “The variables declared in the parameters program block correspond directly to the variables being sampled by Stan’s samplers (HMC and NUTS). From a user’s perspective, the parameters in the program block are the parameters being sampled by Stan.” For more information, follow the link.\n\n3\n\nThis is Stan’s transformed parameters block: “The transformed parameters program block consists of optional variable declarations followed by statements. After the statements are executed, the constraints on the transformed parameters are validated. Any variable declared as a transformed parameter is part of the output produced for draws.” For more information, follow the link.\n\n4\n\nThis is Stan’s model block: “The model program block consists of optional variable declarations followed by statements. The variables in the model block are local variables and are not written as part of the output. […] The statements in the model block typically define the model. This is the block in which probability (sampling notation) statements are allowed.” For more information, follow the link.\n\n5\n\nThis is Stan’s generated quantities block: “The generated quantities program block is rather different than the other blocks. Nothing in the generated quantities block affects the sampled parameter values. The block is executed only after a sample has been generated.” For more information, follow the link.\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nNote:\nA linear model is actually not a good model to use for this type of data, but we will use it here to illustrate the first step in building up to more appropriate, complicated models.\n\n\n\n\n\n\n\n\n\nSubtask 2.a)\n\n\n\n\n\n\nFind the three mistakes in the code and fix them. Report the original mistakes and your fixes clearly in your report. Include the full corrected Stan code in your report. Verify that sampling was successful.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nYou may find some of the mistakes in the code using Stan syntax checker. If you copy the Stan code to a file ending .stan and open it in RStudio (you can also choose from RStudio menu File\\(\\rightarrow\\)New File\\(\\rightarrow\\)Stan file to create a new Stan file), the editor will show you some syntax errors. More syntax errors might be detected by clicking `Check’ in the bar just above the Stan file in the RStudio editor. Note that some of the errors in the presented Stan code may not be syntax errors.\n\n\n\n\nThe author runs the corrected Stan file using the following R code and plots the returned MCMC samples. Read through the code below to understand what is being plotted.\n\n\n\n\n\n\nModel fitting\n\n\n\n\n\nData assembly happens here:\n\n# These are our observations y: the proportion of students handing in each assignment (1-8),\n# sorted by year (row-wise) and assignment (column-wise).\n# While the code suggest a matrix structure, \n# the result will actually be a vector of length N = no_years * no_assignments\npropstudents&lt;-c(c(176, 174, 158, 135, 138, 129, 126, 123)/176,\n                c(242, 212, 184, 177, 174, 172, 163, 156)/242,\n                c(332, 310, 278, 258, 243, 242, 226, 224)/332,\n                c(301, 269, 231, 232, 217, 208, 193, 191)/301,\n                c(245, 240, 228, 217, 206, 199, 191, 182)/245)\n# These are our predictors x: for each observation, the corresponding assignment number.\nassignment &lt;- rep(1:8, 5)\n# These are in some sense our test data: the proportion of students handing in the last assignment (9),\n# sorted by year. \n# Usually, we would not want to split our data like that and instead\n# use e.g. Leave-One-Out Cross-Validation (LOO-CV, see e.g. http://mc-stan.org/loo/index.html)\n# to evaluate model performance.\npropstudents9 = c(121/176, 153/242, 218/332, 190/301, 175/245)\n# The total number of assignments\nno_assignments = 9\n# The assignment numbers for which we want to generate predictions\nx_predictions = 1:no_assignments\n# (Cmd)Stan(R) expects the data to be passed in the below format:\nmodel_data = list(N=length(assignment),\n                 x=assignment,\n                 y=propstudents,\n                 no_predictions=no_assignments,\n                 x_predictions=x_predictions)\n\nModel fitting happens here:\n\n# This reads the file at the specified path and tries to compile it. \n# If it fails, an error is thrown.\nretention_model = cmdstan_model(\"./assignment6_linear_model.stan\")\n# This \"out &lt;- capture.output(...)\" construction suppresses output from cmdstanr\n# See also https://github.com/stan-dev/cmdstanr/issues/646\nout &lt;- capture.output(\n    # Sampling from the model happens here:\n    fit &lt;- retention_model$sample(data=model_data, refresh=0, show_messages=FALSE)\n)\n\nDraws postprocessing happens here:\n\n# This extracts the draws from the sampling result as a data.frame.\ndraws_df = fit$draws(format=\"draws_df\")\n\n# This does some data/draws wrangling to compute the 5, 50 and 95 percentiles of \n# the mean at the specified covariate values (x_predictions). \n# It can be instructive to play around with each of the data processing steps\n# to find out what each step does, e.g. by removing parts from the back like \"|&gt;  gather(pct,y,-x)\"\n# and printing the resulting data.frame.\nmu_quantiles_df = draws_df |&gt; \n      subset_draws(variable = c(\"mu_pred\")) |&gt; \n      summarise_draws(~quantile2(.x, probs = c(0.05, .5, 0.95))) |&gt; \n      mutate(x = 1:9) |&gt; \n      pivot_longer(c(q5, q50, q95), names_to = c(\"pct\"))\n# Same as above, but for the predictions.\ny_quantiles_df = draws_df |&gt; \n      subset_draws(variable = c(\"y_pred\")) |&gt; \n      summarise_draws(~quantile2(.x, probs = c(0.05, .5, 0.95))) |&gt; \n      mutate(x = 1:9) |&gt; \n      pivot_longer(c(q5, q50, q95), names_to = c(\"pct\"))\n\n\n\n\n\nPlotting happens here:\n\nggplot() +\n  # scatter plot of the training data:  \n  geom_point(\n    aes(x, y, color=assignment), \n    data=data.frame(x=assignment, y=propstudents, assignment=\"1-8\")\n) +\n  # scatter plot of the test data:\n  geom_point(\n    aes(x, y, color=assignment), \n    data=data.frame(x=no_assignments, y=propstudents9, assignment=\"9\")\n) +\n  # you have to tell us what this plots:\n  geom_line(aes(x,y=value,linetype=pct), data=mu_quantiles_df, color='grey', linewidth=1.5) +\n  # you have to tell us what this plots:\n  geom_line(aes(x,y=value,linetype=pct), data=y_quantiles_df, color='red') +\n  # adding xticks for each assignment:\n  scale_x_continuous(breaks=1:no_assignments) +\n  # adding labels to the plot:\n  labs(y=\"assignment submission %\", x=\"assignment number\") +\n  # specifying that line types repeat:\n  scale_linetype_manual(values=c(2,1,2)) +\n  # Specify colours of the observations:\n  scale_colour_manual(values = c(\"1-8\"=\"black\", \"9\"=\"blue\")) +\n  # remove the legend for the linetypes:\n  guides(linetype=\"none\")\n\n\n\n\nFigure 1: Describe me in your submission!\n\n\n\n\n\n\n\n\n\n\n\nQuick check for model convergence\n\n\n\n\n\nIf your model is correctly implemented, sampling should have been succesful. You can check whether Stan thinks that sampling succeeded by inspecting the output of the below command, which you should be able to interpret with a little help from the CmdStan User’s Guide.\n\nfit$cmdstan_diagnose()\n\nProcessing csv files: /tmp/RtmpoVYxqN/assignment6_linear_model-202303271717-1-58cd8b.csv, /tmp/RtmpoVYxqN/assignment6_linear_model-202303271717-2-58cd8b.csv, /tmp/RtmpoVYxqN/assignment6_linear_model-202303271717-3-58cd8b.csv, /tmp/RtmpoVYxqN/assignment6_linear_model-202303271717-4-58cd8b.csv\n\nChecking sampler transitions treedepth.\nTreedepth satisfactory for all transitions.\n\nChecking sampler transitions for divergences.\nNo divergent transitions found.\n\nChecking E-BFMI - sampler transitions HMC potential energy.\nE-BFMI satisfactory.\n\nEffective sample size satisfactory.\n\nSplit R-hat values satisfactory all parameters.\n\nProcessing complete, no problems detected.\n\n\n\n\n\nBased on the above plot, answer the following questions:\n\n\n\n\n\n\nSubtask 2.b)\n\n\n\n\n\n\nWhat is the solid red line plotting? What are the dashed red lines? How and why are these different from the corresponding grey lines?\nWhat is the general trend of student retention as measured by assignment submissions?\nGiven a model fitted to the submission data for assignments 1-8, does it do a good job predicting the proportion of students who submit the final 9th assignment?\nName one different modeling choice you could make to improve the prediction.\n\n\n\n\n\n\n\n\n\n\nRubric S2: Stan warm-up: linear model of BDA retention with Stan (2 points)\n\n\n\n\n\n\nQ3: \nIs the source code included?\nQ4: \nIs the full resulting modified Stan model code presented in the report?\nQ5: \nHas the sampling success been verified/summarized (e.g. by inspecting and summarizing the output of CmdStan’s diagnose method, see also above).\nQ6: \nFix #1: Is there a fix for line ….\n\nIt has not been discussed, that this line should be fixed.\nIt has been discussed, that this line should be fixed, but there is no fix presented for it or the fix is clearly wrong.\nThere is a fix presented for this line, that clearly solves the problem.\n\nQ7: \nFix #2: Is there a fix for line ….\n\nIt has not been discussed, that this line should be fixed.\nIt has been discussed, that this line should be fixed, but there is no fix presented for it or the fix is clearly wrong.\nThere is a fix presented for this line, that clearly solves the problem.\n\nQ8: \nFix #3: Is there a fix for line ….\n\nIt has not been discussed, that this line should be fixed.\nIt has been discussed, that this line should be fixed, but there is no fix presented for it or the fix is clearly wrong.\nThere is a fix presented for this line, that clearly solves the problem.\n\nQ9: \nHave the red lines been correctly described (…)?\nQ10: \nHave the grey lines been correctly described (…)?\nQ11: \nHas the difference between the red and grey lines been explained (…)?\nQ12: \nHas the student retention trend been described (…)\nQ13: \nHas the predictive performance for the held out data been discussed and assessed satisfactorily (…)?\nQ14: \nHas at least one way to improve the model been mentioned (E.g. … or …)?\n\n\n\n\n\n\n3 Generalized linear model: Bioassay with Stan (4 points)\nReplicate the computations for the bioassay example of section 3.7 (BDA3) using Stan.\n\n\n\n\n\n\nSubtask 3.a)\n\n\n\n\n\nWrite down the model for the bioassay data in Stan syntax. For instructions in reporting your implementation, you can refer to parts 2 c) - g) in Assignment 5. Use the Gaussian prior as in Assignment 4 and 5, that is \\[\n\\begin{aligned}\n    \\begin{bmatrix}\n    \\alpha \\\\ \\beta\n    \\end{bmatrix}\n    \\sim\n    \\text{N} \\left( \\mu_0,  \\Sigma_0 \\right), \\qquad\n    \\text{where} \\quad\n     \\mu_0 = \\begin{bmatrix} 0 \\\\ 10 \\end{bmatrix} \\quad \\text{and} \\quad\n     \\Sigma_0 = \\begin{bmatrix} 2^2 & 12 \\\\ 12 & 10^2 \\end{bmatrix}.\n\\end{aligned}\n\\]\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nYou will need Stan functions multi_normal and binomial_logit for implementing the prior and observation model, respectively. In Stan code, it is easiest to declare a variable (say theta) which is a two-element vector so that the first value denotes \\(\\alpha\\) and latter one \\(\\beta\\). This is because the multi_normal function that you need for implementing the prior requires a vector as an input.\n\n\n\n\n\n\n\n\n\nSubtask 3.b)\n\n\n\n\n\nUse \\(\\widehat{R}\\) for convergence analysis. You can either use Eq. (11.4) in BDA3 or the later version that can be found in a recent article. You should specify which \\(\\widehat{R}\\) you used. In R the best choice is to use function rhat_basic() or rhat() from the posterior package (see ?posterior::rhat_basic). To check \\(\\widehat{R}\\) and other diagnostics, you can also call fit$summary(), where fit is the fit object returned by Stan’s sampling function. Report the \\(\\widehat{R}\\) values both for \\(\\alpha\\) and \\(\\beta\\) and discuss the convergence of the chains. Briefly explain in your own words how to interpret the obtained \\(\\widehat{R}\\) values.\n\n\n\n\n\n\n\n\n\nSubtask 3.c)\n\n\n\n\n\nPlot the draws for \\(\\alpha\\) and \\(\\beta\\) (scatter plot) and include this plot in your report. You can compare the results to Figure 3.3b in BDA3 to verify that your code gives sensible results. Notice though that the results in Figure 3.3b are generated from posterior with a uniform prior, so even when your algorithm works perfectly, the results will look slightly different (although fairly similar).\n\n\n\n\n\n\n\n\n\nSubtask 3.d)\n\n\n\n\n\nTo develop the course and provide feedback to Stan developers, we collect information on which Stan setup you used and whether you had any problems in setting it up or using it. Please report,\n\nOperating system (Linux, Mac, Windows) ?\nProgramming environment used: R or Python?\nInterface used: RStan, CmdStanR, PyStan, or CmdStanPy?\nDid you have installation or compilation problems?\nIn addition of these you can write what other things you found out difficult (or even frustrating) when making this assignment with Stan.\n\n\n\n\n\n\n\n\n\n\nRubric S3: Generalized linear model: Bioassay with Stan (4 points)\n\n\n\n\n\n\nQ15: \nIs the Stan model code included?\n\nNo\nYes\n\nQ16: \nDoes the implemented Stan-model seem to be working?\n\nNo implementation\nModel implemented but results not visualized/reported\nModel implemented, but the results seem weird\nModel seems to work correctly\n\nQ17: \nAre the R_hat-values reported (potential scale reduction factor, Eq. (11.4) in the BDA3)?\n\nNo\nYes, but only for alpha or beta\nYes, single values both for alpha and beta\n\nQ18: \nIs the interpretation of R_hat values correct (…)?\n\nNo interpretation or discussion about the R_hat-values, or conclusions clearly wrong\nSomewhat correct\nInterpretation correct\n\nQ19: \nDoes the report contain a scatter plot about the draws? Do the results look reasonable, that is, roughly like in the Figure below …?\n\nNo plot included\nPlot included, but the results do not look like in the figure above\nPlot included, and the results look roughly like in the figure above\n\nQ20: \nDoes the report contain description of Stan setup used and whether there were any problems in setting it up or using it?\n\nNo\nYes\n\nQ21: \nEven if the Stan model code is correct, there might be ways to give improve the layout or write the model in more elegant ways. This optional feedback box can be used to give additional suggestions for better Stan code.\n\n\n\n\n\n\n4 Overall quality of the report\n\n\n\n\n\n\nRubric S4: Overall quality of the report - 7.5/100 points\n\n\n\n\n\n\nQ22: \nDoes the report follow the formatting instructions?\n\nNot at all\nLittle\nMostly\nYes\n\nQ23: \nIn case the report doesn’t fully follow the formatting instructions, specify the formatting instruction that is not followed. If applicable, specify the page of the report, where this difference in formatting is visible.\nQ24: \nPlease provide also feedback on the presentation (e.g. text, layout, flow of the responses, figures, figure captions). Part of the course is practicing making data analysis reports. By providing feedback on the report presentation and other students can learn what they can improve or what they already did well. You should be able to provide constructive or positive feedback for all non-empty reports, even if there is nothing to say about the technical correctness of the answers. You can also provide feedback on code."
  },
  {
    "objectID": "grading_instructions.html",
    "href": "grading_instructions.html",
    "title": "Bayesian Data Analysis",
    "section": "",
    "text": "Grading instructions:\nThe grading will be done in peergrade. All grading questions and evaluations for this assignment are contained within this document in the collapsible Rubric blocks."
  },
  {
    "objectID": "overall_quality.html",
    "href": "overall_quality.html",
    "title": "Overall quality of the report",
    "section": "",
    "text": "Overall quality of the report\n\n\nDoes the report follow the formatting instructions?\n\nNot at all\nLittle\nMostly\nYes\n\nIn case the report doesn’t fully follow the formatting instructions, specify the formatting instruction that is not followed. If applicable, specify the page of the report, where this difference in formatting is visible.\nPlease provide also feedback on the presentation (e.g. text, layout, flow of the responses, figures, figure captions). Part of the course is practicing making data analysis reports. By providing feedback on the report presentation and other students can learn what they can improve or what they already did well. You should be able to provide constructive or positive feedback for all non-empty reports, even if there is nothing to say about the technical correctness of the answers. You can also provide feedback on code."
  },
  {
    "objectID": "template2.html",
    "href": "template2.html",
    "title": "Assignment 2",
    "section": "",
    "text": "\\[\n% You can add TeX macros here for HTML, see https://quarto.org/docs/authoring/markdown-basics.html#equations\n\\renewcommand{\\BetaDist}{\\mathrm{Beta}}\n\\]"
  },
  {
    "objectID": "template2.html#a",
    "href": "template2.html#a",
    "title": "Assignment 2",
    "section": "2.1 (a)",
    "text": "2.1 (a)\nWrite the likelihood, the prior and the posterior here!\n\n# These are not the actual values for the posterior! \n# You will have to compute those from the data!\nposterior_alpha = 2\nposterior_beta = 10\n\nYou can do string interpolation using R inline code execution in quarto as such:\n\\(\\alpha_\\text{prior}\\) is 2 and \\(\\beta_\\text{prior}\\) is 10. Or string interpolation within math: \\(\\BetaDist(2,10)\\)\nThis template defines a \\BetaDist TeX command which renders $\\BetaDist(1,2)$ as \\(\\BetaDist(1,2)\\)."
  },
  {
    "objectID": "template2.html#b",
    "href": "template2.html#b",
    "title": "Assignment 2",
    "section": "2.2 (b)",
    "text": "2.2 (b)\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful function: qbeta()\n\nbeta_point_est &lt;- function(prior_alpha, prior_beta, data) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above,\n    # combined with the prior provided above.\n    0.2222222\n}\nbeta_interval &lt;- function(prior_alpha, prior_beta, data, prob=0.9) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above,\n    # combined with the prior provided above.\n    c(0.0846451, 0.3956414)\n}"
  },
  {
    "objectID": "template2.html#c",
    "href": "template2.html#c",
    "title": "Assignment 2",
    "section": "2.3 (c)",
    "text": "2.3 (c)\nKeep the below name and format for the function to work with markmyassignment:\n\n# Useful function: pbeta()\n\nbeta_low &lt;- function(prior_alpha, prior_beta, data, pi_0=0.2) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above,\n    # combined with the correct prior.\n    0.4511238\n}"
  },
  {
    "objectID": "template2.html#d",
    "href": "template2.html#d",
    "title": "Assignment 2",
    "section": "2.4 (d)",
    "text": "2.4 (d)\nWrite your answer here!"
  },
  {
    "objectID": "template2.html#e",
    "href": "template2.html#e",
    "title": "Assignment 2",
    "section": "2.5 (e)",
    "text": "2.5 (e)\nPlot the PDFs here. Explain shortly what you do.\n\n# Useful function: dbeta()\n\n\n\n\n\n\n\nmarkmyassignment\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission. Make sure that this does not get displayed in the PDF!\nThe following will check the functions for which markmyassignment has been set up:\n\nmark_my_assignment()    \n\n✔ | F W S  OK | Context\n\n⠏ |         0 | task-1-subtask-1-tests                                          \n⠏ |         0 | beta_point_est()                                                \n✖ | 3       2 | beta_point_est()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:16'): beta_point_est()\nbeta_point_est(prior_alpha = alpha, prior_beta = beta, data = test) not equivalent to c(0.5).\n1/1 mismatches\n[1] 0.222 - 0.5 == -0.278\nError: Incorrect result for prior_alpha = 2, prior_beta = 4 and data = c(0, 1, 1, 0, 1, 1)\n\nFailure ('test-task-1-subtask-1-tests.R:23'): beta_point_est()\nbeta_point_est(prior_alpha = alpha, prior_beta = beta, data = test) not equivalent to c(0.5).\n1/1 mismatches\n[1] 0.222 - 0.5 == -0.278\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1)\n\nFailure ('test-task-1-subtask-1-tests.R:30'): beta_point_est()\nbeta_point_est(prior_alpha = alpha, prior_beta = beta, data = test) not equivalent to c(0.5555556).\n1/1 mismatches\n[1] 0.222 - 0.556 == -0.333\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1, 1, 1)\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-2-subtask-1-tests                                          \n⠏ |         0 | beta_interval()                                                 \n✖ | 3       2 | beta_interval()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-2-subtask-1-tests.R:16'): beta_interval()\nbeta_interval(...) not equivalent to c(0.2712499, 0.7287501).\n2/2 mismatches (average diff: 0.26)\n[1] 0.0846 - 0.271 == -0.187\n[2] 0.3956 - 0.729 == -0.333\nError: Incorrect result for prior_alpha = 2, prior_beta = 4 and data = c(0, 1, 1, 0, 1, 1) and 90% interval.\n\nFailure ('test-task-2-subtask-1-tests.R:23'): beta_interval()\nbeta_interval(...) not equivalent to c(0.2999865, 0.7000135).\n2/2 mismatches (average diff: 0.26)\n[1] 0.0846 - 0.3 == -0.215\n[2] 0.3956 - 0.7 == -0.304\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1) and 90% interval.\n\nFailure ('test-task-2-subtask-1-tests.R:30'): beta_interval()\nbeta_interval(...) not equivalent to c(0.3640088, 0.7398856).\n2/2 mismatches (average diff: 0.312)\n[1] 0.0846 - 0.364 == -0.279\n[2] 0.3956 - 0.740 == -0.344\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1, 1, 1) and 90% interval.\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-3-subtask-1-tests                                          \n⠏ |         0 | beta_low()                                                      \n✖ | 3       2 | beta_low()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-3-subtask-1-tests.R:16'): beta_low()\nbeta_low(...) not equivalent to c(0.5).\n1/1 mismatches\n[1] 0.451 - 0.5 == -0.0489\nError: Incorrect result for prior_alpha = 2, prior_beta = 4 and data = c(0, 1, 1, 0, 1, 1)\n\nFailure ('test-task-3-subtask-1-tests.R:23'): beta_low()\nbeta_low(...) not equivalent to c(0.5).\n1/1 mismatches\n[1] 0.451 - 0.5 == -0.0489\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1)\n\nFailure ('test-task-3-subtask-1-tests.R:30'): beta_low()\nbeta_low(...) not equivalent to 0.0004932497.\n1/1 mismatches\n[1] 0.451 - 0.000493 == 0.451\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1, 1, 1)\n────────────────────────────────────────────────────────────────────────────────\n\n══ Results ═════════════════════════════════════════════════════════════════════\nDuration: 0.2 s\n\n[ FAIL 9 | WARN 0 | SKIP 0 | PASS 6 ]"
  },
  {
    "objectID": "assignment1.html",
    "href": "assignment1.html",
    "title": "Assignment 1",
    "section": "",
    "text": "1 General information\nThe exercises of this assignment are not necessarily related to Chapter 1, but rather work to test whether or not you have sufficient knowledge to participate in the course. The first question checks that you remember basic terms of probability calculus. The second exercise checks your basic computer skills and guides you to learn some R functions. In the last three ones you will first write the math for solving the problems (you can, for example, write the equations in markdown or scan and include hand written answers), and then implement the final equations in R (and then you can use markmyassignment to check your results).\nThe maximum amount of points from this assignment is 3.\nWe prepared a quarto template to help you get started.\n\n\n\n\n\n\nTip\n\n\n\n\n\nReading instructions:\nChapter 1 in BDA3, see the reading instructions.\nGrading instructions:\nThe grading will be done in peergrade.\nAll grading questions and evaluations for this assignment are contained within this document in the collapsible Rubric blocks.\n\n\n\n\n\n\n\n\n\nFurther information\n\n\n\n\n\n\nThe recommended tool in this course is R (with the IDE R-Studio). You can download R here and R-Studio here. There are tons of tutorials, videos and introductions to R and R-Studio online. You can find some initial hints from RStudio Education pages.\nInstead of installing R and RStudio on you own computer, see how to use R and RStudio remotely.\nWhen working with R, we recommend writing the report using quarto and the soon to be provided template. The remplate includes the formatting instructions and how to include code and figures.\nInstead of quarto, you can use other software to make the PDF report, but the the same instructions for formatting should be used..\nReport all results in a single, anonymous *.pdf -file and return it to peergrade.io.\nThe course has its own R package aaltobda with data and functionality to simplify coding. To install the package just run the following (upgrade=\"never\" skips question about updating other packages):\n\ninstall.packages(\"remotes\")\nremotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n\nMany of the exercises can be checked automatically using the R package\nmarkmyassignment. Information on how to install and use the package can be found here. There is no need to include markmyassignment results in the report.\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in peergrade. You can set email alerts for trhe deadlines in peergrade settings.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet. You can copy, e.g., plotting code from the course demos, but really try to solve the actual assignment problems with your own code and explanations. Do not share your answers publicly. Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year. All suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nDo not submit empty PDFs or almost empty PDFs as these are just harming the other students as they can’t do peergrading for the empty or almost empty submissions. Violations of this rule will be reported and investigated in the same way was plagiarism.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\n\n\n\n\nRubric S1: General information - 7.5/100 points\n\n\n\n\n\n\nQ1: \nCan you open the PDF and it’s not blank?\n\nQ2: \nIs the report anonymous?\n\n\n\n\n\n\n2 Basic probability theory notation and terms\nThis can be trivial or you may need to refresh your memory on these concepts (see, e.g. Aalto course First Course in Probability and Statistics). Explain each of the following terms with one sentence:\n\nprobability\nprobability mass (function)\nprobability density (function)\nprobability distribution\ndiscrete probability distribution\n\ncontinuous probability distribution\n\ncumulative distribution function (cdf)\n\nlikelihood\n\n\n\n\n\n\n\nRubric S2: Basic probability theory notation and terms - 17/100 points\n\n\n\n\n\n\nQ3: \nHow is the answer?\n\nTotally wrong/has not tried\nSomething sensible written\n\nAll/almost all are correct (&gt;=70% correct)\n\n\n\n\n\n\n\n3 Basic computer skills\nThis task deals with elementary plotting and computing skills needed during the rest of the course. You can use either R or Python, although R is the recommended language and we will only guarantee support in R. For documentation in R, just type ?{function name here}.\n\n\n\n\n\n\nSubtask 3.a)\n\n\n\n\n\nPlot the density function of the Beta-distribution, with mean \\(\\mu = 0.2\\) and variance \\(\\sigma^2=0.01\\). The parameters \\(\\alpha\\) and \\(\\beta\\) of the Beta-distribution are related to the\nmean and variance according to the following equations \\[\\begin{aligned}  \n    \\alpha = \\mu \\left( \\frac{\\mu(1-\\mu)}{\\sigma^2} - 1 \\right), \\quad\n    \\beta = \\frac{\\alpha (1-\\mu) }{\\mu} \\,.\\end{aligned}\\]\n\n\n\n\n\n\n\n\n\nPotentially helpful content: Interactive Beta distribution PDF visualization\n\n\n\n\n\nBelow you can find an interactive visualization of the probability density function of the Beta distribution. You can set the two parameters of the beta distribution (\\(\\alpha\\) and \\(\\beta\\), see e.g. Wikipedia for further details). This is only meant to help you get a feel for the Beta distribution, for subtask 3.a) you will still have to plot the density function yourself.\n\n\nCode\nmath = require('https://unpkg.com/mathjs@5.9.0/dist/math.min.js')\nxs = d3.range(0, 1, 1e-3)\nviewof alpha = Inputs.input(2)\nviewof beta = Inputs.input(3) \nInputs.form([\n    Inputs.bind(\n        Inputs.range([0, 10], {value: 2, step: 0.1, label: \"alpha\"}),\n        viewof alpha\n    ), \n    Inputs.bind(\n        Inputs.range([0, 10], {value: 3, step: 0.1, label: \"beta\"}), \n        viewof beta\n    ),\n], {\n    template: (inputs) =&gt; htl.html`&lt;div style=\"display: flex; gap: 3em\"&gt;\n  ${inputs}\n&lt;/div&gt;`\n  })\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nclass BetaDistribution {\n    constructor(alpha, beta){\n        this.alpha = alpha;\n        this.beta = beta;\n        this.normalizing_constant = math.gamma(alpha) * math.gamma(beta) / math.gamma(alpha + beta)\n    }\n    pdf(x){\n        return Math.pow(x, alpha-1) * Math.pow(1 - x, beta-1) / this.normalizing_constant;\n    }\n    pdfs(x){\n        return x.map(x =&gt; this.pdf(x));\n    }\n}\nPlot.plot({\n    marks: [\n        Plot.line(d3.zip(xs, new BetaDistribution(alpha, beta).pdfs(xs))),\n        Plot.ruleX([0]),\n        Plot.ruleY([0]),\n        Plot.text([`The PDF of the Beta(${alpha}, ${beta}) distribution`], {frameAnchor: \"top\", fontSize: 20, dy: -40})\n    ],\n    x: {label: \"x\"},\n    y: {label: \"PDF\"},\n    marginTop: 60, \n    style: {fontSize: \"1em\", width: \"100%\"},\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSubtask 3.b)\n\n\n\n\n\nTake a sample of 1000 random numbers from the above distribution and plot a histogram of the results. Compare visually to the density function.\n\n\n\n\n\n\n\n\n\nSubtask 3.c)\n\n\n\n\n\nCompute the sample mean and variance from the drawn sample. Verify that they match (roughly) to the true mean and variance of the distribution.\n\n\n\n\n\n\n\n\n\nSubtask 3.d)\n\n\n\n\n\nEstimate the central 95% probability interval of the distribution from the drawn samples.\n\n\n\n\n\n\n\n\n\nRubric S3: Basic computer skills - 17/100 points\n\n\n\n\n\n\nQ4: \nIs the source code for the solutions included?\nQ5: \nDoes the plot in a) look something like this: …\nQ6: \nDoes the plot in b) look something like this: …\nQ7: \nIs the computed mean in c) close to …?\nQ8: \nIs the variance in c) close to …?\nQ9: \nIs the probability interval in d) roughly …? Remember that since the interval is computed from random samples, there is variation and the answers should be roughly the same!\n\n\n\n\n\n\n\n\n\n\nPotentially helpful content: Further formatting recommendations\n\n\n\n\n\n\nPlease try to include as much code and output as needed, but as little as possible.\nPlease make sure that the plots are properly labeled and are easily legible and understandable. This means\n\nthey should have x- and y-labels,\nthe text within should be of a size comparable to the size of the surrounding text and\neach plot should have a concise but descriptive caption or title.\n\nPlease make sure to report a sensible number of digits when reporting numbers. You will get more precise instructions later on, but for now think independently about how many digits of your results are important for the assignment.\n\n\n\n\n\n\n4 Bayes’ theorem 1\nA group of researchers has designed a new\ninexpensive and painless test for detecting lung cancer. The test is intended to be an initial screening test for the population in general. A positive result (presence of lung cancer) from the test would be followed up immediately with medication, surgery or more extensive and expensive test. The researchers know from their studies the following facts:\n\nTest gives a positive result in 98\\(\\%\\) of the time when the test subject has lung cancer.\nTest gives a negative result in 96 \\(\\%\\) of the time when the test subject does not have lung cancer.\nIn general population approximately one person in 1000 has lung cancer.\n\n\n\n\n\n\n\nSubtask 4.a)\n\n\n\n\n\nThe researchers are happy with these preliminary results (about 97\\(\\%\\) success rate), and wish to get the test to market as soon as possible. How would you advise them? Base your answer on Bayes’ rule computations.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nHint:\nRelatively high false negative (cancer doesn’t get detected) or high false positive (unnecessarily administer medication) rates are typically bad and undesirable in tests.\n\n\n\nHere are some probability values that can help you figure out if you copied the right conditional probabilities from the question.\n\nP(Test gives positive | Subject does not have lung cancer) = 4\\(\\%\\)\nP(Test gives positive and Subject has lung cancer) = 0.098\\(\\%\\) this is also referred to as the joint probability of test being positive and the subject having lung cancer.\n\n\n\n\n\n\n\nRubric S4: Bayes’ theorem 1 - 17/100 points\n\n\n\n\n\n\nQ10: \nIs p(has cancer|test result is positive) computed using Bayes’ formula (or its complement p(does not have cancer|test result is positive))?\nQ11: \nIs the result p(has cancer|test result is positive)=… (or p(does not have cancer|test result is positive)=…)\nQ12: \nIs the result motivated with something like …\n\n\n\n\n\n\n5 Bayes’ theorem 2\nWe have three boxes, A, B, and C. There are\n\n2 red balls and 5 white balls in the box A,\n4 red balls and 1 white ball in the box B, and\n1 red ball and 3 white balls in the box C.\n\nConsider a random experiment in which one of the boxes is randomly selected and from that box, one ball is randomly picked up. After observing the color of the ball it is replaced in the box it came from. Suppose also that on average box A is selected 40% of the time and box B 10% of the time (i.e. \\(P(A) = 0.4\\)).\n\n\n\n\n\n\nSubtask 5.a)\n\n\n\n\n\nWhat is the probability of picking a red ball? Implement an R function to compute that probability.\n\n\n\n\n\n\n\n\n\nSubtask 5.b)\n\n\n\n\n\nIf a red ball was picked, from which box did it most probably come from? Implement an R function to compute the probabilities for each box.\n\n\n\n\n\n\n\n\n\nRubric S5: Bayes’ theorem 2 - 17/100 points\n\n\n\n\n\n\nQ13: \nIs the source code available?\nQ14: \nHow is the answer for probability of picking a red ball?\n\nNo answer\nProbability rules … and … used, but the result is not …\nProbability rules … and … used, and the result is …\n\nQ15: \nHow is the answer for what box is most probable?\n\nNo answer\nBayes rule used to compute probabilities for all boxes given that the picked ball is red, but the answers are not …\nBayes rule used to compute probabilities for all boxes given that the picked ball is red, the answers are p… and it is not explicity said that the most probable box is box …\nBayes rule used to compute probabilities for all boxes given that the picked ball is red, the answers are … and it is explicity said that the most probable box is box …\n\n\n\n\n\n\n\n6 Bayes’ theorem 3\nAssume that on average fraternal twins (two fertilized eggs and then could be of different sex) occur once in 150 births and identical twins (single egg divides into two separate embryos, so both have the same sex) once in 400 births (Note! This is not the true value, see Exercise 1.6, page 28, in BDA3). American male singer-actor Elvis Presley (1935 – 1977) had a twin brother who died in birth. Assume that an equal number of boys and girls are born on average.\n\n\n\n\n\n\nSubtask 6.a)\n\n\n\n\n\nWhat is the probability that Elvis was an identical twin? Show the steps how you derived the equations to compute that probability and implement a function in R that computes the probability.\n\n\n\n\n\n\n\n\n\nRubric S6: Bayes’ theorem 3 - 17/100 points\n\n\n\n\n\n\nQ16: \nHow is the answer for probability of Elvis having had an identical twin brother?\n\nNo answer\nProbability that Elvis had an identical twin brother is computed using Bayes rule, but the result is not roughly …\nProbability that Elvis had an identical twin brother is computed using Bayes rule, and the result is roughly …\n\n\n\n\n\n\n\n7 Overall quality of the report\n\n\n\n\n\n\nRubric S7: Overall quality of the report - 7.5/100 points\n\n\n\n\n\n\nQ17: \nDoes the report follow the formatting instructions?\n\nNot at all\nLittle\nMostly\nYes\n\nQ18: \nIn case the report doesn’t fully follow the formatting instructions, specify the formatting instruction that is not followed. If applicable, specify the page of the report, where this difference in formatting is visible.\nQ19: \nPlease provide also feedback on the presentation (e.g. text, layout, flow of the responses, figures, figure captions). Part of the course is practicing making data analysis reports. By providing feedback on the report presentation and other students can learn what they can improve or what they already did well. You should be able to provide constructive or positive feedback for all non-empty reports, even if there is nothing to say about the technical correctness of the answers. You can also provide feedback on code."
  },
  {
    "objectID": "docker.html",
    "href": "docker.html",
    "title": "How to set up docker",
    "section": "",
    "text": "See https://docs.docker.com/get-docker/:\n\nDocker is an open platform for developing, shipping, and running applications. Docker enables you to separate your applications from your infrastructure so you can deliver software quickly. With Docker, you can manage your infrastructure in the same ways you manage your applications. By taking advantage of Docker’s methodologies for shipping, testing, and deploying code quickly, you can significantly reduce the delay between writing code and running it in production.\nYou can download and install Docker on multiple platforms. Refer to the following section and choose the best installation path for you.\n\nFurther instructions for Mac, Windows and Linux.\nWith Linux things should be self-explanatory enough for the users that self-select to use Linux. For Mac installation instructions should be easy to follow, but do tell if they are not. For Windows, things might get a bit more complicated, but it should be less painful than trying to get Stan to work.\n\n\nIt looks like you’d ideally enable Windows Subsystem for Linux (WSL) in its second version, see https://github.com/rocker-org/rocker/wiki/Sharing-files-with-host-machine:\n\nFor better performance, it is recommended to set up a Linux distribution on WSL2 and save your files in the Linux file system. See the best practices of Docker Desktop WSL2 backend for details. https://docs.docker.com/docker-for-windows/wsl/#best-practices\n\nInstruction on how to install it can be found at https://learn.microsoft.com/en-us/windows/wsl/install:\n\n\nDevelopers can access the power of both Windows and Linux at the same time on a Windows machine. The Windows Subsystem for Linux (WSL) lets developers install a Linux distribution (such as Ubuntu, OpenSUSE, Kali, Debian, Arch Linux, etc) and use Linux applications, utilities, and Bash command-line tools directly on Windows, unmodified, without the overhead of a traditional virtual machine or dualboot setup.\n\nYou must be running Windows 10 version 2004 and higher (Build 19041 and higher) or Windows 11 to use the commands below. If you are on earlier versions please see the manual install page.\n\nYou can now install everything you need to run WSL with a single command. Open PowerShell or Windows Command Prompt in administrator mode by right-clicking and selecting “Run as administrator”, enter the wsl –install command, then restart your machine.\nwsl --install\nThis command will enable the features necessary to run WSL and install the Ubuntu distribution of Linux. (This default distribution can be changed).\nIf you’re running an older build, or just prefer not to use the install command and would like step-by-step directions, see WSL manual installation steps for older versions.\nThe first time you launch a newly installed Linux distribution, a console window will open and you’ll be asked to wait for files to de-compress and be stored on your machine. All future launches should take less than a second."
  },
  {
    "objectID": "simple_template2.html",
    "href": "simple_template2.html",
    "title": "Assignment 2",
    "section": "",
    "text": "\\[\n% You can add TeX macros here for HTML, see https://quarto.org/docs/authoring/markdown-basics.html#equations\n\\renewcommand{\\BetaDist}{\\mathrm{Beta}}\n\\]"
  },
  {
    "objectID": "simple_template2.html#a",
    "href": "simple_template2.html#a",
    "title": "Assignment 2",
    "section": "2.1 (a)",
    "text": "2.1 (a)\nWrite the likelihood, the prior and the posterior here!\n\n# These are not the actual values for the posterior! \n# You will have to compute those from the data!\nposterior_alpha = 2\nposterior_beta = 10\n\nYou can do string interpolation using R inline code execution in quarto as such:\n\\(\\alpha_\\text{prior}\\) is 2 and \\(\\beta_\\text{prior}\\) is 10. Or string interpolation within math: \\(\\BetaDist(2,10)\\)\nThis template defines a \\BetaDist TeX command which renders $\\BetaDist(1,2)$ as \\(\\BetaDist(1,2)\\)."
  },
  {
    "objectID": "simple_template2.html#b",
    "href": "simple_template2.html#b",
    "title": "Assignment 2",
    "section": "2.2 (b)",
    "text": "2.2 (b)\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful function: qbeta()\n\nbeta_point_est &lt;- function(prior_alpha, prior_beta, data) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above,\n    # combined with the prior provided above.\n    0.2222222\n}\nbeta_interval &lt;- function(prior_alpha, prior_beta, data, prob=0.9) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above,\n    # combined with the prior provided above.\n    c(0.0846451, 0.3956414)\n}"
  },
  {
    "objectID": "simple_template2.html#c",
    "href": "simple_template2.html#c",
    "title": "Assignment 2",
    "section": "2.3 (c)",
    "text": "2.3 (c)\nKeep the below name and format for the function to work with markmyassignment:\n\n# Useful function: pbeta()\n\nbeta_low &lt;- function(prior_alpha, prior_beta, data, pi_0=0.2) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above,\n    # combined with the correct prior.\n    0.4511238\n}"
  },
  {
    "objectID": "simple_template2.html#d",
    "href": "simple_template2.html#d",
    "title": "Assignment 2",
    "section": "2.4 (d)",
    "text": "2.4 (d)\nWrite your answer here!"
  },
  {
    "objectID": "simple_template2.html#e",
    "href": "simple_template2.html#e",
    "title": "Assignment 2",
    "section": "2.5 (e)",
    "text": "2.5 (e)\nPlot the PDFs here. Explain shortly what you do.\n\n# Useful function: dbeta()\n\n\n\n\n\n\n\nmarkmyassignment\n\n\n\n\n\nThis block will only be visible in your HTML output, but will be hidden when rendering to PDF for the submission. Make sure that this does not get displayed in the PDF!\nThe following will check the functions for which markmyassignment has been set up:\n\nmark_my_assignment()    \n\n✔ | F W S  OK | Context\n\n⠏ |         0 | task-1-subtask-1-tests                                          \n⠏ |         0 | beta_point_est()                                                \n✖ | 3       2 | beta_point_est()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:16'): beta_point_est()\nbeta_point_est(prior_alpha = alpha, prior_beta = beta, data = test) not equivalent to c(0.5).\n1/1 mismatches\n[1] 0.222 - 0.5 == -0.278\nError: Incorrect result for prior_alpha = 2, prior_beta = 4 and data = c(0, 1, 1, 0, 1, 1)\n\nFailure ('test-task-1-subtask-1-tests.R:23'): beta_point_est()\nbeta_point_est(prior_alpha = alpha, prior_beta = beta, data = test) not equivalent to c(0.5).\n1/1 mismatches\n[1] 0.222 - 0.5 == -0.278\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1)\n\nFailure ('test-task-1-subtask-1-tests.R:30'): beta_point_est()\nbeta_point_est(prior_alpha = alpha, prior_beta = beta, data = test) not equivalent to c(0.5555556).\n1/1 mismatches\n[1] 0.222 - 0.556 == -0.333\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1, 1, 1)\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-2-subtask-1-tests                                          \n⠏ |         0 | beta_interval()                                                 \n✖ | 3       2 | beta_interval()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-2-subtask-1-tests.R:16'): beta_interval()\nbeta_interval(...) not equivalent to c(0.2712499, 0.7287501).\n2/2 mismatches (average diff: 0.26)\n[1] 0.0846 - 0.271 == -0.187\n[2] 0.3956 - 0.729 == -0.333\nError: Incorrect result for prior_alpha = 2, prior_beta = 4 and data = c(0, 1, 1, 0, 1, 1) and 90% interval.\n\nFailure ('test-task-2-subtask-1-tests.R:23'): beta_interval()\nbeta_interval(...) not equivalent to c(0.2999865, 0.7000135).\n2/2 mismatches (average diff: 0.26)\n[1] 0.0846 - 0.3 == -0.215\n[2] 0.3956 - 0.7 == -0.304\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1) and 90% interval.\n\nFailure ('test-task-2-subtask-1-tests.R:30'): beta_interval()\nbeta_interval(...) not equivalent to c(0.3640088, 0.7398856).\n2/2 mismatches (average diff: 0.312)\n[1] 0.0846 - 0.364 == -0.279\n[2] 0.3956 - 0.740 == -0.344\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1, 1, 1) and 90% interval.\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |         0 | task-3-subtask-1-tests                                          \n⠏ |         0 | beta_low()                                                      \n✖ | 3       2 | beta_low()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-3-subtask-1-tests.R:16'): beta_low()\nbeta_low(...) not equivalent to c(0.5).\n1/1 mismatches\n[1] 0.451 - 0.5 == -0.0489\nError: Incorrect result for prior_alpha = 2, prior_beta = 4 and data = c(0, 1, 1, 0, 1, 1)\n\nFailure ('test-task-3-subtask-1-tests.R:23'): beta_low()\nbeta_low(...) not equivalent to c(0.5).\n1/1 mismatches\n[1] 0.451 - 0.5 == -0.0489\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1)\n\nFailure ('test-task-3-subtask-1-tests.R:30'): beta_low()\nbeta_low(...) not equivalent to 0.0004932497.\n1/1 mismatches\n[1] 0.451 - 0.000493 == 0.451\nError: Incorrect result for prior_alpha = 3, prior_beta = 5 and data = c(0, 1, 1, 0, 1, 1, 0, 1, 1, 1)\n────────────────────────────────────────────────────────────────────────────────\n\n══ Results ═════════════════════════════════════════════════════════════════════\nDuration: 0.2 s\n\n[ FAIL 9 | WARN 0 | SKIP 0 | PASS 6 ]"
  }
]