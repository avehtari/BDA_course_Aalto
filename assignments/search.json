[
  {
    "objectID": "assignment5.html",
    "href": "assignment5.html",
    "title": "Assignment 5",
    "section": "",
    "text": "1 General information\nThis assignment will be published later!",
    "crumbs": [
      "Assignments",
      "Assignment 5"
    ]
  },
  {
    "objectID": "template2.html",
    "href": "template2.html",
    "title": "Notebook for Assignment 2",
    "section": "",
    "text": "1 General information\nThis assignment is related to Lecture 2 and BDA3 Chapters 1 and 2. You may find an additional discussion about choosing priors in a blog post by Andrew Gelman.\n\n\n\n\n\n\nTip\n\n\n\n\n\nReading instructions:\n\nThe reading instructions for BDA3 Chapter 1.\nThe reading instructions for BDA3 Chapter 2.\n\n\n\n\n\n\n\n\n\n\nGeneral Instructions for Answering the Assignment Questions\n\n\n\n\n\n\nQuestions below are exact copies of the text found in the MyCourses quiz and should serve as a notebook where you can store notes and code.\nWe recommend opening these notebooks in the Aalto JupyterHub, see how to use R and RStudio remotely.\nFor inspiration for code, have a look at the BDA R Demos and the specific Assignment code notebooks\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page. These will help to gain deeper understanding of the topic.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in MyCourses.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet.\nDo not share your answers publicly.\nDo not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year.\nUse of AI is allowed on the course, but the most of the work needs to by the student, and you need to report whether you used AI and in which way you used them (See points 5 and 6 in Aalto guidelines for use of AI in teaching).\nAll suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThe following installs the aaltobda package:\n#| cache: true\n# Caching should be fine here\ninstall.packages(\"aaltobda\", repos = c(\"https://avehtari.github.io/BDA_course_Aalto/\", getOption(\"repos\")))\n\n\n\n\n\n2 Inference for binomial proportion\nAlgae status is monitored in 274 sites at Finnish lakes and rivers. The observations for the 2008 algae status at each site are presented in the dataset algae in the aaltobda package (‘0’: no algae, ‘1’: algae present).\nLoading the library and the data.\n\nlibrary(aaltobda)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(latex2exp)\ndata(\"algae\")\n# The data are now stored in the variable `algae`.\n# These are the values for the prior required in the assignment\nprior_alpha = 2\nprior_beta = 10\n\nLet \\(\\pi\\) be the probability of a monitoring site having detectable blue-green algae levels and \\(y\\) the observations in algae. Use a binomial model for the observations \\(y\\) and a \\(Beta(2,10)\\) prior for binomial model parameter \\(\\pi\\) to formulate a Bayesian model. Here it is not necessary to derive the posterior distribution for \\(\\pi\\) as it has already been done in the book and it suffices to refer to that derivation. Also, it is not necessary to write out the distributions; it is sufficient to use label-parameter format, e.g. \\(Beta(\\alpha,\\beta)\\).\nYour task is to perform Bayesian inference for a binomial model and answer questions based on it.\n\n\n3 Formulating probabilities\n\n\n4 Summary of the posterior distribution of \\(\\theta\\)\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful function: qbeta()\n\nbeta_point_est &lt;- function(prior_alpha, prior_beta, data) {\n    # Do computation here, and return as below.\n    \n}\nbeta_interval &lt;- function(prior_alpha, prior_beta, data, prob=0.9) {\n    # Do computation here, and return as below.\n\n\n}\n\n\n\n5 Comparison to historical records\nKeep the below name and format for the function to work with markmyassignment:\n\n# Useful function: pbeta()\n\nbeta_low &lt;- function(prior_alpha, prior_beta, data, pi_0=0.2) {\n    # Do computation here, and return as below.\n\n}\n\n\n\n6 Prior sensitivity analysis\nMake prior sensitivity analysis by testing a couple of different reasonable priors and plot the different posteriors. Try to summarise the results by one or two sentences.\n# Useful function: dbeta()\nAmend the code below to help you.\n\n# Beta distribution density function\nbeta_density &lt;- function(x, shape1, shape2) {\n  dbeta(x, shape1, shape2)\n}\n\n# Binomial likelihood density function\nbinomial_likelihood &lt;- function(x, n, k) {\n  choose(n, k) * x^k * (1 - x)^(n - k)\n}\n\n# Parameters for the Beta prior distributions\npriors &lt;- list(c(#alpha, #beta), c(#alpha, #beta), c(#alpha, #beta)) # Define three different priors here priors, (alpha, beta)\n\n# Parameters for the binomial likelihood (number of trials and successes)\nn &lt;-  # number of trials\nk &lt;-  # number of successes\n\n# Create a sequence of x values from 0 to 1\nx &lt;- seq(0, 1, length.out = 100)\n\n\n# Create a data frame with densities\ndensities_list &lt;- lapply(priors, function(prior) {\n  alpha_prior &lt;- prior[1]\n  beta_prior &lt;- prior[2]\n  alpha_posterior &lt;- alpha_prior + k\n  beta_posterior &lt;- beta_prior + n - k\n  \n  data.frame(\n    x = rep(x, 2),\n    density = c(beta_density(x, alpha_prior, beta_prior),\n                beta_density(x, alpha_posterior, beta_posterior)),\n    distribution = factor(rep(c(\"Prior\", \"Posterior\"), each = length(x))),\n    prior = paste(\"Prior: Alpha =\", alpha_prior, \"Beta =\", beta_prior)\n  )\n})\n\ndf &lt;- bind_rows(densities_list)\n\n# Plot the densities using ggplot2\nggplot(df, aes(x = x, y = density, color = distribution)) +\n  geom_line(size = 1) +\n  facet_wrap(~ prior, scales = \"fixed\", nrow = 3) +\n  labs(title = \"Prior and Posterior Densities for Different Priors\", \n       x = TeX(\"$\\\\theta$\"), \n       y = \"Density\", \n       color = \"Distribution\") +\n  theme_minimal()",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 2"
    ]
  },
  {
    "objectID": "assignment4.html",
    "href": "assignment4.html",
    "title": "Assignment 4",
    "section": "",
    "text": "1 General information\nThis assignment will be published later!",
    "crumbs": [
      "Assignments",
      "Assignment 4"
    ]
  },
  {
    "objectID": "template6.html",
    "href": "template6.html",
    "title": "Notebook for Assignment 6",
    "section": "",
    "text": "1 General information\nThis notebook will be published later!",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 6"
    ]
  },
  {
    "objectID": "template3.html",
    "href": "template3.html",
    "title": "Notebook for Assignment 3",
    "section": "",
    "text": "This assignment is related to Lecture 3 and BDA3 Chapters 2 and 3. Use Frank Harrell’s recommendations on how to state results in Bayesian two group comparisons (and note that there is no point null hypothesis testing in this assignment).\n\n\n\n\n\n\nTip\n\n\n\n\n\nReading instructions:\n\nThe reading instructions for BDA3 Chapter 2.\nThe reading instructions for BDA3 Chapter 3.\n\n\n\n\n\n\n\n\n\n\nGeneral Instructions for Answering the Assignment Questions\n\n\n\n\n\n\nQuestions below are exact copies of the text found in the MyCourses quiz and should serve as a notebook where you can store notes and code.\nWe recommend opening these notebooks in the Aalto JupyterHub, see how to use R and RStudio remotely.\nFor inspiration for code, have a look at the BDA R Demos and the specific Assignment code notebooks\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page. These will help to gain deeper understanding of the topic.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in MyCourses.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet.\nDo not share your answers publicly.\nDo not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year.\nUse of AI is allowed on the course, but the most of the work needs to by the student, and you need to report whether you used AI and in which way you used them (See points 5 and 6 in Aalto guidelines for use of AI in teaching).\nAll suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\n\n\n\n\nSetup\n\n\n\n\n\nThe following installs and loads the aaltobda package:\n\nif(!require(aaltobda)){\n    install.packages(\"remotes\")\n    remotes::install_github(\"avehtari/BDA_course_Aalto\", subdir = \"rpackage\", upgrade=\"never\")\n    library(aaltobda)\n}\n\nLoading required package: aaltobda\n\n\nThe following will set-up markmyassignment to check your functions at the end of the notebook:\n\nif(!require(markmyassignment)){\n    install.packages(\"markmyassignment\")\n    library(markmyassignment)\n}\n\nLoading required package: markmyassignment\n\nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/assignments/tests/assignment3.yml\", sep=\"\")\nset_assignment(assignment_path)    \n\nError in get_file.path_github(path = path, dest = temp_file): Not Found (HTTP 404).\n\n\nThe following installs and loads the latex2exp package, which allows us to use LaTeX in plots:\n\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n\nLoading required package: latex2exp\n\n\n\n\n\n\n\nThe following installs and loads the posterior package, which allows us to use its rvar Random Variable Datatype:\n\nif(!require(posterior)){\n    install.packages(\"posterior\")\n    library(posterior)\n}\n\nLoading required package: posterior\n\n\nThis is posterior version 1.6.0\n\n\n\nAttaching package: 'posterior'\n\n\nThe following object is masked from 'package:aaltobda':\n\n    mcse_quantile\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\n\nThe following installs and loads the ggdist package along with other packages for advanced plotting functions:\n\nif(!require(ggplot2)){\n    install.packages(\"ggplot2\")\n    library(ggplot2)\n}\n\nLoading required package: ggplot2\n\nggplot2::theme_set(theme_minimal(base_size = 14))\nif(!require(ggdist)){\n    install.packages(\"ggdist\")\n    library(ggdist)\n}\n\nLoading required package: ggdist\n\nif(!require(grid)){\n  install.packages(\"grid\")\n  library(grid)\n}\n\nLoading required package: grid\n\nif(!require(gridExtra)){\n  install.packages(\"gridExtra\")\n  library(gridExtra)\n}\n\nLoading required package: gridExtra\n\nif(!require(tidyr)){\n  install.packages(\"tidyr\")\n  library(tidyr)\n}\n\nLoading required package: tidyr",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 3"
    ]
  },
  {
    "objectID": "template3.html#setting-up-advanced-packages-posterior-and-ggdist",
    "href": "template3.html#setting-up-advanced-packages-posterior-and-ggdist",
    "title": "Notebook for Assignment 3",
    "section": "",
    "text": "The following installs and loads the posterior package, which allows us to use its rvar Random Variable Datatype:\n\nif(!require(posterior)){\n    install.packages(\"posterior\")\n    library(posterior)\n}\n\nLoading required package: posterior\n\n\nThis is posterior version 1.6.0\n\n\n\nAttaching package: 'posterior'\n\n\nThe following object is masked from 'package:aaltobda':\n\n    mcse_quantile\n\n\nThe following objects are masked from 'package:stats':\n\n    mad, sd, var\n\n\nThe following objects are masked from 'package:base':\n\n    %in%, match\n\n\nThe following installs and loads the ggdist package along with other packages for advanced plotting functions:\n\nif(!require(ggplot2)){\n    install.packages(\"ggplot2\")\n    library(ggplot2)\n}\n\nLoading required package: ggplot2\n\nggplot2::theme_set(theme_minimal(base_size = 14))\nif(!require(ggdist)){\n    install.packages(\"ggdist\")\n    library(ggdist)\n}\n\nLoading required package: ggdist\n\nif(!require(grid)){\n  install.packages(\"grid\")\n  library(grid)\n}\n\nLoading required package: grid\n\nif(!require(gridExtra)){\n  install.packages(\"gridExtra\")\n  library(gridExtra)\n}\n\nLoading required package: gridExtra\n\nif(!require(tidyr)){\n  install.packages(\"tidyr\")\n  library(tidyr)\n}\n\nLoading required package: tidyr",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 3"
    ]
  },
  {
    "objectID": "template3.html#marginal-and-probabilities-for-mu",
    "href": "template3.html#marginal-and-probabilities-for-mu",
    "title": "Notebook for Assignment 3",
    "section": "2.1 Marginal and probabilities for \\(\\mu\\)",
    "text": "2.1 Marginal and probabilities for \\(\\mu\\)\nWrite your answers and code here!\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful functions: mean(), length(), sqrt(), sum()\n# and qtnew(), dtnew() (from aaltobda)\n\nmu_point_est &lt;- function(data) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    14.5\n    \n}\nmu_interval &lt;- function(data, prob = 0.95) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(13.3, 15.7)\n    \n}\n\nYou can plot the density as below if you implement mu_pdf to compute the PDF of the posterior \\(p(\\mu|y)\\) of the average hardness \\(\\mu\\).\n\nmu_pdf &lt;- function(data, x){\n    # Compute necessary parameters here.\n    # These are the correct parameters for `windshieldy_test` \n    # with the provided uninformative prior.\n    df = 3\n    location = 14.5\n    scale = 0.3817557\n    # Use the computed parameters as below to compute the PDF:\n    \n    dtnew(x, df, location, scale)\n}\n\nx_interval = mu_interval(windshieldy1, .999)\nlower_x = x_interval[1]\nupper_x = x_interval[2]\nx = seq(lower_x, upper_x, length.out=1000)\nplot(\n    x, mu_pdf(windshieldy1, x), type=\"l\", \n    xlab=TeX(r'(average hardness $\\mu$)'), \n    ylab=TeX(r'(PDF of the posterior $p(\\mu|y)$)')\n)\n\n\n\n\n\n\n\nFigure 1: PDF of the posterior \\(p(\\mu|y)\\) of the average hardness \\(\\mu\\)",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 3"
    ]
  },
  {
    "objectID": "template3.html#joint-posterior-distribution-for-mu-and-sigma",
    "href": "template3.html#joint-posterior-distribution-for-mu-and-sigma",
    "title": "Notebook for Assignment 3",
    "section": "2.2 Joint posterior distribution for \\(\\mu\\) and \\(\\sigma\\)",
    "text": "2.2 Joint posterior distribution for \\(\\mu\\) and \\(\\sigma\\)\n\n# Define the inputs for the below: Sufficient Statistics\ny &lt;- windshieldy1\nn &lt;- length(y)\ns2 &lt;- var(y)\nmy &lt;- mean(y)\n\n# helper functions to sample from and evaluate\n# scaled inverse chi-squared distribution\nrsinvchisq &lt;- function(n, nu, s2, ...) nu*s2 / rchisq(n , nu, ...)\ndsinvchisq &lt;- function(x, nu, s2){\n  exp(log(nu/2)*nu/2 - lgamma(nu/2) + log(s2)/2*nu - log(x)*(nu/2+1) - (nu*s2/2)/x)\n}\n\n\n# Sample 1000 draws from marginal posteriors\nns &lt;- 1000\nsigma2  &lt;- rsinvchisq(ns, n-1, s2)\nmu &lt;- my + sqrt(sigma2/n)*rnorm(length(sigma2))\nsigma &lt;- sqrt(sigma2)\n\n# Compute the density in a grid of ranged for the grids\nt1l &lt;- c(10, 20)\nt2l &lt;- c(0.5, 7)\nnl &lt;- c(0.001, 50)\nt1 &lt;- seq(t1l[1], t1l[2], length.out = ns)\nt2 &lt;- seq(t2l[1], t2l[2], length.out = ns)\n\n\n# Compute the exact marginal density of mu:\n# multiplication by 1./sqrt(s2/n) is due to the transformation of\n# variable z=(x-mean(y))/sqrt(s2/n), see BDA3 p. 21\npm &lt;- dt((t1-my) / sqrt(s2/n), n-1) / sqrt(s2/n)\n\n# Estimate the marginal density using samples and ad hoc Gaussian kernel approximation\npmk &lt;- density(mu, adjust = 2, n = ns, from = t1l[1], to = t1l[2])$y\n\n#Compute the exact marginal density of sigma:\n# the multiplication by 2*t2 is due to the transformation of\n# variable z=t2^2, see BDA3 p. 21\nps &lt;- dsinvchisq(t2^2, n-1, s2) * 2*t2\n\n# Estimate the marginal density using samples and ad hoc Gaussian kernel approximation\npsk &lt;- density(sigma, n = ns, from = t2l[1], to = t2l[2])$y\n\n\n# Evaluate the joint density in a grid. Note that the following is not normalized, but for plotting contours it does not matter :\n# Combine grid points into another data frame\n# with all pairwise combinations\ndfj &lt;- data.frame(t1 = rep(t1, each = length(t2)),\n                  t2 = rep(t2, length(t1)))\ndfj$z &lt;- dsinvchisq(dfj$t2^2, n-1, s2) * 2*dfj$t2 * dnorm(dfj$t1, my, dfj$t2/sqrt(n))\n# breaks for plotting the contours\ncl &lt;- seq(1e-5, max(dfj$z), length.out = 6)\n\n\n\n# Now, visualise the joint and marginal densities\ndfm &lt;- data.frame(t1, Exact = pm, Empirical = pmk) |&gt;\n  pivot_longer(cols = !t1, names_to=\"grp\", values_to=\"p\")\nmargmu &lt;- ggplot(dfm) +\n  geom_line(aes(t1, p, color = grp)) +\n  coord_cartesian(xlim = t1l) +\n  labs(title = 'Marginal of mu', x = '', y = '') +\n  scale_y_continuous(breaks = NULL) +\n  theme(legend.background = element_blank(),\n        legend.position.inside = c(0.75, 0.8),\n        legend.title = element_blank())\n\n\ndfs &lt;- data.frame(t2, Exact = ps, Empirical = psk) |&gt; \n  pivot_longer(cols = !t2, names_to=\"grp\", values_to=\"p\")\nmargsig &lt;- ggplot(dfs) +\n  geom_line(aes(t2, p, color = grp)) +\n  coord_cartesian(xlim = t2l) +\n  coord_flip() +\n  labs(title = 'Marginal of sigma', x = '', y = '') +\n  scale_y_continuous(breaks = NULL) +\n  theme(legend.background = element_blank(),\n        legend.position.inside = c(0.75, 0.8),\n        legend.title = element_blank())\n\nCoordinate system already present. Adding new coordinate system, which will\nreplace the existing one.\n\njoint1labs &lt;- c('Samples','Exact contour')\njoint1 &lt;- ggplot() +\n  geom_point(data = data.frame(mu,sigma), aes(mu, sigma, col = '1'), size = 0.1) +\n  geom_contour(data = dfj, aes(t1, t2, z = z, col = '2'), breaks = cl) +\n  coord_cartesian(xlim = t1l,ylim = t2l) +\n  labs(title = 'Joint posterior', x = '', y = '') +\n  scale_y_continuous(labels = NULL) +\n  scale_x_continuous(labels = NULL) +\n  scale_color_manual(values=c('blue', 'black'), labels = joint1labs) +\n  guides(color = guide_legend(nrow  = 1, override.aes = list(\n    shape = c(16, NA), linetype = c(0, 1), size = c(2, 1)))) +\n  theme(legend.background = element_blank(),\n        legend.position.inside = c(0.5, 0.9),\n        legend.title = element_blank())\n\n\n# blank plot for combining the plots\nbp &lt;- grid.rect(gp = gpar(col = 'white'))\n\n\n\n\n\n\n\ngrid.arrange(joint1, margsig, margmu, bp, nrow = 2)",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 3"
    ]
  },
  {
    "objectID": "template3.html#predictive-distribution",
    "href": "template3.html#predictive-distribution",
    "title": "Notebook for Assignment 3",
    "section": "2.3 Predictive distribution",
    "text": "2.3 Predictive distribution\nWrite your answers and code here!\nKeep the below name and format for the functions to work with markmyassignment:\n\n# Useful functions: mean(), length(), sqrt(), sum()\n# and qtnew(), dtnew() (from aaltobda)\n\nmu_pred_point_est &lt;- function(data) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    14.5\n    \n}\nmu_pred_interval &lt;- function(data, prob = 0.95) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(11.8, 17.2)\n    \n}\n\nYou can plot the density as below if you implement mu_pred_pdf to compute the PDF of the posterior predictive \\(p(\\tilde{y}|y)\\) of a new hardness observation \\(\\tilde{y}\\).\n\nmu_pred_pdf &lt;- function(data, x){\n    # Compute necessary parameters here.\n    # These are the correct parameters for `windshieldy_test` \n    # with the provided uninformative prior.\n    df = 3\n    location = 14.5\n    scale = 0.8536316\n    # Use the computed parameters as below to compute the PDF:\n    \n    dtnew(x, df, location, scale)\n}\n\nx_interval = mu_pred_interval(windshieldy1, .999)\nlower_x = x_interval[1]\nupper_x = x_interval[2]\nx = seq(lower_x, upper_x, length.out=1000)\nplot(\n    x, mu_pred_pdf(windshieldy1, x), type=\"l\", \n    xlab=TeX(r'(new hardness observation $\\tilde{y}$)'), \n    ylab=TeX(r'(PDF of the posterior predictive $p(\\tilde{y}|y)$)')\n)\n\n\n\n\n\n\n\nFigure 2: PDF of the posterior predictive \\(p(\\tilde{y}|y)\\) of a new hardness observation \\(\\tilde{y}\\)",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 3"
    ]
  },
  {
    "objectID": "template3.html#advanced-tools-posteriors-rvar-ggdists-stat_dotsinterval",
    "href": "template3.html#advanced-tools-posteriors-rvar-ggdists-stat_dotsinterval",
    "title": "Notebook for Assignment 3",
    "section": "3.1 advanced tools (posterior’s rvar, ggdist’s stat_dotsinterval)",
    "text": "3.1 advanced tools (posterior’s rvar, ggdist’s stat_dotsinterval)\nThe posterior package’s random variable datatype rvar is a “sample-based representation of random variables” which makes handling of random samples (of draws) such as the ones contained in the above variables p0 and p1 easier. By default, it prints as the mean and standard deviation of the draws, such that rvar(p0) prints as 0.05 ± 0.021 and rvar(p1) prints as 0.1 ± 0.029.\nThe datatype is “designed to […] be able to be used inside data.frame()s and tibble()s, and to be used with distribution visualizations in the ggdist package.” The code below sets up an R data.frame() with the draws in p0 and p1 wrapped in an rvar, and uses that data frame to visualize the draws using ggdist, an R package building on ggplot2 and “designed for both frequentist and Bayesian uncertainty visualization”.\nThe below plot, Figure 3 uses ggdist’s stat_dotsinterval(), which by default visualizes\n\nan rvar’s median and central 66% and 95% intervals using a black dot and lines of varying thicknesses as when using ggdist’s stat_pointinterval() and\nan rvar’s draws using grey dots as when using ggdist’s stat_dots():\n\n\nr0 = rvar(p0)\nr1 = rvar(p1)\nggplot(data.frame(\n    rv_name=c(\"control\", \"treatment\"), rv=c(r0, r1)\n)) +\n    aes(xdist=rv, y=rv_name) + \n    labs(x=\"probabilities of death\", y=\"patient group\") + \n    stat_dotsinterval()\n\n\n\n\n\n\n\nFigure 3: Probabilities of death for the two patient groups.\n\n\n\n\n\nrvars make it easy to compute functions of random variables, such as\n\ndifferences, e.g. \\(p_0 - p_1\\): r0 - r1 computes an rvar which prints as -0.05 ± 0.037, indicating the sample mean and the sample standard deviation of the difference of the probabilities of death,\nproducts, e.g. \\(p_0 \\, p_1\\): r0 * r1 computes an rvar which prints as 0.005 ± 0.0026 which in this case has no great interpretation\n\nBelow, in Figure 4, we compute the odds ratios using the rvars and visualize its median, central intervals and draws, as above in Figure 3:\n\nrodds_ratio = (r1/(1-r1))/(r0/(1-r0))\nggplot(data.frame(\n    rv=c(rodds_ratio)\n)) +\n    aes(xdist=rv) + \n    labs(x=\"odds ratio\", y=\"relative amount of draws\") + \n    stat_dotsinterval()\n\n\n\n\n\n\n\nFigure 4: Odds ratios of the two patient groups.\n\n\n\n\n\nYou can use Figure 4 to visually check whether the answers you computed make sense.",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 3"
    ]
  },
  {
    "objectID": "assignment_instructions.html",
    "href": "assignment_instructions.html",
    "title": "Assignment instructions",
    "section": "",
    "text": "In addition to R-markdown, Quarto can be used to write the assignment reports. This template contains essentially the same information as the old R-markdown template but we illustrate how you can use Quarto for the assignments.\nSome useful resources to get started with Quarto (also an example of a list):\n\nGetting started with Quarto and Rstudio from the official webpage\nA comprehensive user guide from the official webpage\nMarkdown basics\nQuarto FAQ for R-markdown users\nAwesome Quarto - list by Mickaël Canouil\n\nTo create your assignment, you can use the assignment-specific templates (recommended, see e.g. the links at the top of assignment 1) or remove the formatting instructions and use this file as a template. Keep the header (the first lines of this file between two lines of —) as it sets the author name to be anonymous, and you can set the title to match the assignment number.\nAs with R-markdown, you can use the text editor of your choice, but RStudio’s editor is probably the easiest and you can choose the formatting (e.g. section headings, bolding, lists, figures, etc.) from the toolbar. Switching between the source and visual mode allows the quick preview of your formatting.\nNote The report should be anonymous and submitted to peergrade.io as assignmentX.pdf. Aalto JupyterHub has everything installed and you should be able to render the templates to pdf without any further set-up, but if there are problems contact the TAs or get more information on this from the Quarto documentation. Alternatively, if you have problem with creating a PDF file, start by creating an HTML file and the just print the HTML to a PDF. You may also use other software to create the report PDF, but follow the general instructions in this file (see the pdf version of the template file).",
    "crumbs": [
      "General instructions",
      "Assignment instructions"
    ]
  },
  {
    "objectID": "assignment_instructions.html#a",
    "href": "assignment_instructions.html#a",
    "title": "Assignment instructions",
    "section": "5.1 a)",
    "text": "5.1 a)\nFor each subtask include necessary textual explanation, equations, code and figures so that the answer to the question flows naturally. You can think what kind of report would you like to review, and what kind of information would make it easier where there is error (if there are errors).",
    "crumbs": [
      "General instructions",
      "Assignment instructions"
    ]
  },
  {
    "objectID": "assignment3.html",
    "href": "assignment3.html",
    "title": "Assignment 3",
    "section": "",
    "text": "The exercises here refer to the lecture 3/BDA chapters 2-3 content.\nThe exercises constitute 90% of the Quiz 3 grade.\nWe prepared a quarto notebook specific to this assignment to help you get started. You still need to fill in your answers on Mycourses! You can inspect this and future templates\n\nas a qmd file,\nas a rendered html file\n\n\n\n\n\n\n\nGeneral Instructions for Answering the Assignment Questions\n\n\n\n\n\n\nQuestions below are exact copies of the text found in the MyCourses quiz and should serve as a notebook where you can store notes and code.\nWe recommend opening these notebooks in the Aalto JupyterHub, see how to use R and RStudio remotely.\nFor inspiration for code, have a look at the BDA R Demos and the specific Assignment code notebooks\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page. These will help to gain deeper understanding of the topic.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in MyCourses.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet.\nDo not share your answers publicly.\nDo not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year.\nUse of AI is allowed on the course, but the most of the work needs to by the student, and you need to report whether you used AI and in which way you used them (See points 5 and 6 in Aalto guidelines for use of AI in teaching).\nAll suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\nFor convenience the assignment questions are copied below. Answer the questions in MyCourses.\n\nA factory has a production line for manufacturing car windshields. A sample of windshields has been taken for testing hardness. The observed hardness values \\( y_1 \\) can be found in the dataset windshieldy1 in the aaltobda package.We may assume that the observations follow a normal distribution with an unknown standard deviation \\( \\sigma \\). We wish to obtain information about the unknown average hardness \\( \\mu \\). For simplicity we assume standard uninformative prior discussed in the book, that is, \\( p(\\mu, \\sigma^2) \\propto (\\sigma^2)^{-1} \\). It is not necessary to derive the posterior distribution in this quiz, as it has already been done in the book (see section 3.2). As in the lecture, define \\(n\\) as the number of observations, \\(\\bar{y} \\) as the arithmatic mean estimate and \\(s^2 = \\frac{1}{n-1}\\sum^n_{i=1} (y_i-\\bar{y})^2\\).1.1 The likelihood \\( p(y|\\mu,\\sigma) \\) can be expressed as: 1.2 The resulting joint posterior for \\(\\mu\\) and \\(\\sigma^2\\) may be expressed as: 1.3 The resulting marginal posterior for \\(\\mu \\) may be expressed as: 1.4 The resulting marginal posterior for \\(\\sigma^2 \\) may be expressed as: What can you say about the unknown \\( \\mu \\)?1.5 Compute and report the point estimate \\( E(\\mu|y) \\) (report your answer with 3 decimal digits): 1.6 Compute and report the central 95% posterior interval (report your answer with 3 decimal digits). R does not have a built in quantile function for t-distributions with non-zero mean and scale different from 1. The code template gives instructions how you can make your own function:  NB: Posterior intervals are also called credible intervals and are different from confidence intervals. 1.7 Using the code in the template, what can you say about the joint posterior of \\(\\mu,\\sigma\\)? What can you say about the hardness of the next windshield coming from the production line before actually measuring the hardness?1.7 Compute and report the point estimate \\(E(\\tilde{y}|y)\\)(report your answer with 3 decimal digits) :  1.8 Compute and report a posterior predictive 95%-interval (report your answer with 3 decimal digits):  NB: Posterior predictive intervals are different from posterior intervals of parameters of the model.\n\n\nAn experiment was performed to estimate the effect of beta-blockers on mortality of cardiac patients. A group of patients was randomly assigned to treatment and control groups: out of 674 patients receiving the control, 39 died, and out of 680 receiving the treatment, 22 died. Assume that the outcomes are independent and binomially distributed, with probabilities of death of \\( p_0 \\) and \\( p_1 \\) under the control and treatment, respectively. Set up a noninformative or weakly informative prior distribution on \\( (p_0,p_1) \\). In the below, n refers to the number of trials, y to the number of successes and \\(\\theta\\) to the probability within a binomial model.Formulate model below.2.1 Take \\(y_C\\) as the number of deaths in the control group and \\(y_T\\) as the number of deaths in the treatment group. The data model can be written as: 2.2 In the context of the data and model, the prior:  2.3 The resulting posterior with independent \\(Beta(1,1) \\) priors for \\(p_1\\) and \\(p_2\\) can be expressed as: Using the \\(Beta(1,1)\\) prior for \\(p_0\\) and \\(p_1\\) independently, summarize the posterior distribution for the odds ratio, \\( \\mathrm{OR} = (p_1/(1-p_1))/(p_0/(1-p_0)) \\). With this (and any Beta prior), a the posteriors for \\((p_0,p_1)\\) are also Beta distributions, respectively (see equations in the book). First, use rbeta() to obtain posterior draws for the posterior distributions of \\(p_0\\) and \\(p_1\\). Then use these draws and odds ratio equation above to get the posterior of the odds ratio. This is called a push-forward distribution.  Obtain at least 1000 draws. If you are unsure how to get started, check out the code template.2.4 Compute a point estimate for \\(E(\\mathrm{OR}|y_0,y_1)\\).Report the result in decimals with two decimal digits:   2.5 Compute an estimate for the posterior 95% central interval. Report the result in decimal with three decimal digits:  2.6 Now use what might be deemed a weakly informative \\(Beta(2,2)\\) prior on both probabilities \\(p_0\\) and \\(p_1\\) and discuss the sensitivity of your inference to your choice of prior density: \n2.7 Use Frank Harrell's recommendations on how to state results in Bayesian two group comparison: \n\n\nConsider a case where the same factory has two production lines for manufacturing car windshields. Independent samples from the two production lines were tested for hardness. The hardness measurements for the two samples \\( \\mathbf{y}_1 \\) and \\( \\mathbf{y}_2 \\) be found in  the datasets windshieldy1 and windshieldy2 in the aaltobda package and in this exercise we will model the measurements with two independent normal distributions respectively.For the model, we assume that standard deviations \\(\\sigma_1\\) and \\(\\sigma_2\\) of the normal models are unknown. Let \\(\\bar{y_1}\\) and \\(\\bar{y_2}\\) denote averages for  \\( \\mathbf{y}_1 \\) and \\( \\mathbf{y}_2 \\), respectively and \\(s_1^2\\), \\(s_2^2\\) denote corresponding sample standard deviations for  \\( \\mathbf{y}_1 \\) and \\( \\mathbf{y}_2 \\), computed in a same manner as in exercise 1. Also, \\(n\\) denotes number of samples in each dataset(same number for both). Use the uninformative prior and answer the following questions:3.1 The data model may be expressed as: 3.2 The prior can be expressed as: \n3.3 The resulting marginal posterior for \\(\\mu_1\\) can be expressed as: \n3.4 The resulting joint posterior for \\((\\mu_1,{\\sigma_1}^2)\\) can be expressed as: \n3.5 The resulting joint posterior for \\((\\mu_2,{\\sigma_2}^2)\\) can be expressed as: \nWhat can you say about \\( \\mu_d = \\mu_1 - \\mu_2 \\)?You can use the rtnew() function to sample from the posterior distributions of \\(\\mu_1\\) and \\(\\mu_2\\), and use these samples to get a sample from the distribution of the difference \\(\\mu_d = \\mu_1 - \\mu_2\\). Draw at least 10000 samples.3.6 Compute the point estimate \\( E(\\mu_d|y_1, y_2) \\). Report the result in decimals with three decimal digits: \n3.7 Compute a posterior 95%-interval. Report the result in decimals with three decimal digits: 3.8 Given this specific model, what is the probability that the means are exactly the same (\\(\\mu_1 = \\mu_2\\)) (Use Frank Harrell's recommendations)? Explain your reasoning. \n3.9 Compute the probability that \\(\\mu_1 &lt; \\mu_2\\) (same as the probability that \\(\\mu_1 - \\mu_2 &lt; 0\\)). Report the result in decimals with two decimal digits:",
    "crumbs": [
      "Assignments",
      "Assignment 3"
    ]
  },
  {
    "objectID": "assignment3.html#assignment-questions",
    "href": "assignment3.html#assignment-questions",
    "title": "Assignment 3",
    "section": "",
    "text": "For convenience the assignment questions are copied below. Answer the questions in MyCourses.\n\nA factory has a production line for manufacturing car windshields. A sample of windshields has been taken for testing hardness. The observed hardness values \\( y_1 \\) can be found in the dataset windshieldy1 in the aaltobda package.We may assume that the observations follow a normal distribution with an unknown standard deviation \\( \\sigma \\). We wish to obtain information about the unknown average hardness \\( \\mu \\). For simplicity we assume standard uninformative prior discussed in the book, that is, \\( p(\\mu, \\sigma^2) \\propto (\\sigma^2)^{-1} \\). It is not necessary to derive the posterior distribution in this quiz, as it has already been done in the book (see section 3.2). As in the lecture, define \\(n\\) as the number of observations, \\(\\bar{y} \\) as the arithmatic mean estimate and \\(s^2 = \\frac{1}{n-1}\\sum^n_{i=1} (y_i-\\bar{y})^2\\).1.1 The likelihood \\( p(y|\\mu,\\sigma) \\) can be expressed as: 1.2 The resulting joint posterior for \\(\\mu\\) and \\(\\sigma^2\\) may be expressed as: 1.3 The resulting marginal posterior for \\(\\mu \\) may be expressed as: 1.4 The resulting marginal posterior for \\(\\sigma^2 \\) may be expressed as: What can you say about the unknown \\( \\mu \\)?1.5 Compute and report the point estimate \\( E(\\mu|y) \\) (report your answer with 3 decimal digits): 1.6 Compute and report the central 95% posterior interval (report your answer with 3 decimal digits). R does not have a built in quantile function for t-distributions with non-zero mean and scale different from 1. The code template gives instructions how you can make your own function:  NB: Posterior intervals are also called credible intervals and are different from confidence intervals. 1.7 Using the code in the template, what can you say about the joint posterior of \\(\\mu,\\sigma\\)? What can you say about the hardness of the next windshield coming from the production line before actually measuring the hardness?1.7 Compute and report the point estimate \\(E(\\tilde{y}|y)\\)(report your answer with 3 decimal digits) :  1.8 Compute and report a posterior predictive 95%-interval (report your answer with 3 decimal digits):  NB: Posterior predictive intervals are different from posterior intervals of parameters of the model.\n\n\nAn experiment was performed to estimate the effect of beta-blockers on mortality of cardiac patients. A group of patients was randomly assigned to treatment and control groups: out of 674 patients receiving the control, 39 died, and out of 680 receiving the treatment, 22 died. Assume that the outcomes are independent and binomially distributed, with probabilities of death of \\( p_0 \\) and \\( p_1 \\) under the control and treatment, respectively. Set up a noninformative or weakly informative prior distribution on \\( (p_0,p_1) \\). In the below, n refers to the number of trials, y to the number of successes and \\(\\theta\\) to the probability within a binomial model.Formulate model below.2.1 Take \\(y_C\\) as the number of deaths in the control group and \\(y_T\\) as the number of deaths in the treatment group. The data model can be written as: 2.2 In the context of the data and model, the prior:  2.3 The resulting posterior with independent \\(Beta(1,1) \\) priors for \\(p_1\\) and \\(p_2\\) can be expressed as: Using the \\(Beta(1,1)\\) prior for \\(p_0\\) and \\(p_1\\) independently, summarize the posterior distribution for the odds ratio, \\( \\mathrm{OR} = (p_1/(1-p_1))/(p_0/(1-p_0)) \\). With this (and any Beta prior), a the posteriors for \\((p_0,p_1)\\) are also Beta distributions, respectively (see equations in the book). First, use rbeta() to obtain posterior draws for the posterior distributions of \\(p_0\\) and \\(p_1\\). Then use these draws and odds ratio equation above to get the posterior of the odds ratio. This is called a push-forward distribution.  Obtain at least 1000 draws. If you are unsure how to get started, check out the code template.2.4 Compute a point estimate for \\(E(\\mathrm{OR}|y_0,y_1)\\).Report the result in decimals with two decimal digits:   2.5 Compute an estimate for the posterior 95% central interval. Report the result in decimal with three decimal digits:  2.6 Now use what might be deemed a weakly informative \\(Beta(2,2)\\) prior on both probabilities \\(p_0\\) and \\(p_1\\) and discuss the sensitivity of your inference to your choice of prior density: \n2.7 Use Frank Harrell's recommendations on how to state results in Bayesian two group comparison: \n\n\nConsider a case where the same factory has two production lines for manufacturing car windshields. Independent samples from the two production lines were tested for hardness. The hardness measurements for the two samples \\( \\mathbf{y}_1 \\) and \\( \\mathbf{y}_2 \\) be found in  the datasets windshieldy1 and windshieldy2 in the aaltobda package and in this exercise we will model the measurements with two independent normal distributions respectively.For the model, we assume that standard deviations \\(\\sigma_1\\) and \\(\\sigma_2\\) of the normal models are unknown. Let \\(\\bar{y_1}\\) and \\(\\bar{y_2}\\) denote averages for  \\( \\mathbf{y}_1 \\) and \\( \\mathbf{y}_2 \\), respectively and \\(s_1^2\\), \\(s_2^2\\) denote corresponding sample standard deviations for  \\( \\mathbf{y}_1 \\) and \\( \\mathbf{y}_2 \\), computed in a same manner as in exercise 1. Also, \\(n\\) denotes number of samples in each dataset(same number for both). Use the uninformative prior and answer the following questions:3.1 The data model may be expressed as: 3.2 The prior can be expressed as: \n3.3 The resulting marginal posterior for \\(\\mu_1\\) can be expressed as: \n3.4 The resulting joint posterior for \\((\\mu_1,{\\sigma_1}^2)\\) can be expressed as: \n3.5 The resulting joint posterior for \\((\\mu_2,{\\sigma_2}^2)\\) can be expressed as: \nWhat can you say about \\( \\mu_d = \\mu_1 - \\mu_2 \\)?You can use the rtnew() function to sample from the posterior distributions of \\(\\mu_1\\) and \\(\\mu_2\\), and use these samples to get a sample from the distribution of the difference \\(\\mu_d = \\mu_1 - \\mu_2\\). Draw at least 10000 samples.3.6 Compute the point estimate \\( E(\\mu_d|y_1, y_2) \\). Report the result in decimals with three decimal digits: \n3.7 Compute a posterior 95%-interval. Report the result in decimals with three decimal digits: 3.8 Given this specific model, what is the probability that the means are exactly the same (\\(\\mu_1 = \\mu_2\\)) (Use Frank Harrell's recommendations)? Explain your reasoning. \n3.9 Compute the probability that \\(\\mu_1 &lt; \\mu_2\\) (same as the probability that \\(\\mu_1 - \\mu_2 &lt; 0\\)). Report the result in decimals with two decimal digits:",
    "crumbs": [
      "Assignments",
      "Assignment 3"
    ]
  },
  {
    "objectID": "template7.html",
    "href": "template7.html",
    "title": "Notebook for Assignment 7",
    "section": "",
    "text": "1 General information\nThis notebook will be published later!",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 7"
    ]
  },
  {
    "objectID": "template4.html",
    "href": "template4.html",
    "title": "Notebook for Assignment 4",
    "section": "",
    "text": "1 General information\nThis notebook will be published later!",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 4"
    ]
  },
  {
    "objectID": "assignment6.html",
    "href": "assignment6.html",
    "title": "Assignment 6",
    "section": "",
    "text": "1 General information\nThis assignment will be published later!",
    "crumbs": [
      "Assignments",
      "Assignment 6"
    ]
  },
  {
    "objectID": "assignment8.html",
    "href": "assignment8.html",
    "title": "Assignment 8",
    "section": "",
    "text": "1 General information\nThis assignment will be published later!",
    "crumbs": [
      "Assignments",
      "Assignment 8"
    ]
  },
  {
    "objectID": "assignment7.html",
    "href": "assignment7.html",
    "title": "Assignment 7",
    "section": "",
    "text": "1 General information\nThis assignment will be published later!",
    "crumbs": [
      "Assignments",
      "Assignment 7"
    ]
  },
  {
    "objectID": "template9.html",
    "href": "template9.html",
    "title": "Notebook for Assignment 9",
    "section": "",
    "text": "1 General information\nThis notebook will be published later!",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 9"
    ]
  },
  {
    "objectID": "template1.html",
    "href": "template1.html",
    "title": "Notebook for Assignment 1",
    "section": "",
    "text": "1 General information\nThe exercises here refer to the lecture 1/BDA chapter 1 content, not the course infrastructure quiz. This assignment is meant to test whether or not you have sufficient knowledge to participate in the course. The first question checks that you remember basic terms of probability calculus. The second exercise checks you recognise the most important notation used throughout the course and used in BDA3. The third-fifth exercise you will solve some basic Bayes theorem questions to check your understanding on the basics of probability theory. The 6th exercise checks on whether you recall the three steps of Bayesian Data Ananlysis as mentioned in chapter 1 of BDA3. The last exercise walks you through an example of how we can use models to generate distributions for outcomes of interest, applied to a setting of a simplified Roulette table.\nThis quarto document is not intended to be submitted, but to render the questions as they appear on Mycourses to be available also outside of it. The following will set-up markmyassignment to check your functions at the end of the notebook:\n\nlibrary(markmyassignment)\nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/tests/assignment1.yml\", sep=\"\")\nset_assignment(assignment_path)\n\nAssignment set:\nassignment1: Bayesian Data Analysis: Assignment 1\nThe assignment contain the following (3) tasks:\n- p_red\n- p_box\n- p_identical_twin\n\n\n\n\n2 1. Basic probability theory notation and terms\n\n\n3 2. Notation\n\n\n4 3. Bayes’ theorem 1\nIf you use pen and paper, it may help to draw pictures as follows (see also assignment_instructions#fig-workflow):\n\n\n\n\n\n\nFigure 1: Parts of Bayesian workflow\n\n\n\nSee Figure 1 for illustration of parts of Bayesian workflow.\n\n\n5 4. Bayes’ theorem 2\nThe following will help you implementing a function to calculate the required probabilities for this exercise. Keep the below name and format for the function to work with markmyassignment:\n\nboxes_test &lt;- matrix(c(2,2,1,5,5,1), ncol = 2,\n    dimnames = list(c(\"A\", \"B\", \"C\"), c(\"red\", \"white\")))\n\np_red &lt;- function(boxes) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    0.3928571\n}\n\np_box &lt;- function(boxes) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.29090909,0.07272727,0.63636364)\n}\n\n\n\n6 5. Bayes’ theorem 3\nThe R functions below might help you calculating the requited probabilities.\n\nfraternal_prob = 1/125\nidentical_prob = 1/300\n\nKeep the below name and format for the function to work with markmyassignment:\n\np_identical_twin &lt;- function(fraternal_prob, identical_prob) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    0.4545455\n}\n\n\n\n7 6. The three steps of Bayesian data analysis\n\n\n8 7. A Binomial Model for the Roulette Table\nIncomplete code can be found below.\n\n# Ratio of red/black\ntheta &lt;- # declare probability parameter for the binomial model\n\n# Sequence of trials\n\ntrials &lt;- seq(#start value of sequence,#end value of sequence,#value for spacing)\n\n# Number of simulation draws from the model\nnsims &lt;- # number of of simulations from the binomial model\n\n# Helper function for getting the ratios\nbinom_gen &lt;- function(trials,theta,nsims){\n    df &lt;-  as.data.frame(rbinom(nsims,trials,theta)/trials) |&gt; mutate(nsims = nsims,trials = trials)\n    colnames(df) &lt;- c(\"Ratios\",\"Nsims\",\"Trials\")\n  return(df)\n}\n\n# Create a data frame containing the draws for each number of trials\nratio_60 &lt;- do.call(rbind, lapply(trials, binom_gen, theta, nsims)) # lapply applies elements in trials column to binom_gen function, which is then rowbound via do.call\n\nNow plot a histogram of the computed ratios for 10, 50 and 1000 trials, using the code below\n\n# Plot the Distributions\nsubset_df60 &lt;- ratio_60[ratio_60$Trials %in% c(#trial values), ] # Subset your dataframe\n\nsubset_df60 |&gt; ggplot(aes(Ratios)) +\n  geom_histogram(position = \"identity\" ,bins = 40) +\n  facet_grid(cols = vars(Trials))  +\n  ggtitle(\"Ratios for specific trials\")\n\nSuppose you are now certain that theta = 0.6, plot the probability density given 1000 trials using the code below.\n\nsize =  # number of trials\nprob =  # probability of success\n\nbinom_data &lt;- data.frame(\n  Success = 0:size,\n  Probability = dbinom(0:size, size = size, prob = prob)\n)\n\nggplot(binom_data, aes(x = Success, y = Probability)) +\n  geom_point() +\n  geom_line() +\n  labs(title = \"PMF of Binomial Distribution\", x = \"Number of Successes\", y = \"PDF\")\n\n\n\n\n\n\n\nmarkmyassignment\n\n\n\n\n\nThe following will check the functions for which markmyassignment has been set up:\n\nmark_my_assignment()\n\n✔ | F W  S  OK | Context\n\n⠏ |          0 | task-1-subtask-1-tests                                         \n⠏ |          0 | p_red()                                                        \n✖ | 1        3 | p_red()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:21:3'): p_red()\np_red(boxes = boxes) not equivalent to 0.5.\n1/1 mismatches\n[1] 0.393 - 0.5 == -0.107\nError: Incorrect result for matrix(c(1,1,1,1,1,1), ncol = 2)\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |          0 | task-2-subtask-1-tests                                         \n⠏ |          0 | p_box()                                                        \n✖ | 1        3 | p_box()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-2-subtask-1-tests.R:19:3'): p_box()\np_box(boxes = boxes) not equivalent to c(0.4, 0.1, 0.5).\n3/3 mismatches (average diff: 0.0909)\n[1] 0.2909 - 0.4 == -0.1091\n[2] 0.0727 - 0.1 == -0.0273\n[3] 0.6364 - 0.5 ==  0.1364\nError: Incorrect result for matrix(c(1,1,1,1,1,1), ncol = 2)\n────────────────────────────────────────────────────────────────────────────────\n\n⠏ |          0 | task-3-subtask-1-tests                                         \n⠏ |          0 | p_identical_twin()                                             \n✖ | 2        3 | p_identical_twin()\n────────────────────────────────────────────────────────────────────────────────\nFailure ('test-task-3-subtask-1-tests.R:16:3'): p_identical_twin()\np_identical_twin(fraternal_prob = 1/100, identical_prob = 1/500) not equivalent to 0.2857143.\n1/1 mismatches\n[1] 0.455 - 0.286 == 0.169\nError: Incorrect result for fraternal_prob = 1/100 and identical_prob = 1/500\n\nFailure ('test-task-3-subtask-1-tests.R:19:3'): p_identical_twin()\np_identical_twin(fraternal_prob = 1/10, identical_prob = 1/20) not equivalent to 0.5.\n1/1 mismatches\n[1] 0.455 - 0.5 == -0.0455\nError: Incorrect result for fraternal_prob = 1/10 and identical_prob = 1/20\n────────────────────────────────────────────────────────────────────────────────\n\n══ Results ═════════════════════════════════════════════════════════════════════\n── Failed tests ────────────────────────────────────────────────────────────────\nFailure ('test-task-1-subtask-1-tests.R:21:3'): p_red()\np_red(boxes = boxes) not equivalent to 0.5.\n1/1 mismatches\n[1] 0.393 - 0.5 == -0.107\nError: Incorrect result for matrix(c(1,1,1,1,1,1), ncol = 2)\n\nFailure ('test-task-2-subtask-1-tests.R:19:3'): p_box()\np_box(boxes = boxes) not equivalent to c(0.4, 0.1, 0.5).\n3/3 mismatches (average diff: 0.0909)\n[1] 0.2909 - 0.4 == -0.1091\n[2] 0.0727 - 0.1 == -0.0273\n[3] 0.6364 - 0.5 ==  0.1364\nError: Incorrect result for matrix(c(1,1,1,1,1,1), ncol = 2)\n\nFailure ('test-task-3-subtask-1-tests.R:16:3'): p_identical_twin()\np_identical_twin(fraternal_prob = 1/100, identical_prob = 1/500) not equivalent to 0.2857143.\n1/1 mismatches\n[1] 0.455 - 0.286 == 0.169\nError: Incorrect result for fraternal_prob = 1/100 and identical_prob = 1/500\n\nFailure ('test-task-3-subtask-1-tests.R:19:3'): p_identical_twin()\np_identical_twin(fraternal_prob = 1/10, identical_prob = 1/20) not equivalent to 0.5.\n1/1 mismatches\n[1] 0.455 - 0.5 == -0.0455\nError: Incorrect result for fraternal_prob = 1/10 and identical_prob = 1/20\n\n[ FAIL 4 | WARN 0 | SKIP 0 | PASS 9 ]",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 1"
    ]
  },
  {
    "objectID": "assignment2.html",
    "href": "assignment2.html",
    "title": "Assignment 2",
    "section": "",
    "text": "The exercises here refer to the lecture 2/BDA chapters 1-2 content. All questions check your understanding of a simple posterior analysis using a binomial model for the observations and a beta prior.\nThe exercises constitute 90% of the Quiz 2 grade.\nWe prepared a quarto notebook specific to this assignment to help you get started. You still need to fill in your answers on Mycourses! You can inspect this and future templates\n\nas a qmd file,\nas a rendered html file\n\n\n\n\n\n\n\nGeneral Instructions for Answering the Assignment Questions\n\n\n\n\n\n\nQuestions below are exact copies of the text found in the MyCourses quiz and should serve as a notebook where you can store notes and code.\nWe recommend opening these notebooks in the Aalto JupyterHub, see how to use R and RStudio remotely.\nFor inspiration for code, have a look at the BDA R Demos and the specific Assignment code notebooks\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page. These will help to gain deeper understanding of the topic.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in MyCourses.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet.\nDo not share your answers publicly.\nDo not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year.\nUse of AI is allowed on the course, but the most of the work needs to by the student, and you need to report whether you used AI and in which way you used them (See points 5 and 6 in Aalto guidelines for use of AI in teaching).\nAll suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\nFor convenience the assignment questions are copied below. Answer the questions in MyCourses.\n\n\n\nAlgae\n    status is monitored in 274 sites at Finnish lakes and rivers. The\n    observations for the 2008 algae status at each site are presented in the\n    dataset algae in the aaltobda package ('0': no algae, '1': algae\n    present).\nLet \\( \\theta \\) be the probability of a monitoring site having\n    detectable blue-green algae levels, \\( y \\) the number of observed sites with algae detected, and \\( n \\) be total number sites surveyed.\n    Use a binomial model for the observations and a \\( \\text{Beta}(2,10) \\) prior for binomial model parameter \\( \\theta \\) to formulate a Bayesian model.\n    Here we will not test you on the individual mathematical operations needed in order to derive the posterior distribution for \\( \\theta \\) as it has already been done in the book (and lecture) so make sure to look that up.\nYour task is to perform Bayesian\n    inference for a binomial model and fill in the quiz below based on it. \nFor questions with checkboxes, more than one answer may be\n    correct.\n\nThe algae dataset contains the results of 274 measurements from Finnish lakes, with the following results:\n\n    No Algae: 230 sites\n    Algae: 44 sites\n\nOur goal for the following set of questions is to find the formulation of the posterior using a binomial likeliood and a beta prior on the unknown probability parameter \\( \\theta \\)\n\n\n    1.1 The prior \\(p(\\theta)\\) can be expressed as: \n\n\n    1.2 The likelihood \\( p(y = 44 | \\theta, n = 274) \\) as a function of \\( \\theta \\) can be expressed as: \n\n\n\n\n    1.3 The resulting posterior \\( p(\\theta|y = 44, n = 274) \\) can be expressed as : \n\n\n\n\nThe posterior distribution \\( p(\\theta|y) \\) is analytically available as \\( \\text{Beta}(\\alpha, \\beta) \\), so we can use the properties of that distribution to summarise what we know about \\( \\theta \\).  And in particular, we can make probability statements about ranges of values for \\( \\theta \\). Let's however start with the average value of \\( \\theta \\) you expect after having conditioned on the data. \n\n    2.1 Which of the following is the correct formula for the mean (\\( E[\\cdot] \\)) of a \\( \\text{Beta}(\\alpha, \\beta) \\) distribution: \n\n\n    2.2 Using your answer above, what is the mean of our posterior (i.e.,  \\( E(\\theta|y) \\))? Report the result in decimals with two decimal digits. \n\n\nPosterior intervals are sometimes called credible intervals and are different from confidence intervals (for more on this, see here). These are computed using the quantile function of the posterior distribution. As the quantiles of a \\( \\text{Beta}(\\alpha, \\beta) \\) distribution do not have a simple analytical form like the expectation, you can use R to compute the posterior intervals.\n\n\n    2.3 What R function would you use here to compute posterior intervals? \n\nUsing your answer above, calculate (report the results in decimals with two decimal digits): \n\n\n\n    2.4 90% posterior interval lower bound: \n\n\n    2.5 90% posterior interval upper bound: \n\nWe are interested in using our posterior distribution to estimate the probability that the proportion of detected algae samples (\\( \\theta \\)) is smaller than the historical detection rate \\( \\theta_0 = 0.2 \\), i.e. \\( p(\\theta \\leq \\theta_0 \\mid y) \\). \n\n    3.1 Which of the following approaches would we take? \n\n\n    3.2 What statistical function computes this probability for us? \n\n\n    3.3 Which R function does this for you? \n\n\n    3.4 Using your answers above, report this probability (report the result in decimals with two decimal digits): \n\n\n\nRedo the analysis using a uniform prior, \\( \\text{Beta}( 1,1 \\)). \n\n    4.1 What is the mean of our posterior (i.e.,  \\( E(\\theta|y) \\))? Report the result in decimals with two decimal digits. \n    4.2 90% posterior interval lower bound. Report the result in decimals with two decimal digits. \n    4.3 90% posterior interval upper bound. Report the result in decimals with two decimal digits. \n    4.4 Probability \\( p(\\theta \\leq \\theta_0 \\mid y) \\). Report the result in decimals with two decimal digits. \n\nRedo the analysis using as prior \\( \\text{Beta}(0.5,0.5) \\).\n\n\n    4.5 What is the mean of our posterior (i.e.,  \\( E(\\theta|y) \\))? Report the result in decimals with two decimal digits. \n    4.6 90% posterior interval lower bound. Report the result in decimals with two decimal digits. \n    4.7 90% posterior interval upper bound. Report the result in decimals with two decimal digits. \n    4.8 Probability \\( p(\\theta \\leq \\theta_0 \\mid y) \\). Report the result in decimals with two decimal digits. \n\n\nRedo the analysis using as prior \\( \\text{Beta}(100,2) \\).\n\n\n    4.9 What is the mean of our posterior (i.e.,  \\( E(\\theta|y) \\))? Report the result in decimals with two decimal digits. \n    4.10 90% posterior interval lower bound. Report the result in decimals with two decimal digits. \n    4.11 90% posterior interval upper bound. Report the result in decimals with two decimal digits. \n    4.12 Probability \\( p(\\theta \\leq \\theta_0 \\mid y) \\). Report the result in decimals with two decimal digits. \n\n4.13 Based on testing different priors, would you consider the posterior results believe and defensible (w.r.t. to this data set). In order to help your reasoning you can plot the prior and posteriors used with the code template for Assignment 2?",
    "crumbs": [
      "Assignments",
      "Assignment 2"
    ]
  },
  {
    "objectID": "assignment2.html#assignment-questions",
    "href": "assignment2.html#assignment-questions",
    "title": "Assignment 2",
    "section": "",
    "text": "For convenience the assignment questions are copied below. Answer the questions in MyCourses.\n\n\n\nAlgae\n    status is monitored in 274 sites at Finnish lakes and rivers. The\n    observations for the 2008 algae status at each site are presented in the\n    dataset algae in the aaltobda package ('0': no algae, '1': algae\n    present).\nLet \\( \\theta \\) be the probability of a monitoring site having\n    detectable blue-green algae levels, \\( y \\) the number of observed sites with algae detected, and \\( n \\) be total number sites surveyed.\n    Use a binomial model for the observations and a \\( \\text{Beta}(2,10) \\) prior for binomial model parameter \\( \\theta \\) to formulate a Bayesian model.\n    Here we will not test you on the individual mathematical operations needed in order to derive the posterior distribution for \\( \\theta \\) as it has already been done in the book (and lecture) so make sure to look that up.\nYour task is to perform Bayesian\n    inference for a binomial model and fill in the quiz below based on it. \nFor questions with checkboxes, more than one answer may be\n    correct.\n\nThe algae dataset contains the results of 274 measurements from Finnish lakes, with the following results:\n\n    No Algae: 230 sites\n    Algae: 44 sites\n\nOur goal for the following set of questions is to find the formulation of the posterior using a binomial likeliood and a beta prior on the unknown probability parameter \\( \\theta \\)\n\n\n    1.1 The prior \\(p(\\theta)\\) can be expressed as: \n\n\n    1.2 The likelihood \\( p(y = 44 | \\theta, n = 274) \\) as a function of \\( \\theta \\) can be expressed as: \n\n\n\n\n    1.3 The resulting posterior \\( p(\\theta|y = 44, n = 274) \\) can be expressed as : \n\n\n\n\nThe posterior distribution \\( p(\\theta|y) \\) is analytically available as \\( \\text{Beta}(\\alpha, \\beta) \\), so we can use the properties of that distribution to summarise what we know about \\( \\theta \\).  And in particular, we can make probability statements about ranges of values for \\( \\theta \\). Let's however start with the average value of \\( \\theta \\) you expect after having conditioned on the data. \n\n    2.1 Which of the following is the correct formula for the mean (\\( E[\\cdot] \\)) of a \\( \\text{Beta}(\\alpha, \\beta) \\) distribution: \n\n\n    2.2 Using your answer above, what is the mean of our posterior (i.e.,  \\( E(\\theta|y) \\))? Report the result in decimals with two decimal digits. \n\n\nPosterior intervals are sometimes called credible intervals and are different from confidence intervals (for more on this, see here). These are computed using the quantile function of the posterior distribution. As the quantiles of a \\( \\text{Beta}(\\alpha, \\beta) \\) distribution do not have a simple analytical form like the expectation, you can use R to compute the posterior intervals.\n\n\n    2.3 What R function would you use here to compute posterior intervals? \n\nUsing your answer above, calculate (report the results in decimals with two decimal digits): \n\n\n\n    2.4 90% posterior interval lower bound: \n\n\n    2.5 90% posterior interval upper bound: \n\nWe are interested in using our posterior distribution to estimate the probability that the proportion of detected algae samples (\\( \\theta \\)) is smaller than the historical detection rate \\( \\theta_0 = 0.2 \\), i.e. \\( p(\\theta \\leq \\theta_0 \\mid y) \\). \n\n    3.1 Which of the following approaches would we take? \n\n\n    3.2 What statistical function computes this probability for us? \n\n\n    3.3 Which R function does this for you? \n\n\n    3.4 Using your answers above, report this probability (report the result in decimals with two decimal digits): \n\n\n\nRedo the analysis using a uniform prior, \\( \\text{Beta}( 1,1 \\)). \n\n    4.1 What is the mean of our posterior (i.e.,  \\( E(\\theta|y) \\))? Report the result in decimals with two decimal digits. \n    4.2 90% posterior interval lower bound. Report the result in decimals with two decimal digits. \n    4.3 90% posterior interval upper bound. Report the result in decimals with two decimal digits. \n    4.4 Probability \\( p(\\theta \\leq \\theta_0 \\mid y) \\). Report the result in decimals with two decimal digits. \n\nRedo the analysis using as prior \\( \\text{Beta}(0.5,0.5) \\).\n\n\n    4.5 What is the mean of our posterior (i.e.,  \\( E(\\theta|y) \\))? Report the result in decimals with two decimal digits. \n    4.6 90% posterior interval lower bound. Report the result in decimals with two decimal digits. \n    4.7 90% posterior interval upper bound. Report the result in decimals with two decimal digits. \n    4.8 Probability \\( p(\\theta \\leq \\theta_0 \\mid y) \\). Report the result in decimals with two decimal digits. \n\n\nRedo the analysis using as prior \\( \\text{Beta}(100,2) \\).\n\n\n    4.9 What is the mean of our posterior (i.e.,  \\( E(\\theta|y) \\))? Report the result in decimals with two decimal digits. \n    4.10 90% posterior interval lower bound. Report the result in decimals with two decimal digits. \n    4.11 90% posterior interval upper bound. Report the result in decimals with two decimal digits. \n    4.12 Probability \\( p(\\theta \\leq \\theta_0 \\mid y) \\). Report the result in decimals with two decimal digits. \n\n4.13 Based on testing different priors, would you consider the posterior results believe and defensible (w.r.t. to this data set). In order to help your reasoning you can plot the prior and posteriors used with the code template for Assignment 2?",
    "crumbs": [
      "Assignments",
      "Assignment 2"
    ]
  },
  {
    "objectID": "assignment9.html",
    "href": "assignment9.html",
    "title": "Assignment 9",
    "section": "",
    "text": "1 General information\nThis assignment will be published later!",
    "crumbs": [
      "Assignments",
      "Assignment 9"
    ]
  },
  {
    "objectID": "template8.html",
    "href": "template8.html",
    "title": "Notebook for Assignment 8",
    "section": "",
    "text": "1 General information\nThis notebook will be published later!",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 8"
    ]
  },
  {
    "objectID": "template5.html",
    "href": "template5.html",
    "title": "Notebook for Assignment 5",
    "section": "",
    "text": "1 General information\nThis notebook will be published later!",
    "crumbs": [
      "Templates",
      "Notebook for Assignment 5"
    ]
  },
  {
    "objectID": "assignment1.html",
    "href": "assignment1.html",
    "title": "Assignment 1",
    "section": "",
    "text": "The exercises here refer to the lecture 1/BDA chapter 1 content, not the course infrastructure quiz. This assignment is meant to test whether or not you have sufficient knowledge to participate in the course. The first question checks that you remember basic terms of probability calculus. The second exercise checks you recognise the most important notation used throughout the course and used in BDA3. The third-fifth exercise you will solve some basic Bayes theorem questions to check your understanding on the basics of probability theory. The 6th exercise checks on whether you recall the three steps of Bayesian Data Ananlysis as mentioned in chapter 1 of BDA3. The last exercise walks you through an example of how we can use models to generate distributions for outcomes of interest, applied to a setting of a simplified Roulette table.\nThe exercises constitute 80% of the Quiz 1 grade.\nWe prepared a quarto notebook specific to this assignment to help you get started. You still need to fill in your answers on Mycourses! You can inspect this and future templates\n\nas a qmd file,\nas a rendered html file\n\n\n\n\n\n\n\nGeneral Instructions for Answering the Assignment Questions\n\n\n\n\n\n\nQuestions below are exact copies of the text found in the MyCourses quiz and should serve as a notebook where you can store notes and code.\nWe recommend opening these notebooks in the Aalto JupyterHub, see how to use R and RStudio remotely.\nFor inspiration for code, have a look at the BDA R Demos and the specific Assignment code notebooks\nRecommended additional self study exercises for each chapter in BDA3 are listed in the course web page. These will help to gain deeper understanding of the topic.\nCommon questions and answers regarding installation and technical problems can be found in Frequently Asked Questions (FAQ).\nDeadlines for all assignments can be found on the course web page and in MyCourses.\nYou are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet.\nDo not share your answers publicly.\nDo not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year.\nUse of AI is allowed on the course, but the most of the work needs to by the student, and you need to report whether you used AI and in which way you used them (See points 5 and 6 in Aalto guidelines for use of AI in teaching).\nAll suspected plagiarism will be reported and investigated. See more about the Aalto University Code of Academic Integrity and Handling Violations Thereof.\nIf you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!\n\n\n\n\n\n\nFor convenience the assignment questions are copied below. Answer the questions in MyCourses.\n\n\n    \n        \n        \n        \n    \n    \n\n\n        Match the following terms with the correct definition:\nNote that the answers order and set of possible answers is the same for questions 1.1 - 1.8. Check the BDA chapter 1, the lecture slides, and Wikipedia if you are uncertain about the terms below. \n\n\n\n    \n        1.1 Probability:\n            \n        1.2 Probability mass (function): \n        1.3 Probability density (function):\n        1.4 Probability distribution: \n        1.5 Discrete probability distribution: \n        1.6 Continuous probability distribution: \n        1.7 Cumulative distribution function (cdf): \n        1.8 Likelihood:\n            \n    \n    \n    \n    \n        \n            \n        \n        \n    \n    \n            Match the following notation with the correct definition: \n    \n    \n        2.1 \\( \\sim \\):  \n        2.2 \\( \\propto \\):  \n        2.3 \\( \\text{E}[\\cdot] \\):  \n        2.4 \\( p(y | \\theta) \\): \n    \n\n    \n    \n    \n    A group of researchers has designed a new inexpensive and painless test\n        for detecting lung cancer. The test is intended to be an initial\n        screening test for the population in general. A positive result\n        (presence of lung cancer) from the test would be followed up immediately\n        with medication, surgery or more extensive and expensive test. \n    The\n        researchers know from their studies the following facts:\n    \n        Test gives a positive result in 98%  of the time when the test subject has lung cancer.\n        Test gives a negative result in  96% of the time when the test subject does not have lung cancer.\n        In general population approximately one person in 1000 has lung cancer.\n    \n    Here are some probability values that can help you figure out if you\n        copied the right conditional probabilities from the question:\n    \n        P(Test gives positive | Subject does not have lung cancer) = 4%\n        P(Test gives positive and Subject has lung cancer) = 0.098%\n            \n                \n                    this is also referred to as the joint probability of test being positive and the subject having lung cancer\n                \n            \n        \n    \n    Your goal is calculate the probability of having cancer given a positive test result: \\( P(\\text{cancer} | \\text{positive}) \\)\n    \n        3.1 Which quantity in Bayes' Theorem does this represent? \n        3.2 What is the probability of the test having a positive result, given that the test subject has cancer (P(B|A))? \n        3.3 What is the probability of having cancer (P(A))? \n        3.4 What is the probability of having a positive test (P(B))? \n        3.5 Using your previous answers, what is the probability of having cancer given a positive test?\n    \n    \n    \n    \n    We have three boxes, A, B, and C. There are\n    \n        2 red balls and 5 white balls in the box A\n        4 red balls and 1 white ball in the box B\n        1 red ball and 3 white balls in the box C.\n    \n    Consider a random experiment in which one of the boxes is randomly\n        selected and from that box, one ball is randomly picked up. After\n        observing the color of the ball it is replaced in the box it came from.\n        Suppose also that on average box A is selected 40% of the time and box B\n        10% of the time (i.e. P(A) = 0.4).\n    \n    \n        4.1 What is the probability of picking a red ball from box A? \n        4.2 What is the probability of picking a red ball from box B? \n        4.3 What is the probability of picking a red ball from box C? \n        4.4 Considering the probabilities of selecting each box, what is the probability of picking a red ball (enter as a number between 0 and 1 with 2 decimal digit accuracy)?\n        \n            4.5 If a red ball was picked, calculate the probability that it was picked from (enter as a number between 0 and 1 with 2 decimal digit accuracy):\n            \n                Box A:  \n                Box B:  \n                Box C:  \n            \n        \n    \n    \n    \n    \n    \n    \n    Assume that on average fraternal twins (two fertilized eggs and then\n        could be of different sex) occur once in 150 births and identical twins\n        (single egg divides into two separate embryos, so both have the same\n        sex) once in 400 births (Note! This is not the true\n        value, see Exercise 1.6, page 28, in BDA3). Assume\n        that an equal number of boys and girls are born on average.\n    American male singer-actor\n        Elvis Presley (1935 – 1977) had a twin brother who died in birth, your\n        goal is to compute the probability that Elvis was an identical twin.\n    \n    5.1 What is the probability of having a twin brother, given identical twins (enter as a number between 0 and 1 no decimal digits needed)?\n    \n    5.2 What is the total probability of having a twin brother (either fraternal or identical)? (enter as a number between 0 and 1 with 2 decimal digit accuracy)\n    5.3 What is the probability that Elvis was an identical twin, given that he had a twin brother? (enter as a number between 0 and 1 with 2 decimal digit accuracy)\n    \n    \n    6.1 Select the three steps of Bayesian data analysis (see BDA3 p. 3): \n\n\n\n    \n    In this course, models are used to explain social and physical data, and we will be able to generate data from our models which we can use for checking how well our model does. In this example, we show how to generate outcomes from a binomial model to explain outcomes of a roulette game (there is a connection to the history of statistics). Suppose a roulette table with only red and black colours. Roulette tables won't be perfect and it's likely that the probability of red vs black is not exactly 0.5 (the tables can have adjustments that are randomized each day to avoid long term bias). \n    Suppose your model for the tables' ratio of red/black is a Binomial which takes as inputs the number of trials and a probability parameter, theta. Set theta to 0.6 (this is much bigger than what we would expect in real roulette, but makes it easier as a teaching example) and generate a series (for a sequence of 100 equally spaced trial values between 10 and 1000) of red/black ratios. Generate 1000 random draws from your model for each trial value and save the data in a Data frame with columns Ratios, Nsims and Trials. Incomplete code can be found below.\n    \n    # load the tidyverse package for data manipulation and plottinglibrary(tidyverse)# Ratio of red/black\ntheta &lt;- # declare probability parameter for the binomial model\n\n# Sequence of trials\ntrials &lt;- seq(#start value of sequence,#end value of sequence,#value for spacing)\n\n# Number of simulation draws from the model\nnsims &lt;- # number of of simulations from the binomial model\n\n# Helper function for getting the ratios\nbinom_gen &lt;- function(trials,theta,nsims){\n    df &lt;-  as.data.frame(rbinom(nsims,trials,theta)/trials) |&gt; mutate(nsims = nsims,trials = trials)\n    colnames(df) &lt;- c(\"Ratios\",\"Nsims\",\"Trials\")\n  return(df)\n}\n\n# Create a data frame containing the draws for each number of trials\nratio_60 &lt;- do.call(rbind, lapply(trials, binom_gen, theta, nsims)) # lapply applies elements in trials column to binom_gen function, which is then rowbound via do.call\n    \n    \n        7.1 Suppose you are unsure whether the code to create the data frame worked. Which of the following functions should you use in order to check on the structure of the dataframe object (assuming df below stands for a generic dataframe object)?\n        7.2 The structure checks out, but now you want to print the first 5 rows of the dataframe to check whether the values are as expected. Which of the following functions should you use?\n        7.3 The quick peek checks also out, but you would be more at ease scrolling all data, perhaps you'll find some interesting patterns. Which of the following actions allows you to scroll through the data in a separate window (for the below, we assume that you have the code loaded in an RStudio session)?\n    \n    \n    \n    \n    Now, plot a histogram of the computed ratios for 10, 50 and 1000 trials, using the code below\n    # Plot the Distributions\nsubset_df &lt;- ratio_60[ratio_60$Trials %in% c(#trial values), ] # Subset your \n\nsubset_df60 |&gt; ggplot(aes(Ratios)) +\n  geom_histogram(position = \"identity\" ,bins = 40) +\n  facet_grid(cols = vars(Trials))  +\n  ggtitle(\"Ratios for specific trials\")\n    \n    \n    \n        7.4 Which histogram below is the correct one for theta = 0.6?\n        7.5 What do these distributions refer to?\n        7.6 Given these histograms, which number of trials gives you the most certainty about the likely red/black ratio for that table?\n        7.7 Given the draws from the model, give an estimate about the probability p(Ratio&lt;=0.5) for the model with 1000 trials (enter as a number between 0 and 1 with 2 decimal digit accuracy). \n    \n    Suppose you are now certain that theta = 0.6, plot the probability density given 1000 trials using the code below.\n\nsize =  # number of trials\nprob =  # probability of success\n\nbinom_data &lt;- data.frame(\n  Success = 0:size,\n  Probability = dbinom(0:size, size = size, prob = prob)\n)\n\nggplot(binom_data, aes(x = Success, y = Probability)) +\n  geom_point() +\n  geom_line() +\n  labs(title = \"PMF of Binomial Distribution\", x = \"Number of Successes\", y = \"PDF\")\n\n\n\n\n    \n        7.8 Which plot of the PMF is the correct one?\n        7.9 How does the PMF plot relate to the histogram of ratios plotted earlier?\n        7.10 Given the PMF for your model, calculate the probability for 1000 trials of observing less or equal to 500 red outcomes using theta = 0.6. Use the pbinom function in R. \n    \n    Click to next page",
    "crumbs": [
      "Assignments",
      "Assignment 1"
    ]
  },
  {
    "objectID": "assignment1.html#assignment-questions",
    "href": "assignment1.html#assignment-questions",
    "title": "Assignment 1",
    "section": "",
    "text": "For convenience the assignment questions are copied below. Answer the questions in MyCourses.\n\n\n    \n        \n        \n        \n    \n    \n\n\n        Match the following terms with the correct definition:\nNote that the answers order and set of possible answers is the same for questions 1.1 - 1.8. Check the BDA chapter 1, the lecture slides, and Wikipedia if you are uncertain about the terms below. \n\n\n\n    \n        1.1 Probability:\n            \n        1.2 Probability mass (function): \n        1.3 Probability density (function):\n        1.4 Probability distribution: \n        1.5 Discrete probability distribution: \n        1.6 Continuous probability distribution: \n        1.7 Cumulative distribution function (cdf): \n        1.8 Likelihood:\n            \n    \n    \n    \n    \n        \n            \n        \n        \n    \n    \n            Match the following notation with the correct definition: \n    \n    \n        2.1 \\( \\sim \\):  \n        2.2 \\( \\propto \\):  \n        2.3 \\( \\text{E}[\\cdot] \\):  \n        2.4 \\( p(y | \\theta) \\): \n    \n\n    \n    \n    \n    A group of researchers has designed a new inexpensive and painless test\n        for detecting lung cancer. The test is intended to be an initial\n        screening test for the population in general. A positive result\n        (presence of lung cancer) from the test would be followed up immediately\n        with medication, surgery or more extensive and expensive test. \n    The\n        researchers know from their studies the following facts:\n    \n        Test gives a positive result in 98%  of the time when the test subject has lung cancer.\n        Test gives a negative result in  96% of the time when the test subject does not have lung cancer.\n        In general population approximately one person in 1000 has lung cancer.\n    \n    Here are some probability values that can help you figure out if you\n        copied the right conditional probabilities from the question:\n    \n        P(Test gives positive | Subject does not have lung cancer) = 4%\n        P(Test gives positive and Subject has lung cancer) = 0.098%\n            \n                \n                    this is also referred to as the joint probability of test being positive and the subject having lung cancer\n                \n            \n        \n    \n    Your goal is calculate the probability of having cancer given a positive test result: \\( P(\\text{cancer} | \\text{positive}) \\)\n    \n        3.1 Which quantity in Bayes' Theorem does this represent? \n        3.2 What is the probability of the test having a positive result, given that the test subject has cancer (P(B|A))? \n        3.3 What is the probability of having cancer (P(A))? \n        3.4 What is the probability of having a positive test (P(B))? \n        3.5 Using your previous answers, what is the probability of having cancer given a positive test?\n    \n    \n    \n    \n    We have three boxes, A, B, and C. There are\n    \n        2 red balls and 5 white balls in the box A\n        4 red balls and 1 white ball in the box B\n        1 red ball and 3 white balls in the box C.\n    \n    Consider a random experiment in which one of the boxes is randomly\n        selected and from that box, one ball is randomly picked up. After\n        observing the color of the ball it is replaced in the box it came from.\n        Suppose also that on average box A is selected 40% of the time and box B\n        10% of the time (i.e. P(A) = 0.4).\n    \n    \n        4.1 What is the probability of picking a red ball from box A? \n        4.2 What is the probability of picking a red ball from box B? \n        4.3 What is the probability of picking a red ball from box C? \n        4.4 Considering the probabilities of selecting each box, what is the probability of picking a red ball (enter as a number between 0 and 1 with 2 decimal digit accuracy)?\n        \n            4.5 If a red ball was picked, calculate the probability that it was picked from (enter as a number between 0 and 1 with 2 decimal digit accuracy):\n            \n                Box A:  \n                Box B:  \n                Box C:  \n            \n        \n    \n    \n    \n    \n    \n    \n    Assume that on average fraternal twins (two fertilized eggs and then\n        could be of different sex) occur once in 150 births and identical twins\n        (single egg divides into two separate embryos, so both have the same\n        sex) once in 400 births (Note! This is not the true\n        value, see Exercise 1.6, page 28, in BDA3). Assume\n        that an equal number of boys and girls are born on average.\n    American male singer-actor\n        Elvis Presley (1935 – 1977) had a twin brother who died in birth, your\n        goal is to compute the probability that Elvis was an identical twin.\n    \n    5.1 What is the probability of having a twin brother, given identical twins (enter as a number between 0 and 1 no decimal digits needed)?\n    \n    5.2 What is the total probability of having a twin brother (either fraternal or identical)? (enter as a number between 0 and 1 with 2 decimal digit accuracy)\n    5.3 What is the probability that Elvis was an identical twin, given that he had a twin brother? (enter as a number between 0 and 1 with 2 decimal digit accuracy)\n    \n    \n    6.1 Select the three steps of Bayesian data analysis (see BDA3 p. 3): \n\n\n\n    \n    In this course, models are used to explain social and physical data, and we will be able to generate data from our models which we can use for checking how well our model does. In this example, we show how to generate outcomes from a binomial model to explain outcomes of a roulette game (there is a connection to the history of statistics). Suppose a roulette table with only red and black colours. Roulette tables won't be perfect and it's likely that the probability of red vs black is not exactly 0.5 (the tables can have adjustments that are randomized each day to avoid long term bias). \n    Suppose your model for the tables' ratio of red/black is a Binomial which takes as inputs the number of trials and a probability parameter, theta. Set theta to 0.6 (this is much bigger than what we would expect in real roulette, but makes it easier as a teaching example) and generate a series (for a sequence of 100 equally spaced trial values between 10 and 1000) of red/black ratios. Generate 1000 random draws from your model for each trial value and save the data in a Data frame with columns Ratios, Nsims and Trials. Incomplete code can be found below.\n    \n    # load the tidyverse package for data manipulation and plottinglibrary(tidyverse)# Ratio of red/black\ntheta &lt;- # declare probability parameter for the binomial model\n\n# Sequence of trials\ntrials &lt;- seq(#start value of sequence,#end value of sequence,#value for spacing)\n\n# Number of simulation draws from the model\nnsims &lt;- # number of of simulations from the binomial model\n\n# Helper function for getting the ratios\nbinom_gen &lt;- function(trials,theta,nsims){\n    df &lt;-  as.data.frame(rbinom(nsims,trials,theta)/trials) |&gt; mutate(nsims = nsims,trials = trials)\n    colnames(df) &lt;- c(\"Ratios\",\"Nsims\",\"Trials\")\n  return(df)\n}\n\n# Create a data frame containing the draws for each number of trials\nratio_60 &lt;- do.call(rbind, lapply(trials, binom_gen, theta, nsims)) # lapply applies elements in trials column to binom_gen function, which is then rowbound via do.call\n    \n    \n        7.1 Suppose you are unsure whether the code to create the data frame worked. Which of the following functions should you use in order to check on the structure of the dataframe object (assuming df below stands for a generic dataframe object)?\n        7.2 The structure checks out, but now you want to print the first 5 rows of the dataframe to check whether the values are as expected. Which of the following functions should you use?\n        7.3 The quick peek checks also out, but you would be more at ease scrolling all data, perhaps you'll find some interesting patterns. Which of the following actions allows you to scroll through the data in a separate window (for the below, we assume that you have the code loaded in an RStudio session)?\n    \n    \n    \n    \n    Now, plot a histogram of the computed ratios for 10, 50 and 1000 trials, using the code below\n    # Plot the Distributions\nsubset_df &lt;- ratio_60[ratio_60$Trials %in% c(#trial values), ] # Subset your \n\nsubset_df60 |&gt; ggplot(aes(Ratios)) +\n  geom_histogram(position = \"identity\" ,bins = 40) +\n  facet_grid(cols = vars(Trials))  +\n  ggtitle(\"Ratios for specific trials\")\n    \n    \n    \n        7.4 Which histogram below is the correct one for theta = 0.6?\n        7.5 What do these distributions refer to?\n        7.6 Given these histograms, which number of trials gives you the most certainty about the likely red/black ratio for that table?\n        7.7 Given the draws from the model, give an estimate about the probability p(Ratio&lt;=0.5) for the model with 1000 trials (enter as a number between 0 and 1 with 2 decimal digit accuracy). \n    \n    Suppose you are now certain that theta = 0.6, plot the probability density given 1000 trials using the code below.\n\nsize =  # number of trials\nprob =  # probability of success\n\nbinom_data &lt;- data.frame(\n  Success = 0:size,\n  Probability = dbinom(0:size, size = size, prob = prob)\n)\n\nggplot(binom_data, aes(x = Success, y = Probability)) +\n  geom_point() +\n  geom_line() +\n  labs(title = \"PMF of Binomial Distribution\", x = \"Number of Successes\", y = \"PDF\")\n\n\n\n\n    \n        7.8 Which plot of the PMF is the correct one?\n        7.9 How does the PMF plot relate to the histogram of ratios plotted earlier?\n        7.10 Given the PMF for your model, calculate the probability for 1000 trials of observing less or equal to 500 red outcomes using theta = 0.6. Use the pbinom function in R. \n    \n    Click to next page",
    "crumbs": [
      "Assignments",
      "Assignment 1"
    ]
  }
]