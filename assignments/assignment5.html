<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aki Vehtari et al.">

<title>Bayesian Data Analysis - Assignment 5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assignment6.html" rel="next">
<link href="./assignment4.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script type="text/javascript" id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Assignment 5</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Data Analysis</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">General instructions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment_instructions.html" class="sidebar-item-text sidebar-link">Assignment instructions</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Assignments</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment1.html" class="sidebar-item-text sidebar-link">Assignment 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment2.html" class="sidebar-item-text sidebar-link">Assignment 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment3.html" class="sidebar-item-text sidebar-link">Assignment 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment4.html" class="sidebar-item-text sidebar-link">Assignment 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment5.html" class="sidebar-item-text sidebar-link active">Assignment 5</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment6.html" class="sidebar-item-text sidebar-link">Assignment 6</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment7.html" class="sidebar-item-text sidebar-link">Assignment 7</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment8.html" class="sidebar-item-text sidebar-link">Assignment 8</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment9.html" class="sidebar-item-text sidebar-link">Assignment 9</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#general-information" id="toc-general-information" class="nav-link active" data-scroll-target="#general-information"><span class="toc-section-number">1</span>  General information</a>
  <ul class="collapse">
  <li><a href="#assignment-questions" id="toc-assignment-questions" class="nav-link" data-scroll-target="#assignment-questions"><span class="toc-section-number">1.1</span>  Assignment questions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Assignment 5</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aki Vehtari et al. </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="general-information" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> General information</h1>
<p>The exercises here refer to the lecture 5/BDA chapter 11 content. The main topics for this assignment are the MCSE and importance sampling.</p>
<p><strong>The exercises constitute 96% of the Quiz 5 grade.</strong></p>
<p>We prepared a quarto notebook specific to this assignment to help you get started. <u>You still need to fill in your answers on Mycourses!</u> You can inspect this and future templates</p>
<ul>
<li>as a <a href="template5.html">rendered html file</a> (to access the qmd file click the “&lt;/&gt; Code” button at the top right hand corner of the template)</li>
</ul>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
General Instructions for Answering the Assignment Questions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Questions below are exact copies of the text found in the MyCourses quiz and should serve as a notebook where you can store notes and code.</li>
<li>We recommend opening these notebooks in the Aalto JupyterHub, see <a href="https://avehtari.github.io/BDA_course_Aalto/FAQ.html#How_to_use_R_and_RStudio_remotely"><strong>how to use R and RStudio remotely</strong></a>.</li>
<li>For inspiration for code, have a look at the <a href="https://avehtari.github.io/BDA_course_Aalto/demos.html"><strong>BDA R Demos</strong></a> and the specific Assignment code notebooks</li>
<li>Recommended additional self study exercises for each chapter in BDA3 are listed in the course web page. These will help to gain deeper understanding of the topic.</li>
<li>Common questions and answers regarding installation and technical problems can be found in <a href="https://avehtari.github.io/BDA_course_Aalto/FAQ.html">Frequently Asked Questions (FAQ)</a>.</li>
<li>Deadlines for all assignments can be found on the course web page and in MyCourses.</li>
<li>You are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet.</li>
<li>Do not share your answers publicly.</li>
<li>Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year.</li>
<li>Use of AI is allowed on the course, but the most of the work needs to by the student, and you need to report whether you used AI and in which way you used them (See <a href="https://www.aalto.fi/en/services/guidance-for-the-use-of-artificial-intelligence-in-teaching-and-learning-at-aalto-university">points 5 and 6 in Aalto guidelines for use of AI in teaching</a>).</li>
<li>All suspected plagiarism will be reported and investigated. See more about the <a href="https://into.aalto.fi/display/ensaannot/Aalto+University+Code+of+Academic+Integrity+and+Handling+Violations+Thereof"><strong>Aalto University Code of Academic Integrity and Handling Violations Thereof</strong></a>.</li>
<li>If you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!</li>
</ul>
</div>
</div>
</div>
<section id="assignment-questions" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="assignment-questions"><span class="header-section-number">1.1</span> Assignment questions</h2>
<p>For convenience the assignment questions are copied below. Answer the questions in MyCourses.</p>
<div class="cell">

</div>
<h3 class="anchored"></h3>
<h3 class="anchored"></h3>
<h3 class="anchored">Lecture 5/Chapter 11 of BDA Quiz (96% of grade)</h3>
<h3 class="anchored"><br></h3>
<h3 class="anchored"><span>1. &nbsp;Monte Carlo Methods</span></h3><br>As you've learned in the previous assignments, in some cases we have closed form solution for useful posterior summaries for parameter vector \( \theta \).&nbsp;<br><br>1.1 Why are Monte Carlo and other sampling based methods for posterior evaluation of functions \( f(\theta) \) convenient?<br><br>
<div title="Page 86">
    <div>
        <div>
            <p></p>
        </div>
    </div>
</div>We now briefly review some Monte Carlo methods. Assume we want to obtain draws from \(p(\theta|y)\). Possibly the simplest way, is to apply grid sampling (see&nbsp;<a href="https://avehtari.github.io/BDA_course_Aalto/slides/BDA_lecture_4.pdf">lecture 4</a>). Briefly, the general idea of this method is to&nbsp;<span>identify range of values for \(\theta\) which captures almost all the mass of the posterior distribution,&nbsp;divide this range into grid (small intervals for 1D case, small squares for 2D case and so on), compute the unnormalised posterior density at a grid of values,&nbsp;</span><span>normalize them by approximating the distribution as a step function over the grid and setting the total probability in the grid to 1. Then we can sample from the discrete distribution over values of a grid (more&nbsp;</span><span>information can be found on page 76 of BDA3). However, this approach poses a certain challenge for the case of multivariate&nbsp;\(\theta\).<br></span><br>
<div title="Page 86">
    <div>
        <div>
            <p>1.2&nbsp;What is the main issue of grid sampling:<br></p>
        </div>
    </div>
</div><br>We may try to apply more elaborated methods such as rejection sampling (page 264 of BDA3). Rejection sampling is based on defining a positive function \(g(\theta)\), so that we can obtain draws from the probability density proportional to&nbsp;\(p(\theta)\) and accept those draws according to a certain rule (check lecture <a href="https://avehtari.github.io/BDA_course_Aalto/slides/BDA_lecture_4.pdf">lecture 4</a>).<br><br>1.3&nbsp;<span>: What is a problem with this rejection sampling:</span><br>
<div title="Page 86">
    <p><br><br>
</p><h3 class="anchored">2. Markov Chain Monte Carlo (MCMC)</h3>The most popular way to obtain posterior draws nowadays is MCMC.&nbsp;<br><br>2.1 What is a Markov chain?<br><br><br>2.2 Which of the following is not a Markov chain?<br><br><br>2.3 In question 2.2 we assumed discrete sequences. For the continuous case, we can use conditional transition distribution \( T_t(\theta^t |\theta^{t-1}) \) for a set of random variables \( \theta^1,\theta^2,\dotsc \) to describe the probability density \( p(\theta^t | \theta^1, \dotsc , \theta^{t-1}) = p(\theta^t | \theta^{t-1}) \), given some initial point \( \theta^0 \). What are the two steps we need to prove for the Markov chain to eventually produce valid series of draws from the the posterior \( p(\theta |y) \)?<br><br><br>2.4 What are the necessary and sufficient conditions to prove that a Markov chain has a unique stationary distribution?<br><br><br>2.5 Why is it often necessary to discard the first draws of the MCMC chain?<br><br><br>2.6 Why might MCMC be preferrable to grid and rejection sampling?<br>&nbsp;<br><br>
<h3 class="anchored"><span>3.&nbsp;Metropolis algorithm</span></h3>
<p>The Metropolis-Hastings algorithm is a relatively simple MCMC algorithm, yet it is foundational for more advanced algorithms, such as the Hamiltonian Monte Carlo algorithm you will encounter later in the course. Later in this assignment, you will implement the Metropolis algorithm (page 278 of BDA3). Denote the proposal distribution at time \( t \) for parameter vector \( \theta^t \) contitional on \( \theta^{t-1} \) as \( J_t(\theta^t|\theta^{t-1}) \). For simplicity, we consider here symmetric proposal distributions (otherwise the algorithm would be known as the Metropolis-<em>Hastings</em> algorithm).&nbsp;</p>
<p>3.1: What is a main idea behind the Metropolis algorithm:<br></p><br>3.2: Denote the current proposal by \( \theta^*\) at time t from the proposal distribution \( J_t(\theta^* | \theta^{t-1}) \). Which one is the correct acceptance ratio, \( r \):<br><br><br>3.3: Which one is the correct rule for accepting the proposal? Denote the acceptance ratio you've determined in 3.2 by \(r\). Set \( \theta^t \) equal to:<br><br><br>3.4 Assume the posterior surface has a unique mode. What would eventually happen to the MCMC chain if adopting the rule&nbsp;\(\theta^*\) iff \( r &gt; 1 \) and&nbsp;\( \theta^{t-1} \) otherwise?<br><br><br>3.5 Retain the assumpion made in question 3.4. Why is the posterior mode alone not generally useful for posterior expectations?<br><br><br>
<p></p>
<h3 class="anchored">4. Trace plot diagnostics</h3>
<p>Suppose you've successfully obtained multiple chains of MCMC draws from the Metropolis algorithm. Remember that the goal for the MCMC chains is to firstly converge to some unique distribution, and that all chains converge to the same distribution (with the hope of that being&nbsp;\(p(\theta|y)\)). You would now like to check if your chains can be trusted to have done so, after having discarded an appropriate amount of draws you used for warm-up. &nbsp;There are multiple convergence diagnostics and we will discuss some of them here.&nbsp;<br></p>
<p>One way is to investigate the trace plot: check visually whether the chains converged to the same distribution. If they have, we say the chains have mixed. To do this, we plot them in the same figure and observe if something went wrong. Below you are given an example with two chains. Look at them carefully and answer questions below.</p>
<p></p>

Figure 1: <img src="https://github.com/avehtari/BDA_course_Aalto/blob/master/figures/Quizzes
/Quiz5/trace_4.png?raw=true" data-hpc="true" class="Box-sc-g0xbh4-0 kzRgrI"><span>

    <p>4.1: Can you say that your chains converged to the same distribution based on Figure 1:</p>
    <div title="Page 86">
        <p><br><br>

    Figure 2: <img src="https://github.com/avehtari/BDA_course_Aalto/blob/master/figures/Quizzes
/Quiz5/trace_3.png?raw=true" data-hpc="true" class="Box-sc-g0xbh4-0 kzRgrI"><span>
        </span></p><p>4.2: Can you say that your chains are mixing well based on Figure 2:</p>
        <div title="Page 86">
            <p><br>
        </p><p></p>
        <p></p>
        <h3 class="anchored">5. Rhat diagnostics</h3>Trace plot inspection can be useful when parameter space is small, however, when dealing with large spaces, it becomes inconvenient to analyse trace plots of each parameter separately, therefore we would like to also have some quantitative metrics for investigating convergence. One of them is called Rhat. There are different versions of it, for instance, version from BDA3 book(page 285). The much improved version you will use throughout the course is based on <a href="https://projecteuclid.org/journals/bayesian-analysis/volume-16/issue-2/Rank-Normalization-Folding-and-Localization--An-Improved-R%cb%86-for/10.1214/20-BA1221.full">Vehtari et al. (2021)</a>. Let's look at the book version to understand why it is preferred to use the modified version.<br><br>5.1: What is the definition of Rhat from&nbsp;BDA3 book:<br>
        <div title="Page 86">
            <p><br><br>5.2: Which range of values for Rhat would are a good indicator for convergence (<a href="https://avehtari.github.io/BDA_course_Aalto/slides/BDA_lecture_5.pdf">see lecture 5</a>)?<br><br><br>Imagine a situation where one chain converged to \(N(0,1)\) distribution and the other one to Student t with 3 degrees of freedom. The trace plot then looks like:<br>
        Figure 3: <img src="https://github.com/avehtari/BDA_course_Aalto/blob/master/figures/Quizzes
/Quiz5/rhat_example.png?raw=true" <h3=""><br>5.3: What do you observe:<br><br>
        </p><div title="Page 86">
            <p><br><br>5.4: However, despite of this issue, the Rhat value from the book equals 0.999859, indicating good convergence of the chains. What can be the explanation for this:<br>
        </p><div title="Page 86">
            <p><br><br>On the contrary, Rhat value from&nbsp;Vehtari et al paper equals 1.39025, &nbsp;much bigger than recommended 1.01, resolving the above problem. You can find more examples about new Rhat in the paper but also this <a href="https://avehtari.github.io/BDA_R_demos/demos_ch11/demo11_3_4.html">demo</a>.<br><br>
        </p><h3 class="anchored">6. ESS diagnostics</h3>
        <p>Another useful quantity is the effective sample size.&nbsp;</p>
        <p>6.1: Why can we not rely on total sample size?<br><span style="font-size: 0.9375rem; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, &quot;Noto Sans&quot;, &quot;Liberation Sans&quot;, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;;"><br><br>6.2: Suppose you have obtained S draws from your posterior with MCMC. We define the effective sample size as \( S_{eff} = S/\tau \). What does \( \tau \) refer to in this context?<br><br><br>6.3: Look at the trace plots below. For which sequences do you expect HIGHER effective sample size:<br><br>
        </span></p><p>
                    </p>
        <p><span><span><span style="font-size: 0.9375rem; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, &quot;Noto Sans&quot;, &quot;Liberation Sans&quot;, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;;">6.4: Select the autocorrelation function below corresponding to the chains in Figure 4 of the previous question.</span></span></span></p>
        <p>
                    </p>

        <h3 class="anchored">7. Generalised linear model: Bioassay model with Metropolis algorithm</h3>
        <p>In this exercise, you will implement the Metropolis algorithm. <a href="https://avehtari.github.io/BDA_course_Aalto/assignments/template5.html">Here</a> you are provided code to get you started fro this part of the assignment. You are provided with the code for a Metropolis algorithm, however, it contains three errors. Your task is to find these errors, correct them and answer the following questions below.&nbsp;</p>
        <p>7.1: Lets denote "<span style="font-size: 0.9375rem;">bioassaylp(alpha_propose, beta_propose, x, y, n)</span><span style="font-size: 0.9375rem;">&nbsp;- bioassaylp(alpha_previous, beta_previous, x, y, n)&nbsp;</span><span style="font-size: 0.9375rem;">+ dmvnorm(c(alpha_propose, beta_propose), prior_mean, prior_sigma, TRUE)&nbsp;</span><span style="font-size: 0.9375rem;">- dmvnorm(c(alpha_previous, beta_previous), prior_mean, prior_sigma, TRUE)" as expression 1.&nbsp;</span><span style="font-size: 0.9375rem;">How should we correct error 1:</span></p>
        <p></p>
        <div title="Page 86">
            <p><br><br>7.2: Lets denote "if(runif(1) &gt; density_ratio(alpha_propose, alpha_previous, beta_propose, beta_previous, x, y, n))"&nbsp;<span>as expression 2.&nbsp;</span><span>How should we correct error 2:<br></span><br>
        </p><div title="Page 86">
            <p><br><br>7.3: How should we correct error 3:<br><br>
        </p><div title="Page 86">
            <p><br><br>After you corrected the errors, you may run sampling. Investigate the code in the <a href="https://avehtari.github.io/BDA_course_Aalto/assignments/template5.html">notebook</a> and answer the questions below.<br><br>7.4: How many chains did we run: &nbsp;.<br><br>7.5: How many draws including warm-up have we obtained for each individual chain: &nbsp;.<br><br>7.6: What is the warm-up length:&nbsp;.<br><br>7.7: After performing sampling, let's check the convergence of the chains. The next code chunk will produce trace plots. Which one is the correct one:<br><br>
        </p><div title="Page 86">
            <p><br><br>
            </p>
            <p></p>
        </div>}<br><br>After looking at trace plots, compute Rhat values for both alpha and beta:<br><br>7.8: Rhat for alpha=,&nbsp;Rhat for beta=<br>
        <h3 class="anchored"><span>
                <div></div>
            </span></h3><br>In addition to Rhat, compute ESS for for the mean and 0.25 quantile of alpha and beta:<br><br>7.9: ESS mean for alpha=, ESS mean for beta=.<br><br>7.10: ESS q0.25 for alpha=, ESS q0.25 for beta=.<br><br>Let us compare ESS of independent draws and MCMC draws. Use 4000 independent draws from the posterior distribution of the model in the dataset bioassay_posterior in the aaltobda package from Assignment 4.<br><br>7.11: ESS mean of alpha for bioassay_posterior&nbsp;=, ESS mean of beta for bioassay_posterior&nbsp;=<br><br>7.12: ESS q0.25 of alpha for bioassay_posterior&nbsp;=, ESS q0.25 of beta for bioassay_posterior&nbsp;=<br><br>7.13: Visualise scatter plot of posterior draws. Which one is the correct figure:<br><br><br>
        
                    <p></p><br><br><br>
                    <p></p><br>
                
            
    




</div></div></div></div></div></div></div></div></span></div></section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./assignment4.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Assignment 4</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./assignment6.html" class="pagination-link">
        <span class="nav-page-text">Assignment 6</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>