<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aki Vehtari et al.">

<title>Bayesian Data Analysis - Assignment 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assignment5.html" rel="next">
<link href="./assignment3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script type="text/javascript" id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Assignment 4</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Data Analysis</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">General instructions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment_instructions.html" class="sidebar-item-text sidebar-link">Assignment instructions</a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Assignments</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment1.html" class="sidebar-item-text sidebar-link">Assignment 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment2.html" class="sidebar-item-text sidebar-link">Assignment 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment3.html" class="sidebar-item-text sidebar-link">Assignment 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment4.html" class="sidebar-item-text sidebar-link active">Assignment 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment5.html" class="sidebar-item-text sidebar-link">Assignment 5</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment6.html" class="sidebar-item-text sidebar-link">Assignment 6</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment7.html" class="sidebar-item-text sidebar-link">Assignment 7</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment8.html" class="sidebar-item-text sidebar-link">Assignment 8</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment9.html" class="sidebar-item-text sidebar-link">Assignment 9</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#general-information" id="toc-general-information" class="nav-link active" data-scroll-target="#general-information"><span class="toc-section-number">1</span>  General information</a>
  <ul class="collapse">
  <li><a href="#assignment-questions" id="toc-assignment-questions" class="nav-link" data-scroll-target="#assignment-questions"><span class="toc-section-number">1.1</span>  Assignment questions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Assignment 4</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aki Vehtari et al. </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="general-information" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> General information</h1>
<p>The exercises here refer to the lecture 4/BDA chapters 3 and 10 content. The main topics for this assignment are the MCSE and importance sampling.</p>
<p><strong>The exercises constitute 96% of the Quiz 4 grade.</strong></p>
<p>We prepared a quarto notebook specific to this assignment to help you get started. <u>You still need to fill in your answers on Mycourses!</u> You can inspect this and future templates</p>
<ul>
<li>as a <a href="template4.html">rendered html file</a> (to access the qmd file click the “&lt;/&gt; Code” button at the top right hand corner of the template)</li>
</ul>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
General Instructions for Answering the Assignment Questions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Questions below are exact copies of the text found in the MyCourses quiz and should serve as a notebook where you can store notes and code.</li>
<li>We recommend opening these notebooks in the Aalto JupyterHub, see <a href="https://avehtari.github.io/BDA_course_Aalto/FAQ.html#How_to_use_R_and_RStudio_remotely"><strong>how to use R and RStudio remotely</strong></a>.</li>
<li>For inspiration for code, have a look at the <a href="https://avehtari.github.io/BDA_course_Aalto/demos.html"><strong>BDA R Demos</strong></a> and the specific Assignment code notebooks</li>
<li>Recommended additional self study exercises for each chapter in BDA3 are listed in the course web page. These will help to gain deeper understanding of the topic.</li>
<li>Common questions and answers regarding installation and technical problems can be found in <a href="https://avehtari.github.io/BDA_course_Aalto/FAQ.html">Frequently Asked Questions (FAQ)</a>.</li>
<li>Deadlines for all assignments can be found on the course web page and in MyCourses.</li>
<li>You are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet.</li>
<li>Do not share your answers publicly.</li>
<li>Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year.</li>
<li>Use of AI is allowed on the course, but the most of the work needs to by the student, and you need to report whether you used AI and in which way you used them (See <a href="https://www.aalto.fi/en/services/guidance-for-the-use-of-artificial-intelligence-in-teaching-and-learning-at-aalto-university">points 5 and 6 in Aalto guidelines for use of AI in teaching</a>).</li>
<li>All suspected plagiarism will be reported and investigated. See more about the <a href="https://into.aalto.fi/display/ensaannot/Aalto+University+Code+of+Academic+Integrity+and+Handling+Violations+Thereof"><strong>Aalto University Code of Academic Integrity and Handling Violations Thereof</strong></a>.</li>
<li>If you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!</li>
</ul>
</div>
</div>
</div>
<section id="assignment-questions" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="assignment-questions"><span class="header-section-number">1.1</span> Assignment questions</h2>
<p>For convenience the assignment questions are copied below. Answer the questions in MyCourses.</p>
<div class="cell">

</div>
<p></p>
<div>
    <h3 class="anchored"><span style="font-size: 0.9375rem; font-weight: 400;">
            <div>
                <div>
                    <p></p>
                    <p></p>
                    <p></p>
                    <p></p>
                    <p></p>
                    <p></p>
                    <h3 class="anchored">Lecture 4/Chapters 3 and 10 of BDA Quiz (96% of grade)</h3>
                    <h3 class="anchored"><br></h3>
                    <p>As, always, please see the provided <a href="https://avehtari.github.io/BDA_course_Aalto/assignments/template4.html">code notebook</a>&nbsp;from the website to help you get started on the coding tasks.</p>
                    <p><br></p>
                    <h3 class="anchored">1. Mean estimates, Monte Carlo standard error (MCSE) and Pareto-k diagnostic<br></h3>
                    <p>This task is about understanding and calculating Monte Carlo standard error.</p>
                    <p></p>
                    <p>1.1 Which of these correctly describes MCSE:</p>
                    <p></p>
                    <p><br></p>
                    <p></p>
                    <p><span>We will explore mean estimates and MCSE estimates of two distributions.</span></p>
                    <p><span>First is the gamma distribution, parameterised with shape (alpha) and rate (beta).</span></p>
                    <p>1.2 Look up the gamma distribution in Appendix A in BDA (or&nbsp;<a href="https://en.wikipedia.org/wiki/Gamma_distribution">wikipedia</a>). What is the mean of the gamma(alpha = 3, beta = 3) distribution?</p>
                </div>
                <div><br>Use the appropriate R function to draw a sample of size 1000 from a gamma(3, 3) distribution.&nbsp;</div>
                <div>1.3 Which of these commands correctly does this:<br></div>
                <div>
                    <p><br></p>
                    <p>One way to calculate the Monte Carlo standard error of the mean is to repeatedly take samples of draws from the distribution, calculate the mean of each sample and then the standard deviation of the means. Let's re-calculate the mean with a lower number of draws.<br></p>
                    <p><br></p>
                    <p>1.4 Which of these best describes the relationship between the empirical mean of the sample of size 400 and the analytical mean of the gamma(3, 3) distribution?<br><br></p>
                    <p>Simulate 2000 samples, each of 400 draws from the Gamma(3, 3), calculate and save the mean of each sample. Then calculate the standard deviation of the sample of means.<br><br>Adjust the following R code to do this:<br><br># create a vector to store the sample means<br>sample_means &lt;- rep(NA, times = NUMBER_OF_SAMPLES)<br><br># loop over the number of samples<br>for (i in 1:NUMBER_OF_SAMPLES) {<br>&nbsp; # generate a sample from the gamma distribution of size 400<br>&nbsp; sample &lt;- ...<br>&nbsp; # calculate the sample mean and save it to the vector<br>&nbsp; sample_means[i] &lt;- ...<br>}<br><br># calculate the standard deviation of the sample means<br>sd(...)<br></p>
                    <p>1.5 Enter the MCSE that is calculated from the code: <br><br>Now, explore the Cauchy(location = 0, scale = 1) distribution. The corresponding functions are named similarly to the gamma functions above.<br></p>
                    <p><br></p>
                    <p>1.6 What is the mean of the Cauchy(0, 1) distribution?</p>
                    <p><br></p>
                    <p>Change the simulation to take samples of the Cauchy(0, 1) distribution and calculate the MCSE of the mean. Try this a few times.</p>
                    <p></p>
                    <p><br></p>
                    <p>1.7 What do you notice about the MCSE for the mean of the Cauchy and gamma distributions? </p>
                    <p><br></p>
                    <p>The Central Limit Theorem (CLT) gives us the conditions under which it is also possible to estimate the MCSE from a single sample (see lecture slides and for excellent visual intuition, check out "But what is the Central Limit Theorem" by 3Blue1Brown&nbsp;<span>)</span>&nbsp;for means and other functions of the posterior. The function mcse_mean from the <a href="https://mc-stan.org/posterior/articles/posterior.html">posterior package</a> provides this method (more on this is also mentioned in the lecture).</p><br>
                    <p></p>
                    <p>1.8 Let’s put the claims of the CLT to test. Assume you’ve taken \(N\) draws of a random variable and stored them in a vector \(\theta\). Assume also that the random variable follows a distribution with finite mean and variance, what is the correct formula for the MCSE of the mean?&nbsp; \(SD\) denotes the standard deviation and \(var\) the variance of \(\theta\).<br></p>
                    <p></p>
                    <p><br></p>
                    <p>1.9 Based on what you learned about the Gamma(3, 3) and the Cauchy(0, 1) distributions, which of these statements is correct?</p>
                    <p><br></p>
                    <p><br></p>
                    <p>The Pareto-k diagnostic can be used to diagnose whether the mean (or other moments) exists. The function posterior::pareto_khat() calculates this for a sample of draws. Calculate the Pareto-k for samples of 400 draws from the gamma(3, 3) and the Cauchy(0, 1) distributions.</p>
                    <p><br></p>
                    <p>1.10 Which of these is true:<br></p>
                    <p><br></p>
                </div>
                <div>MCSE can be calculated for any estimate, including quantiles and probability and can be used to guide how many digits to report for a given estimate. Suppose you calculate the following summary of a parameter:</div>
                <div>mean = 0.483834 (MCSE = 0.003)<br></div>
                <div>5% quantile = 0.234536 (MCSE = 0.01)<br></div>
                <div>95% quantile = 1.34823 (MCSE = 0.2)</div>
                <div><br></div>
            </div>
            <div><br></div>
            <div>1.11 Based on recommendations from the lecture how should you report for the mean?<br></div>
            <div></div>
        </span></h3>
    <h3 class="anchored"><span style="font-size: 0.9375rem; font-weight: 400;">1.12 Based on recommendations from the lecture how should you report the 5% quantile?</span><br></h3>
</div>
<div></div>
<div><span style="font-size: 0.9375rem;"><br></span></div>
<div>
    <h3 class="anchored"><span style="font-size: 0.9375rem; font-weight: 400;">1.13 Based on recommendations from the lecture how should you report the 95% quantile?</span><br></h3>
</div>
<div>
    <div></div>
    <div>
        <div>
            <div>
                <div><br>
                </div><br>
            </div>
        </div>
        <div>
            <h3 class="anchored">2. Bioassay model: Prior<br></h3>
            <p>In this exercise, you will use a dose-response relation model that is used in BDA3 Section 3.7 and in the chapter reading notes.<br>The likelihood is the same as in the book, but instead of uniform priors, we will use a bivariate normal distribution as the joint prior distribution of the parameters \(\alpha\) and \(\beta\).<br></p>
            <p>In the prior distribution for \((\alpha,\beta)\), the marginal distributions are \(\alpha \sim N(0,2^2)\) and \(\beta \sim N(10,10^2)\), and the correlation between them is \(\mathrm{corr}(\alpha, \beta)=0.6\).</p>

            <p>2.1 The mean of the prior distribution for \((\alpha, \beta)\) is: </p>
            <p>2.2 The covariance of the prior distribution (two by two matrix) is:&nbsp;</p>
            <p></p>
        </div>
        <div>
            <h3 class="anchored">3. Bioassay model: Importance sampling</h3>
        </div>
        <div>For this section, you will estimate the posterior mean by weighting prior draws with the appropriate importance weights. To do this you will need to calculate the unnormalized importance ratios \(\tilde{w}\) (also known as weights) when the importance sampling target distribution \(q(\theta)\) is the posterior distribution, and the proposal distribution \(g(\theta)\) is the prior distribution as defined above. You will then need to use this function to calculate the importance sampling estimate of the posterior mean, given draws from the prior.<br></div>
        <div><br></div>
        <div>
            <div>3.1 What is the general formula for the importance ratios (also called importance weights)?</div>
            <div><br></div>
            <div><br></div>
            <div><br></div>
            <div>3.2<span style="font-size: 0.9375rem;">&nbsp;What is the correct formula for the importance ratios in the case where the prior&nbsp;</span><span style="font-size: 0.9375rem;">is the proposal and the posterior is the target?</span></div>
            <div>
                <div><br></div>
                <div></div>
            </div>
            <div><br></div>3.3 What is the correct formula for the <strong>unnormalized</strong> importance ratios in<span style="font-size: 0.9375rem;">&nbsp;the case where the prior&nbsp;is the proposal and the posterior is the target?</span>
            <div>
                <div><br></div>
                <div>
                    <div></div>
                </div>
            </div><br>
        </div>
        <div>3.4 The unnormalized log importance ratios in the case where the prior&nbsp;is the proposal and the posterior is the target simplify to:</div>
        <div><br></div>
        <div></div>
        <div><br></div>
        <div>3.5 Why is it better to compute the importance rations on the log scale?</div>
        <div><br></div>
        <div><br></div>
        <div><br></div>
        <div>The function `bioassaylp` from the aaltobda package calculates the unnormalized log posterior density assuming a uniform prior.</div>
        <div><br></div>
        <div>3.6 What is the relationship between the posterior, likelihood and prior when the prior is uniform?</div>
        <div><br></div>
        <div><br></div>
        <div>
            <div>3.7 What is the correct formula or formulas for the self-normalized importance sampling estimate of the mean? \(w\) are the unnormalized importance weights, and \(\tilde{w}\) are the self-normalized weights.<br></div>
            <div><br></div>
            <div></div>
            <div><br></div>
            <div>Use the function rmvnorm to draw 4000 draws from the prior specified in question 2, calculate the importance weights and then the importance sampling estimate of the posterior mean.</div>
            <div><br></div>
            <div>3.8 The importance sampling estimate of the posterior mean is: <br></div>
            <div><br></div>
            <div>alpha: , beta: .</div>
            <div><br></div>
            <div>3.9 What is the equation for the generic effective sample size (ESS) estimate for importance sampling?</div>
            <div><br></div>
            <div>
                <div><br></div>
                <div>3.10 Importance sampling ESS: </div>
                <div><br></div>
                <div>3.11 What is the MCSE of the estimates? Make sure to use the ESS in the denominator instead of the sample size.<br></div>
            </div>
            <div><br></div>
            <div>
                <div>alpha: , beta: .</div>
                <div><br></div>
                <div>3.12 What is the Pareto-k diagnostic of the importance ratios (enter value with one decimal)? .</div>
                <div><br></div>
                <div>3.13 Based on the value, should you trust the importance sampling estimate of the mean?<br></div>
            </div>
            <div><br></div>
            <div>
                <div>
                    <h3 class="anchored">4. Bioassay model: Independent posterior draws</h3>
                </div><br>
            </div>
            <div>
                <div>
                    <p>You are given 4000 independent draws from the posterior distribution<br>of the model in the dataset `bioassay_posterior` in the `aaltobda` package.</p>
                    <p>4.1 The posterior can be summarised by the means and 90% posterior interval.<br>What is the mean, 5% and 95% quantiles of the posterior draws for the parameters?<br>mean of alpha: , 5% quantile of alpha: , 95% quantile of alpha: </p>
                    <p>mean of beta: , 5% quantile of beta: , 95% quantile of beta: </p>
                </div>
                <div><br></div>
                <div>4.2 What is the MCSE for the mean and quantiles (remember that they are independent draws)?<br>For alpha: MCSE for mean: , MCSE for 5% quantile: , MCSE for 95% quantile: </div>
                <div><br></div>
                <div>For beta: MCSE for mean: , MCSE for 5% quantile: , MCSE for 95% quantile: </div>
            </div>
            <div><br></div>
            <div>Compare these posterior summaries to the importance sampling estimate.<br></div>
            <div><br></div>
            <div>4.3 How does the importance sampling estimate of the posterior mean compare to the estimate from independent posterior draws?</div>
            <div></div>
            <div><br></div>
            <div>Remember that the LD50 (median lethal dose) is equal to \( exp( -\alpha / \beta) \).&nbsp;</div>
            <div>Calculate the posterior probability that the LD50 is less than 0.85ml/g. Also calculate the MCSE for this probability.</div>
            <div><br></div>
            <div>4.4 Pr(LD50 &lt; 0.85 ml/g) = , MCSE = <br></div>
            <div><br></div>
            <div><br></div><br>
        </div>
    </div>
</div>



</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./assignment3.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Assignment 3</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./assignment5.html" class="pagination-link">
        <span class="nav-page-text">Assignment 5</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>